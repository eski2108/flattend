"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1],[,(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var i=r(9950),a=r(4028),o=r(1330),s=r(6604),d=r(6910),n=r(2033),l=r(4414);const c="https://bugsecurehub.preview.emergentagent.com";function p(){const{tradeId:e}=(0,a.g)(),t=(0,a.Zp)(),[r,p]=(0,i.useState)(null),[x,u]=(0,i.useState)(!0),[g,b]=(0,i.useState)(null),[h,F]=(0,i.useState)([]),[y,m]=(0,i.useState)(""),[f,v]=(0,i.useState)(!1),[j,k]=(0,i.useState)(0),[_,B]=(0,i.useState)(null),[S,w]=(0,i.useState)(""),[R,C]=(0,i.useState)(!1),[A,z]=(0,i.useState)(!1),[W,E]=(0,i.useState)("positive"),[I,T]=(0,i.useState)(""),[D,P]=(0,i.useState)(!1),[N,M]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(r&&"completed"===r.status&&!A){g&&(async()=>{try{(await d.A.get("".concat(c,"/api/p2p/trade/").concat(e,"/feedback-check?user_id=").concat(null===g||void 0===g?void 0:g.user_id))).data.feedback_given||setTimeout(()=>z(!0),1e3)}catch(t){setTimeout(()=>z(!0),1e3)}})()}},[null===r||void 0===r?void 0:r.status,g]),(0,i.useEffect)(()=>{const e=localStorage.getItem("cryptobank_user");if(!e)return void t("/login");const r=JSON.parse(e);b(r),O(r.user_id);const i=setInterval(()=>O(r.user_id),5e3);return()=>clearInterval(i)},[e,t]),(0,i.useEffect)(()=>{if(r&&g){const e=L?r.seller_id:r.buyer_id;Y(e)}},[r,g]),(0,i.useEffect)(()=>{if(r&&r.expires_at){const e=setInterval(()=>{const t=new Date,i=new Date(r.expires_at),a=Math.floor((i-t)/1e3);a<=0?(k(0),clearInterval(e)):k(a)},1e3);return()=>clearInterval(e)}},[r]);const O=async r=>{try{const i=await d.A.get("".concat(c,"/api/p2p/trade/").concat(e,"?user_id=").concat(r));i.data.success&&(p(i.data.trade),i.data.messages&&F(i.data.messages),i.data.blocked&&(n.oR.error("This trade involves a blocked user. Redirecting..."),setTimeout(()=>t("/p2p"),2e3)))}catch(a){var i;console.error("Error fetching trade:",a),403===(null===(i=a.response)||void 0===i?void 0:i.status)?(n.oR.error("Access denied: User is blocked"),t("/p2p")):n.oR.error("Failed to load trade details")}finally{u(!1)}},U=async()=>{if(y.trim()||_){v(!0);try{const t=new FormData;t.append("trade_id",e),t.append("sender_id",g.user_id),t.append("message",y),_&&t.append("attachment",_);(await d.A.post("".concat(c,"/api/p2p/trade/message"),t,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(m(""),B(null),O(g.user_id))}catch(t){n.oR.error("Failed to send message")}finally{v(!1)}}},Y=async e=>{try{const t=await d.A.get("".concat(c,"/api/p2p/blocked/").concat(g.user_id));if(t.data.success){const r=t.data.blocked_users||[];P(r.includes(e))}}catch(t){console.error("Error checking block status:",t)}finally{M(!1)}};if(x)return(0,l.jsx)(o.A,{children:(0,l.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#fff"},children:"Loading..."})});if(!r)return(0,l.jsx)(o.A,{children:(0,l.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#fff"},children:"Trade not found"})});const L=(null===g||void 0===g?void 0:g.user_id)===r.buyer_id,G=L?"Seller":"Buyer";return(0,l.jsxs)(o.A,{children:[(0,l.jsx)("div",{style:{minHeight:"100vh",padding:"40px 20px",background:"linear-gradient(180deg, #05121F 0%, #071E2C 100%)"},children:(0,l.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[(0,l.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(0, 198, 255, 0.2)",borderRadius:"16px",padding:"24px",marginBottom:"24px"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,l.jsxs)("h1",{style:{fontSize:"28px",fontWeight:"700",color:"#FFFFFF"},children:[L?"Buy":"Sell"," ",r.crypto_currency]}),(0,l.jsx)("div",{style:{padding:"8px 16px",background:"completed"===r.status?"rgba(34, 197, 94, 0.1)":"rgba(255, 165, 0, 0.1)",border:"1px solid ".concat("completed"===r.status?"rgba(34, 197, 94, 0.3)":"rgba(255, 165, 0, 0.3)"),borderRadius:"8px",color:"completed"===r.status?"#22C55E":"#FFA500",fontWeight:"600"},children:"pending_payment"===r.status?"Waiting for Payment":"payment_made"===r.status?"Payment Made":"completed"===r.status?"Completed":"cancelled"===r.status?"Cancelled":"disputed"===r.status?"Disputed":r.status})]}),j>0&&"pending_payment"===r.status&&(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px"},children:[(0,l.jsx)(s.Gm4,{size:20,color:"#EF4444"}),(0,l.jsxs)("span",{style:{color:"#EF4444",fontWeight:"600"},children:["Time remaining: ",Math.floor(j/60),":",(j%60).toString().padStart(2,"0")]})]})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 400px",gap:"24px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(0, 198, 255, 0.2)",borderRadius:"16px",padding:"24px",marginBottom:"24px"},children:[(0,l.jsx)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#FFFFFF",marginBottom:"16px"},children:"Order Details"}),(0,l.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)("span",{style:{color:"#8F9BB3"},children:"Amount"}),(0,l.jsxs)("span",{style:{color:"#FFFFFF",fontWeight:"600"},children:[r.crypto_amount," ",r.crypto_currency]})]}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)("span",{style:{color:"#8F9BB3"},children:"Price"}),(0,l.jsxs)("span",{style:{color:"#FFFFFF",fontWeight:"600"},children:["\xa3",(r.fiat_amount/r.crypto_amount).toFixed(2)]})]}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)("span",{style:{color:"#8F9BB3"},children:"Total"}),(0,l.jsxs)("span",{style:{color:"#00C6FF",fontWeight:"700",fontSize:"20px"},children:["\xa3",r.fiat_amount.toFixed(2)]})]})]})]}),L&&r.seller_payment_details&&"pending_payment"===r.status&&(0,l.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"16px",padding:"24px",marginBottom:"24px"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[(0,l.jsx)(s.eeu,{size:24,color:"#FFA500"}),(0,l.jsx)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#FFFFFF"},children:"Payment Instructions"})]}),(0,l.jsx)("div",{style:{background:"rgba(255, 165, 0, 0.05)",padding:"16px",borderRadius:"8px"},children:(0,l.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Bank Name"}),(0,l.jsx)("div",{style:{color:"#FFFFFF",fontWeight:"600"},children:r.seller_payment_details.bank_name})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Account Name"}),(0,l.jsx)("div",{style:{color:"#FFFFFF",fontWeight:"600"},children:r.seller_payment_details.account_name})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Account Number"}),(0,l.jsx)("div",{style:{color:"#FFFFFF",fontWeight:"600"},children:r.seller_payment_details.account_number})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Sort Code"}),(0,l.jsx)("div",{style:{color:"#FFFFFF",fontWeight:"600"},children:r.seller_payment_details.sort_code})]}),r.seller_payment_details.notes&&(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Notes"}),(0,l.jsx)("div",{style:{color:"#FFA500"},children:r.seller_payment_details.notes})]})]})})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[L&&"pending_payment"===r.status&&(0,l.jsxs)("button",{onClick:async()=>{v(!0);try{(await d.A.post("".concat(c,"/api/p2p/trade/mark-paid"),{trade_id:e,user_id:g.user_id})).data.success&&(n.oR.success("\u2705 Payment marked! Waiting for seller to release."),O(g.user_id))}catch(i){var t,r;n.oR.error((null===(t=i.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.detail)||"Failed to mark as paid")}finally{v(!1)}},disabled:f,style:{flex:1,padding:"16px",background:"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"12px",color:"#FFFFFF",fontSize:"16px",fontWeight:"700",cursor:f?"not-allowed":"pointer",boxShadow:"0 0 20px rgba(34, 197, 94, 0.4)"},children:[(0,l.jsx)(s.G3G,{size:20,style:{marginRight:"8px",verticalAlign:"middle"}}),"Mark as Paid"]}),!L&&"payment_made"===r.status&&(0,l.jsx)("button",{onClick:async()=>{v(!0);try{(await d.A.post("".concat(c,"/api/p2p/trade/release"),{trade_id:e,user_id:g.user_id})).data.success&&(n.oR.success("\u2705 Crypto released successfully!"),O(g.user_id))}catch(i){var t,r;n.oR.error((null===(t=i.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.detail)||"Failed to release crypto")}finally{v(!1)}},disabled:f,style:{flex:1,padding:"16px",background:"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"12px",color:"#FFFFFF",fontSize:"16px",fontWeight:"700",cursor:f?"not-allowed":"pointer",boxShadow:"0 0 20px rgba(34, 197, 94, 0.4)"},children:"Release Crypto"}),"completed"===r.status&&(0,l.jsx)("button",{onClick:()=>z(!0),style:{flex:1,padding:"16px",background:"linear-gradient(135deg, #FFA500, #FF8C00)",border:"none",borderRadius:"12px",color:"#FFFFFF",fontSize:"16px",fontWeight:"700",cursor:"pointer",boxShadow:"0 0 20px rgba(255, 165, 0, 0.4)"},children:"\u2b50 Rate This Trade"}),"completed"!==r.status&&"cancelled"!==r.status&&"disputed"!==r.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{onClick:()=>C(!0),disabled:f,style:{padding:"16px 24px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"12px",color:"#EF4444",fontSize:"16px",fontWeight:"600",cursor:f?"not-allowed":"pointer"},children:[(0,l.jsx)(s.tr_,{size:20,style:{marginRight:"8px",verticalAlign:"middle"}}),"Dispute"]}),L&&"pending_payment"===r.status&&(0,l.jsx)("button",{onClick:async()=>{if(window.confirm("Are you sure you want to cancel this order?")){v(!0);try{(await d.A.post("".concat(c,"/api/p2p/trade/cancel"),{trade_id:e,user_id:g.user_id})).data.success&&(n.oR.success("Order cancelled"),O(g.user_id))}catch(i){var t,r;n.oR.error((null===(t=i.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.detail)||"Failed to cancel")}finally{v(!1)}}},disabled:f,style:{padding:"16px 24px",background:"rgba(143, 155, 179, 0.1)",border:"1px solid rgba(143, 155, 179, 0.3)",borderRadius:"12px",color:"#8F9BB3",fontSize:"16px",fontWeight:"600",cursor:f?"not-allowed":"pointer"},children:"Cancel Order"})]})]})]}),(0,l.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(0, 198, 255, 0.2)",borderRadius:"16px",padding:"24px",height:"fit-content"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,l.jsxs)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#FFFFFF",margin:0},children:["Chat with ",G]}),!N&&(0,l.jsxs)("button",{onClick:async()=>{const e=L?r.seller_id:r.buyer_id;v(!0);try{const r=D?"/api/p2p/block/remove":"/api/p2p/block/add";if((await d.A.post("".concat(c).concat(r),{user_id:g.user_id,blocked_user_id:e})).data.success){if(P(!D),n.oR.success(D?"\u2705 User unblocked - Marketplace will update":"\ud83d\udeab User blocked - Redirecting to marketplace..."),!D)try{await d.A.post("".concat(c,"/api/p2p/favourites/remove"),{user_id:g.user_id,merchant_id:e})}catch(o){console.error("Failed to remove from favourites:",o)}setTimeout(()=>{t("/p2p")},1500)}}catch(s){var i,a;n.oR.error((null===(i=s.response)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.detail)||"Failed to update block status")}finally{v(!1)}},disabled:f,title:D?"Unblock user":"Block user",style:{padding:"8px 16px",background:D?"rgba(239, 68, 68, 0.1)":"rgba(143, 155, 179, 0.1)",border:"1px solid ".concat(D?"rgba(239, 68, 68, 0.3)":"rgba(143, 155, 179, 0.3)"),borderRadius:"8px",color:D?"#EF4444":"#8F9BB3",fontSize:"12px",fontWeight:"600",cursor:f?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s"},children:[(0,l.jsx)(s.Xyd,{size:14}),D?"Unblock":"Block"]})]}),(0,l.jsx)("div",{style:{height:"400px",overflowY:"auto",marginBottom:"16px",padding:"12px",background:"rgba(0, 0, 0, 0.2)",borderRadius:"8px"},children:0===h.length?(0,l.jsx)("div",{style:{textAlign:"center",color:"#8F9BB3",padding:"40px"},children:"No messages yet"}):h.map((e,t)=>{const r="SYSTEM"===e.sender_id,i=e.sender_id===g.user_id;return(0,l.jsxs)("div",{style:{marginBottom:"12px",padding:"12px",background:r?"rgba(255, 165, 0, 0.15)":i?"rgba(0, 198, 255, 0.1)":"rgba(143, 155, 179, 0.1)",border:r?"1px solid rgba(255, 165, 0, 0.3)":"none",borderRadius:"8px",textAlign:r?"center":i?"right":"left"},children:[(0,l.jsxs)("div",{style:{fontSize:"11px",color:r?"#FFA500":"#8F9BB3",marginBottom:"4px",fontWeight:r?"700":"600"},children:[r?"\ud83e\udd16 SYSTEM":i?"You":G,e.timestamp&&(0,l.jsx)("span",{style:{marginLeft:"8px",fontSize:"10px",opacity:.7},children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,l.jsx)("div",{style:{color:r?"#FFA500":"#FFFFFF",fontWeight:r?"600":"400"},children:e.message}),e.attachment&&(0,l.jsx)("img",{src:e.attachment,alt:"proof",style:{maxWidth:"200px",marginTop:"8px",borderRadius:"4px",cursor:"pointer"},onClick:()=>window.open(e.attachment,"_blank")})]},t)})}),(0,l.jsxs)("div",{style:{display:"flex",gap:"8px",flexDirection:"column"},children:[(0,l.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,l.jsx)("input",{type:"text",value:y,onChange:e=>m(e.target.value),onKeyPress:e=>"Enter"===e.key&&U(),placeholder:"Type a message...",style:{flex:1,padding:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(0, 198, 255, 0.2)",borderRadius:"8px",color:"#FFFFFF",fontSize:"14px"}}),(0,l.jsx)("button",{onClick:U,disabled:f||!y.trim()&&!_,style:{padding:"12px 20px",background:"linear-gradient(135deg, #00C6FF, #0099CC)",border:"none",borderRadius:"8px",color:"#FFFFFF",cursor:f?"not-allowed":"pointer"},children:(0,l.jsx)(s.$_z,{size:20})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>B(e.target.files[0]),id:"proof-upload",style:{display:"none"}}),(0,l.jsxs)("label",{htmlFor:"proof-upload",style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"8px 16px",background:"rgba(0, 198, 255, 0.1)",border:"1px solid rgba(0, 198, 255, 0.3)",borderRadius:"8px",color:"#00C6FF",fontSize:"14px",cursor:"pointer"},children:[(0,l.jsx)(s.xvb,{size:20}),_?_.name:"Upload Payment Proof"]})]})]})]})]})]})}),R&&(0,l.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,l.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"16px",padding:"32px",maxWidth:"480px",width:"90%"},children:[(0,l.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#FFFFFF",marginBottom:"16px"},children:"Open Dispute"}),(0,l.jsx)("p",{style:{color:"#8F9BB3",marginBottom:"16px"},children:"Please explain why you are opening a dispute. Admin will review and resolve."}),(0,l.jsx)("textarea",{value:S,onChange:e=>w(e.target.value),placeholder:"Describe the issue...",style:{width:"100%",height:"120px",padding:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#FFFFFF",fontSize:"14px",marginBottom:"16px",resize:"vertical"}}),(0,l.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,l.jsx)("button",{onClick:()=>C(!1),style:{flex:1,padding:"12px",background:"rgba(143, 155, 179, 0.1)",border:"1px solid rgba(143, 155, 179, 0.3)",borderRadius:"8px",color:"#8F9BB3",fontWeight:"600",cursor:"pointer"},children:"Cancel"}),(0,l.jsx)("button",{onClick:async()=>{if(S.trim()){v(!0);try{(await d.A.post("".concat(c,"/api/p2p/trade/dispute"),{trade_id:e,user_id:g.user_id,reason:S})).data.success&&(n.oR.success("Dispute opened. Admin will review."),C(!1),O(g.user_id))}catch(i){var t,r;n.oR.error((null===(t=i.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.detail)||"Failed to open dispute")}finally{v(!1)}}else n.oR.error("Please provide a reason for dispute")},disabled:f||!S.trim(),style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #EF4444, #DC2626)",border:"none",borderRadius:"8px",color:"#FFFFFF",fontWeight:"700",cursor:f||!S.trim()?"not-allowed":"pointer"},children:"Submit Dispute"})]})]})}),A&&(0,l.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,l.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(0, 198, 255, 0.3)",borderRadius:"16px",padding:"32px",maxWidth:"480px",width:"90%"},children:[(0,l.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#FFFFFF",marginBottom:"16px"},children:"Rate Your Counterparty"}),(0,l.jsxs)("p",{style:{color:"#8F9BB3",marginBottom:"20px"},children:["How was your experience with ",G,"?"]}),(0,l.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,l.jsx)("label",{style:{color:"#8F9BB3",fontSize:"14px",display:"block",marginBottom:"8px"},children:"Rating *"}),(0,l.jsx)("div",{style:{display:"flex",gap:"12px"},children:["positive","neutral","negative"].map(e=>(0,l.jsx)("button",{onClick:()=>E(e),style:{flex:1,padding:"12px",background:W===e?"positive"===e?"rgba(34, 197, 94, 0.2)":"neutral"===e?"rgba(255, 165, 0, 0.2)":"rgba(239, 68, 68, 0.2)":"rgba(143, 155, 179, 0.1)",border:W===e?"positive"===e?"2px solid #22C55E":"neutral"===e?"2px solid #FFA500":"2px solid #EF4444":"1px solid rgba(143, 155, 179, 0.3)",borderRadius:"8px",color:W===e?"positive"===e?"#22C55E":"neutral"===e?"#FFA500":"#EF4444":"#8F9BB3",fontWeight:W===e?"700":"400",cursor:"pointer",fontSize:"14px"},children:"positive"===e?"\ud83d\udc4d Positive":"neutral"===e?"\ud83d\ude10 Neutral":"\ud83d\udc4e Negative"},e))})]}),(0,l.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,l.jsx)("label",{style:{color:"#8F9BB3",fontSize:"14px",display:"block",marginBottom:"8px"},children:"Comment (Optional)"}),(0,l.jsx)("textarea",{value:I,onChange:e=>T(e.target.value),placeholder:"Share your experience... (max 500 characters)",maxLength:500,style:{width:"100%",height:"100px",padding:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(0, 198, 255, 0.3)",borderRadius:"8px",color:"#FFFFFF",fontSize:"14px",resize:"vertical"}}),(0,l.jsxs)("div",{style:{textAlign:"right",fontSize:"12px",color:"#8F9BB3",marginTop:"4px"},children:[I.length,"/500"]})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,l.jsx)("button",{onClick:()=>z(!1),style:{flex:1,padding:"12px",background:"rgba(143, 155, 179, 0.1)",border:"1px solid rgba(143, 155, 179, 0.3)",borderRadius:"8px",color:"#8F9BB3",fontWeight:"600",cursor:"pointer"},children:"Skip"}),(0,l.jsx)("button",{onClick:async()=>{if(I.trim()||""!==W){v(!0);try{(await d.A.post("".concat(c,"/api/p2p/trade/").concat(e,"/feedback"),{from_user_id:g.user_id,rating:W,comment:I.trim()})).data.success&&(n.oR.success("\u2705 Feedback submitted!"),z(!1),E("positive"),T(""))}catch(i){var t,r;n.oR.error((null===(t=i.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.detail)||"Failed to submit feedback")}finally{v(!1)}}else n.oR.error("Please provide a rating")},disabled:f,style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"8px",color:"#FFFFFF",fontWeight:"700",cursor:f?"not-allowed":"pointer",opacity:f?.6:1},children:f?"Submitting...":"Submit Feedback"})]})]})})]})}}]]);