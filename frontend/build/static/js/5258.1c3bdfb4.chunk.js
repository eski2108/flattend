"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5258],{5258:(e,t,o)=>{o.r(t),o.d(t,{default:()=>g});var r=o(9379),i=o(9950),a=o(4028),s=o(6910),n=o(2033),l=o(1330),d=o(9339),c=o(6604),p=o(4414);const x="https://coinhubx.net";function g(){const e=(0,a.Zp)(),[t,o]=(0,i.useState)(null),[g,u]=(0,i.useState)(!1),[b,h]=(0,i.useState)(!1),[F,y]=(0,i.useState)(null),[f,m]=(0,i.useState)(""),[j,v]=(0,i.useState)([]),[A,S]=(0,i.useState)(!1);(0,i.useEffect)(()=>{const t=localStorage.getItem("cryptobank_user");if(!t)return n.oR.error("Please login first"),void e("/login");const r=JSON.parse(t);o(r),h(r.is_two_factor_enabled||!1)},[e]);return(0,p.jsx)(l.A,{children:(0,p.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #05121F 0%, #0A1F2E 50%, #051018 100%)",padding:"24px"},children:(0,p.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[(0,p.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"12px"},children:[(0,p.jsx)(c.eeu,{size:40,color:"#00F0FF",style:{filter:"drop-shadow(0 0 8px rgba(0, 240, 255, 0.8))"}}),(0,p.jsx)("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#FFFFFF",margin:0},children:"Two-Factor Authentication"})]}),(0,p.jsx)("p",{style:{fontSize:"16px",color:"#8F9BB3",margin:0},children:"Add an extra layer of security to your account"})]}),(0,p.jsx)("div",{style:{background:"linear-gradient(135deg, rgba(0, 240, 255, 0.1) 0%, rgba(123, 44, 255, 0.05) 100%)",border:b?"1px solid rgba(0, 229, 69, 0.3)":"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"16px",padding:"24px",marginBottom:"24px",boxShadow:b?"0 0 20px rgba(0, 229, 69, 0.2)":"0 0 20px rgba(255, 165, 0, 0.2)"},children:(0,p.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[b?(0,p.jsx)(c.G3G,{size:32,color:"#00E545"}):(0,p.jsx)(c.dSe,{size:32,color:"#FFA500"}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",color:"#FFFFFF",margin:0,marginBottom:"4px"},children:b?"2FA Enabled":"2FA Disabled"}),(0,p.jsx)("p",{style:{fontSize:"14px",color:"#8F9BB3",margin:0},children:b?"Your account is protected with two-factor authentication":"Enable 2FA to secure your account"})]})]})})}),!b&&!F&&(0,p.jsxs)("div",{style:{background:"rgba(10, 20, 40, 0.6)",border:"1px solid rgba(0, 240, 255, 0.2)",borderRadius:"16px",padding:"32px",backdropFilter:"blur(10px)"},children:[(0,p.jsxs)("div",{style:{textAlign:"center",marginBottom:"32px"},children:[(0,p.jsx)(c.Su1,{size:64,color:"#00F0FF",style:{margin:"0 auto 16px",filter:"drop-shadow(0 0 12px rgba(0, 240, 255, 0.6))"}}),(0,p.jsx)("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#FFFFFF",marginBottom:"12px"},children:"Secure Your Account"}),(0,p.jsx)("p",{style:{fontSize:"16px",color:"#8F9BB3",marginBottom:"8px"},children:"Two-factor authentication adds an extra layer of security by requiring a code from your phone in addition to your password."}),(0,p.jsx)("p",{style:{fontSize:"14px",color:"#00F0FF",margin:0},children:"Supports: Google Authenticator, Microsoft Authenticator, Authy"})]}),(0,p.jsx)(d.A,{onClick:async()=>{if(t){u(!0);try{const e=await s.A.post("".concat(x,"/api/auth/2fa/setup"),{user_id:t.user_id,email:t.email});e.data.success?(y(e.data),v(e.data.backup_codes||[]),n.oR.success("2FA setup initiated. Please scan the QR code.")):n.oR.error(e.data.message||"Failed to setup 2FA")}catch(r){var e,o;console.error("2FA setup error:",r),n.oR.error((null===(e=r.response)||void 0===e||null===(o=e.data)||void 0===o?void 0:o.message)||"Failed to setup 2FA")}finally{u(!1)}}},disabled:g,style:{width:"100%",padding:"16px",fontSize:"16px"},children:g?"Setting up...":"Enable 2FA"})]}),!b&&F&&(0,p.jsxs)("div",{style:{background:"rgba(10, 20, 40, 0.6)",border:"1px solid rgba(0, 240, 255, 0.2)",borderRadius:"16px",padding:"32px",backdropFilter:"blur(10px)"},children:[(0,p.jsx)("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#FFFFFF",marginBottom:"24px",textAlign:"center"},children:"Scan QR Code"}),F.qr_code&&(0,p.jsxs)("div",{style:{textAlign:"center",marginBottom:"24px"},children:[(0,p.jsx)("div",{style:{background:"#FFFFFF",padding:"16px",borderRadius:"12px",display:"inline-block",boxShadow:"0 4px 20px rgba(0, 240, 255, 0.3)"},children:(0,p.jsx)("img",{src:F.qr_code,alt:"2FA QR Code",style:{width:"250px",height:"250px",display:"block"}})}),(0,p.jsx)("p",{style:{fontSize:"14px",color:"#8F9BB3",marginTop:"16px"},children:"Scan this QR code with your authenticator app"})]}),F.secret&&(0,p.jsxs)("div",{style:{background:"rgba(0, 240, 255, 0.05)",border:"1px solid rgba(0, 240, 255, 0.2)",borderRadius:"8px",padding:"16px",marginBottom:"24px"},children:[(0,p.jsx)("p",{style:{fontSize:"14px",color:"#8F9BB3",marginBottom:"8px"},children:"Or enter this code manually:"}),(0,p.jsx)("code",{style:{fontSize:"18px",fontWeight:"600",color:"#00F0FF",letterSpacing:"2px",display:"block",textAlign:"center"},children:F.secret})]}),(0,p.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,p.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#FFFFFF",marginBottom:"8px"},children:"Enter 6-digit code from your app"}),(0,p.jsx)("input",{type:"text",value:f,onChange:e=>m(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:"6",style:{width:"100%",padding:"14px",background:"rgba(10, 20, 40, 0.8)",border:"1px solid rgba(0, 240, 255, 0.3)",borderRadius:"8px",color:"#FFFFFF",fontSize:"20px",textAlign:"center",letterSpacing:"8px",fontWeight:"600"}})]}),(0,p.jsx)(d.A,{onClick:async()=>{if(f&&6===f.length){u(!0);try{const e=await s.A.post("".concat(x,"/api/auth/2fa/verify"),{user_id:t.user_id,code:f});if(e.data.success){h(!0),S(!0);const e=(0,r.A)((0,r.A)({},t),{},{is_two_factor_enabled:!0});localStorage.setItem("cryptobank_user",JSON.stringify(e)),o(e),n.oR.success("\ud83c\udf89 2FA enabled successfully!")}else n.oR.error(e.data.message||"Verification failed")}catch(a){var e,i;console.error("2FA verification error:",a),n.oR.error((null===(e=a.response)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.message)||"Verification failed")}finally{u(!1)}}else n.oR.error("Please enter a valid 6-digit code")},disabled:g||6!==f.length,style:{width:"100%",padding:"16px",fontSize:"16px"},children:g?"Verifying...":"Verify and Enable 2FA"})]}),(A||b&&j.length>0)&&(0,p.jsxs)("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"16px",padding:"24px",marginTop:"24px"},children:[(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[(0,p.jsx)(c.OiL,{size:24,color:"#FFA500"}),(0,p.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",color:"#FFFFFF",margin:0},children:"Backup Codes"})]}),(0,p.jsx)("p",{style:{fontSize:"14px",color:"#8F9BB3",marginBottom:"16px"},children:"Save these codes in a secure location. Each code can be used once if you lose access to your authenticator app."}),(0,p.jsx)("div",{style:{background:"rgba(10, 20, 40, 0.8)",border:"1px solid rgba(0, 240, 255, 0.2)",borderRadius:"8px",padding:"16px",marginBottom:"16px",fontFamily:"monospace"},children:j.map((e,t)=>(0,p.jsx)("div",{style:{fontSize:"16px",color:"#00F0FF",padding:"8px",borderBottom:t<j.length-1?"1px solid rgba(0, 240, 255, 0.1)":"none"},children:e},t))}),(0,p.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,p.jsxs)(d.A,{onClick:()=>{const e=j.join("\n");navigator.clipboard.writeText(e),n.oR.success("Backup codes copied to clipboard")},style:{flex:1,padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,p.jsx)(c.iyF,{size:18})," Copy"]}),(0,p.jsxs)(d.A,{onClick:()=>{const e=j.join("\n"),o=new Blob([e],{type:"text/plain"}),r=URL.createObjectURL(o),i=document.createElement("a");i.href=r,i.download="coinhubx-backup-codes-".concat(t.user_id,".txt"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),n.oR.success("Backup codes downloaded")},style:{flex:1,padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,p.jsx)(c.y10,{size:18})," Download"]})]})]}),b&&(0,p.jsxs)("div",{style:{background:"rgba(10, 20, 40, 0.6)",border:"1px solid rgba(0, 240, 255, 0.2)",borderRadius:"16px",padding:"24px",marginTop:"24px"},children:[(0,p.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",color:"#FFFFFF",marginBottom:"16px"},children:"Manage 2FA"}),(0,p.jsx)("p",{style:{fontSize:"14px",color:"#8F9BB3",marginBottom:"24px"},children:"Your account is currently protected with two-factor authentication. You can disable it at any time."}),(0,p.jsx)("button",{onClick:async()=>{if(window.confirm("Are you sure you want to disable 2FA? This will make your account less secure.")){u(!0);try{const e=await s.A.post("".concat(x,"/api/auth/2fa/disable"),{user_id:t.user_id});if(e.data.success){h(!1),y(null),v([]),S(!1);const e=(0,r.A)((0,r.A)({},t),{},{is_two_factor_enabled:!1});localStorage.setItem("cryptobank_user",JSON.stringify(e)),o(e),n.oR.success("2FA disabled")}else n.oR.error(e.data.message||"Failed to disable 2FA")}catch(a){var e,i;console.error("2FA disable error:",a),n.oR.error((null===(e=a.response)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.message)||"Failed to disable 2FA")}finally{u(!1)}}},disabled:g,style:{width:"100%",padding:"14px",background:"rgba(255, 0, 0, 0.2)",border:"1px solid rgba(255, 0, 0, 0.4)",borderRadius:"8px",color:"#FF4444",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{e.target.style.background="rgba(255, 0, 0, 0.3)",e.target.style.borderColor="rgba(255, 0, 0, 0.6)"},onMouseLeave:e=>{e.target.style.background="rgba(255, 0, 0, 0.2)",e.target.style.borderColor="rgba(255, 0, 0, 0.4)"},children:g?"Disabling...":"Disable 2FA"})]})]})})})}}}]);