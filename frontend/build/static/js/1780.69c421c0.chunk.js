"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1780],{1780:(e,r,t)=>{t.r(r),t.d(r,{default:()=>g});var o=t(9950),i=t(4028),a=t(1330),s=t(3645),l=t(4779),n=t(6604),d=t(6910),c=t(2033),m=t(4414);const p="https://bugsecurehub.preview.emergentagent.com";function g(){var e,r,t,g;const x=(0,i.zy)(),u=(0,i.Zp)(),f=(null===(e=x.state)||void 0===e?void 0:e.offer)||null,[h,y]=(0,o.useState)(""),[b,v]=(0,o.useState)(""),[j,S]=(0,o.useState)("fiat"),[k,w]=(0,o.useState)(!1),[F,_]=(0,o.useState)(null),[z,B]=(0,o.useState)(""),[C,R]=(0,o.useState)(""),[W,T]=(0,o.useState)(null),[E,A]=(0,o.useState)(!1);(0,o.useEffect)(()=>{const e=localStorage.getItem("cryptobank_user");if(!e)return void u("/login");const r=JSON.parse(e);if(_(r),!f)return c.oR.error("No offer selected"),void u("/p2p-marketplace");const t=(f.min_purchase+f.max_purchase)/2,o=(t*f.price_per_unit).toFixed(2);y(t.toFixed(8)),v(o)},[f,u]);(0,o.useEffect)(()=>{if(z&&z.length>=20&&null!==f&&void 0!==f&&f.crypto_currency){const e=setTimeout(()=>{!async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e||e.length<20)T({valid:!1,message:"Address too short"});else{A(!0);try{const o=await d.A.post("".concat(p,"/api/wallet/validate"),{address:e,currency:r,network:t||void 0});o.data.success&&T({valid:o.data.valid,message:o.data.message,network:o.data.detected_network})}catch(o){T({valid:!1,message:"Validation failed. Please check your address."})}finally{A(!1)}}}(z,f.crypto_currency,C)},800);return()=>clearTimeout(e)}T(null)},[z,C,null===f||void 0===f?void 0:f.crypto_currency]);if(!f)return(0,m.jsx)(a.A,{children:(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",flexDirection:"column",gap:"1rem"},children:[(0,m.jsx)("p",{style:{color:"#888",fontSize:"18px"},children:"No offer selected"}),(0,m.jsx)(s.$,{onClick:()=>u("/p2p-marketplace"),children:"Back to Marketplace"})]})});const I=f.fiat_currency||"GBP",P=(e=>({USD:"$",GBP:"\xa3",EUR:"\u20ac"}[e]||"$"))(I),M=(f.min_purchase*f.price_per_unit).toFixed(2),D=(f.max_purchase*f.price_per_unit).toFixed(2),N=f.crypto_currency||"BTC";return(0,m.jsx)(a.A,{children:(0,m.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"1.5rem 1rem"},children:[(0,m.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,m.jsx)("h1",{style:{fontSize:"1.75rem",fontWeight:"900",color:"#00F0FF",marginBottom:"0.5rem"},children:"Order Preview"}),(0,m.jsx)("p",{style:{color:"#888",fontSize:"0.875rem"},children:"Review details before confirming your purchase"})]}),(0,m.jsx)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1rem"},children:[(0,m.jsx)("div",{style:{width:"56px",height:"56px",borderRadius:"50%",background:"linear-gradient(135deg, #00F0FF, #A855F7)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",fontWeight:"700",color:"#000",flexShrink:0},children:(null===(r=f.seller_name)||void 0===r?void 0:r.substring(0,2).toUpperCase())||"SE"}),(0,m.jsxs)("div",{style:{flex:1,minWidth:0,overflow:"hidden"},children:[(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem",flexWrap:"wrap"},children:[(0,m.jsx)("span",{style:{fontSize:"1.125rem",fontWeight:"700",color:"#fff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"200px"},children:f.seller_name||"Seller****"}),(0,m.jsx)(CheckCircle2,{size:18,style:{color:"#10B981",flexShrink:0}})]}),(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.8125rem",flexWrap:"wrap"},children:[(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",flexShrink:0},children:[(0,m.jsx)(n.DBe,{size:14,fill:"#FFD700",stroke:"#FFD700"}),(0,m.jsx)("span",{style:{color:"#fff",fontWeight:"600"},children:"4.8"})]}),(0,m.jsx)("span",{style:{color:"#888",flexShrink:0},children:"156 trades"}),(0,m.jsx)("span",{style:{color:"#10B981",fontWeight:"600",flexShrink:0},children:"98.5%"})]})]})]})}),(0,m.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,m.jsxs)("div",{style:{marginBottom:"1.25rem"},children:[(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.8125rem",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:["Price per ",N]}),(0,m.jsxs)("div",{style:{color:"#00F0FF",fontSize:"1.75rem",fontWeight:"900"},children:[P,null===(t=f.price_per_unit)||void 0===t?void 0:t.toLocaleString()]})]}),(0,m.jsxs)("div",{style:{paddingTop:"1rem",borderTop:"1px solid rgba(0, 240, 255, 0.15)"},children:[(0,m.jsx)("div",{style:{color:"#888",fontSize:"0.8125rem",marginBottom:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Order Limits"}),(0,m.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,m.jsxs)("div",{style:{overflow:"hidden"},children:[(0,m.jsx)("div",{style:{color:"#666",fontSize:"0.75rem",marginBottom:"0.25rem"},children:"Minimum"}),(0,m.jsxs)("div",{style:{color:"#fff",fontSize:"0.9375rem",fontWeight:"700"},children:[P,M]}),(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.75rem"},children:[f.min_purchase," ",N]})]}),(0,m.jsxs)("div",{style:{overflow:"hidden"},children:[(0,m.jsx)("div",{style:{color:"#666",fontSize:"0.75rem",marginBottom:"0.25rem"},children:"Maximum"}),(0,m.jsxs)("div",{style:{color:"#fff",fontSize:"0.9375rem",fontWeight:"700"},children:[P,D]}),(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.75rem"},children:[f.max_purchase," ",N]})]})]})]})]}),(0,m.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem",overflow:"hidden"},children:[(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem",flexWrap:"wrap",gap:"0.5rem"},children:[(0,m.jsx)("div",{style:{color:"#888",fontSize:"0.8125rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Enter Amount"}),(0,m.jsxs)("button",{onClick:()=>S("fiat"===j?"crypto":"fiat"),style:{background:"rgba(0, 240, 255, 0.1)",border:"1px solid rgba(0, 240, 255, 0.3)",borderRadius:"8px",padding:"0.375rem 0.75rem",color:"#00F0FF",fontSize:"0.75rem",fontWeight:"700",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.375rem",transition:"all 0.2s",flexShrink:0},onMouseEnter:e=>{e.currentTarget.style.background="rgba(0, 240, 255, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(0, 240, 255, 0.1)"},children:[(0,m.jsx)(ArrowRightLeft,{size:14}),"Switch to ","fiat"===j?N:I]})]}),"fiat"===j?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,m.jsxs)("label",{style:{color:"#888",fontSize:"0.8125rem",display:"block",marginBottom:"0.5rem"},children:["Amount (",I,")"]}),(0,m.jsx)(l.p,{type:"number",value:b,onChange:e=>(e=>{if(v(e),e&&f&&parseFloat(e)>0){const r=parseFloat(e)/f.price_per_unit;y(r.toFixed(8))}else y("")})(e.target.value),placeholder:"0.00",style:{fontSize:"1.25rem",fontWeight:"700",color:"#fff",background:"rgba(0, 0, 0, 0.4)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"10px",padding:"1rem",width:"100%"}})]}),(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.875rem"},children:["\u2248 ",(0,m.jsxs)("span",{style:{color:"#A855F7",fontWeight:"600"},children:[h||"0.00000000"," ",N]})]})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,m.jsxs)("label",{style:{color:"#888",fontSize:"0.8125rem",display:"block",marginBottom:"0.5rem"},children:["Amount (",N,")"]}),(0,m.jsx)(l.p,{type:"number",value:h,onChange:e=>(e=>{if(y(e),e&&f&&parseFloat(e)>0){const r=parseFloat(e)*f.price_per_unit;v(r.toFixed(2))}else v("")})(e.target.value),placeholder:"0.00000000",style:{fontSize:"1.25rem",fontWeight:"700",color:"#fff",background:"rgba(0, 0, 0, 0.4)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"10px",padding:"1rem",width:"100%"}})]}),(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.875rem"},children:["\u2248 ",(0,m.jsxs)("span",{style:{color:"#A855F7",fontWeight:"600"},children:[P,b||"0.00"]})]})]})]}),(0,m.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem",overflow:"hidden"},children:[(0,m.jsx)("div",{style:{color:"#888",fontSize:"0.8125rem",marginBottom:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Payment Methods Available"}),(0,m.jsx)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:null===(g=f.payment_methods)||void 0===g?void 0:g.slice(0,3).map((e,r)=>(0,m.jsxs)("div",{style:{background:"rgba(0, 240, 255, 0.1)",border:"1px solid rgba(0, 240, 255, 0.3)",borderRadius:"8px",padding:"0.5rem 1rem",color:"#00F0FF",fontSize:"0.8125rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[(0,m.jsx)(n.dXk,{size:16}),e.replace(/_/g," ").toUpperCase()]},r))})]}),(0,m.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(168, 85, 247, 0.4)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,m.jsxs)("div",{style:{color:"#A855F7",fontSize:"0.875rem",marginBottom:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",fontWeight:"700",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,m.jsx)(n.eeu,{size:18}),"Your Wallet Address (Where you'll receive ",N,")"]}),(0,m.jsx)("div",{style:{marginBottom:"0.75rem"},children:(0,m.jsx)(l.p,{type:"text",value:z,onChange:e=>B(e.target.value),placeholder:"Enter your ".concat(N," wallet address"),disabled:k,style:{fontSize:"0.875rem",color:"#fff",background:"rgba(0, 0, 0, 0.4)",border:null!==W&&void 0!==W&&W.valid?"2px solid #22C55E":"2px solid rgba(168, 85, 247, 0.3)",borderRadius:"10px",padding:"0.875rem",width:"100%",fontFamily:"monospace"}})}),"USDT"===(null===f||void 0===f?void 0:f.crypto_currency)&&(0,m.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,m.jsx)("label",{style:{color:"#888",fontSize:"0.75rem",display:"block",marginBottom:"0.5rem"},children:"Network (Optional - defaults to ERC20)"}),(0,m.jsxs)("select",{value:C,onChange:e=>R(e.target.value),disabled:k,style:{fontSize:"0.875rem",color:"#fff",background:"rgba(0, 0, 0, 0.4)",border:"2px solid rgba(168, 85, 247, 0.3)",borderRadius:"10px",padding:"0.75rem",width:"100%",cursor:"pointer"},children:[(0,m.jsx)("option",{value:"",children:"ERC20 (Ethereum)"}),(0,m.jsx)("option",{value:"TRC20",children:"TRC20 (TRON)"}),(0,m.jsx)("option",{value:"BEP20",children:"BEP20 (BSC)"})]})]}),E&&(0,m.jsxs)("div",{style:{padding:"0.75rem",background:"rgba(0, 240, 255, 0.1)",border:"1px solid rgba(0, 240, 255, 0.3)",borderRadius:"8px",color:"#00F0FF",fontSize:"0.8125rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,m.jsx)("div",{className:"spinner",style:{width:"16px",height:"16px",borderWidth:"2px"}}),"Validating address..."]}),W&&!E&&(0,m.jsxs)("div",{style:{padding:"0.75rem",background:W.valid?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",border:"1px solid ".concat(W.valid?"#22C55E":"#EF4444"),borderRadius:"8px",color:W.valid?"#22C55E":"#EF4444",fontSize:"0.8125rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[W.valid?(0,m.jsx)(CheckCircle2,{size:16}):"\u274c",W.message,W.network&&" (".concat(W.network,")")]}),(0,m.jsx)("div",{style:{color:"#888",fontSize:"0.75rem",marginTop:"0.75rem",lineHeight:"1.5"},children:"\u26a0\ufe0f Important: Double-check your wallet address. Crypto sent to wrong address cannot be recovered."})]}),(0,m.jsx)("button",{onClick:async()=>{if((()=>{const e=parseFloat(h);return!e||e<=0?(c.oR.error("Please enter a valid amount"),!1):e<f.min_purchase?(c.oR.error("Minimum order is ".concat(f.min_purchase," ").concat(f.crypto_currency)),!1):!(e>f.max_purchase)||(c.oR.error("Maximum order is ".concat(f.max_purchase," ").concat(f.crypto_currency)),!1)})())if(z&&z.trim())if(!W||W.valid){w(!0);try{const e=await d.A.post("".concat(p,"/api/p2p/create-trade"),{sell_order_id:f.order_id,buyer_id:F.user_id,crypto_amount:parseFloat(h),payment_method:f.payment_methods[0],buyer_wallet_address:z.trim(),buyer_wallet_network:C||void 0});e.data.success&&(c.oR.success("Trade created! Crypto locked in escrow."),setTimeout(()=>{u("/trade/".concat(e.data.trade.trade_id))},1500))}catch(t){var e,r;console.error("Error creating trade:",t),c.oR.error((null===(e=t.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.detail)||"Failed to create trade")}finally{w(!1)}}else c.oR.error("Please enter a valid wallet address");else c.oR.error("Please enter your wallet address")},disabled:k||!h||parseFloat(h)<=0||!z.trim(),style:{width:"100%",minHeight:"60px",background:k||!h||parseFloat(h)<=0||!z.trim()?"rgba(100,100,100,0.5)":"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"16px",fontSize:"1.125rem",fontWeight:"900",color:"#fff",cursor:k||!h||parseFloat(h)<=0||!z.trim()?"not-allowed":"pointer",boxShadow:k||!h||parseFloat(h)<=0||!z.trim()?"none":"0 4px 24px rgba(34, 197, 94, 0.5), 0 0 40px rgba(34, 197, 94, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",opacity:k||!h||parseFloat(h)<=0||!z.trim()?.5:1,transition:"all 0.3s"},onMouseEnter:e=>{!k&&h&&parseFloat(h)>0&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 8px 40px rgba(34, 197, 94, 0.7), 0 0 60px rgba(34, 197, 94, 0.5)")},onMouseLeave:e=>{!k&&h&&parseFloat(h)>0&&(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 24px rgba(34, 197, 94, 0.5), 0 0 40px rgba(34, 197, 94, 0.3)")},children:k?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",borderWidth:"2px"}}),"Processing..."]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(n.eeu,{size:24}),"Confirm & Lock in Escrow"]})})]})})}}}]);