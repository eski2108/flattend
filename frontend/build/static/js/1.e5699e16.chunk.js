"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1],[,(e,t,r)=>{r.r(t),r.d(t,{default:()=>x});var i=r(9950),s=r(4028),a=r(5030),o=r(1330),d=r(6604),n=r(6910),l=r(2033),p=r(4414);const c="https://express-buy-flow.preview.emergentagent.com";function x(){const{t:e}=(0,a.Bd)(),{tradeId:t}=(0,s.g)(),r=(0,s.Zp)(),[x,u]=(0,i.useState)(null),[g,b]=(0,i.useState)(!0),[F,h]=(0,i.useState)(null),[y,m]=(0,i.useState)([]),[f,v]=(0,i.useState)(""),[j,k]=(0,i.useState)(!1),[_,B]=(0,i.useState)(0),[S,R]=(0,i.useState)(null),[w,C]=(0,i.useState)(""),[A,z]=(0,i.useState)(!1),[W,E]=(0,i.useState)(!1),[I,T]=(0,i.useState)("positive"),[P,N]=(0,i.useState)(""),[D,M]=(0,i.useState)(!1),[O,U]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(x&&"completed"===x.status&&!W){F&&(async()=>{try{(await n.A.get("".concat(c,"/api/p2p/trade/").concat(t,"/feedback-check?user_id=").concat(null===F||void 0===F?void 0:F.user_id))).data.feedback_given||setTimeout(()=>E(!0),1e3)}catch(e){setTimeout(()=>E(!0),1e3)}})()}},[null===x||void 0===x?void 0:x.status,F]),(0,i.useEffect)(()=>{const e=localStorage.getItem("cryptobank_user");if(!e)return void r("/login");const t=JSON.parse(e);h(t),Y(t.user_id);const i=setInterval(()=>Y(t.user_id),5e3);return()=>clearInterval(i)},[t,r]),(0,i.useEffect)(()=>{if(x&&F){const e=H?x.seller_id:x.buyer_id;G(e)}},[x,F]),(0,i.useEffect)(()=>{if(x&&x.expires_at){const e=setInterval(()=>{const t=new Date,r=new Date(x.expires_at),i=Math.floor((r-t)/1e3);i<=0?(B(0),clearInterval(e)):B(i)},1e3);return()=>clearInterval(e)}},[x]);const Y=async e=>{try{const i=await n.A.get("".concat(c,"/api/p2p/trade/").concat(t,"?user_id=").concat(e));i.data.success&&(u(i.data.trade),i.data.messages&&m(i.data.messages),i.data.blocked&&(l.oR.error("This trade involves a blocked user. Redirecting..."),setTimeout(()=>r("/p2p"),2e3)))}catch(s){var i;console.error("Error fetching trade:",s),403===(null===(i=s.response)||void 0===i?void 0:i.status)?(l.oR.error("Access denied: User is blocked"),r("/p2p")):l.oR.error("Failed to load trade details")}finally{b(!1)}},L=async()=>{if(f.trim()||S){k(!0);try{const e=new FormData;e.append("trade_id",t),e.append("sender_id",F.user_id),e.append("message",f),S&&e.append("attachment",S);(await n.A.post("".concat(c,"/api/p2p/trade/message"),e,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(v(""),R(null),Y(F.user_id))}catch(e){l.oR.error("Failed to send message")}finally{k(!1)}}},G=async e=>{try{const t=await n.A.get("".concat(c,"/api/p2p/blocked/").concat(F.user_id));if(t.data.success){const r=t.data.blocked_users||[];M(r.includes(e))}}catch(t){console.error("Error checking block status:",t)}finally{U(!1)}};if(g)return(0,p.jsx)(o.A,{children:(0,p.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#fff"},children:"Loading..."})});if(!x)return(0,p.jsx)(o.A,{children:(0,p.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#fff"},children:"Trade not found"})});const H=(null===F||void 0===F?void 0:F.user_id)===x.buyer_id,J=H?"Seller":"Buyer";return(0,p.jsxs)(o.A,{children:[(0,p.jsx)("div",{style:{minHeight:"100vh",padding:"40px 20px",background:"linear-gradient(180deg, #05121F 0%, #071E2C 100%)"},children:(0,p.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(0, 198, 255, 0.2)",borderRadius:"16px",padding:"24px",marginBottom:"24px"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,p.jsxs)("h1",{style:{fontSize:"28px",fontWeight:"700",color:"#FFFFFF"},children:[H?"Buy":"Sell"," ",x.crypto_currency]}),(0,p.jsx)("div",{style:{padding:"8px 16px",background:"completed"===x.status?"rgba(34, 197, 94, 0.1)":"rgba(255, 165, 0, 0.1)",border:"1px solid ".concat("completed"===x.status?"rgba(34, 197, 94, 0.3)":"rgba(255, 165, 0, 0.3)"),borderRadius:"8px",color:"completed"===x.status?"#22C55E":"#FFA500",fontWeight:"600"},children:"pending_payment"===x.status?e("p2p.status.waitingForPayment"):"payment_made"===x.status?e("p2p.status.paymentMade"):"completed"===x.status?e("p2p.status.completed"):"cancelled"===x.status?e("p2p.status.cancelled"):"disputed"===x.status?e("p2p.status.disputed"):x.status})]}),_>0&&"pending_payment"===x.status&&(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px"},children:[(0,p.jsx)(d.Gm4,{size:20,color:"#EF4444"}),(0,p.jsxs)("span",{style:{color:"#EF4444",fontWeight:"600"},children:["Time remaining: ",Math.floor(_/60),":",(_%60).toString().padStart(2,"0")]})]})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 400px",gap:"24px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(0, 198, 255, 0.2)",borderRadius:"16px",padding:"24px",marginBottom:"24px"},children:[(0,p.jsx)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#FFFFFF",marginBottom:"16px"},children:"Order Details"}),(0,p.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,p.jsx)("span",{style:{color:"#8F9BB3"},children:"Amount"}),(0,p.jsxs)("span",{style:{color:"#FFFFFF",fontWeight:"600"},children:[x.crypto_amount," ",x.crypto_currency]})]}),(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,p.jsx)("span",{style:{color:"#8F9BB3"},children:"Price"}),(0,p.jsxs)("span",{style:{color:"#FFFFFF",fontWeight:"600"},children:["\xa3",(x.fiat_amount/x.crypto_amount).toFixed(2)]})]}),(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,p.jsx)("span",{style:{color:"#8F9BB3"},children:"Total"}),(0,p.jsxs)("span",{style:{color:"#00C6FF",fontWeight:"700",fontSize:"20px"},children:["\xa3",x.fiat_amount.toFixed(2)]})]})]})]}),H&&x.seller_payment_details&&"pending_payment"===x.status&&(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"16px",padding:"24px",marginBottom:"24px"},children:[(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[(0,p.jsx)(d.eeu,{size:24,color:"#FFA500"}),(0,p.jsx)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#FFFFFF"},children:"Payment Instructions"})]}),(0,p.jsx)("div",{style:{background:"rgba(255, 165, 0, 0.05)",padding:"16px",borderRadius:"8px"},children:(0,p.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Bank Name"}),(0,p.jsx)("div",{style:{color:"#FFFFFF",fontWeight:"600"},children:x.seller_payment_details.bank_name})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Account Name"}),(0,p.jsx)("div",{style:{color:"#FFFFFF",fontWeight:"600"},children:x.seller_payment_details.account_name})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Account Number"}),(0,p.jsx)("div",{style:{color:"#FFFFFF",fontWeight:"600"},children:x.seller_payment_details.account_number})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Sort Code"}),(0,p.jsx)("div",{style:{color:"#FFFFFF",fontWeight:"600"},children:x.seller_payment_details.sort_code})]}),x.seller_payment_details.notes&&(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{style:{fontSize:"12px",color:"#8F9BB3",marginBottom:"4px"},children:"Notes"}),(0,p.jsx)("div",{style:{color:"#FFA500"},children:x.seller_payment_details.notes})]})]})})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[H&&"pending_payment"===x.status&&(0,p.jsxs)("button",{onClick:async()=>{k(!0);try{(await n.A.post("".concat(c,"/api/p2p/trade/mark-paid"),{trade_id:t,user_id:F.user_id})).data.success&&(l.oR.success(e("p2p.paymentMarkedSuccess")),Y(F.user_id))}catch(s){var r,i;l.oR.error((null===(r=s.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.detail)||"Failed to mark as paid")}finally{k(!1)}},disabled:j,style:{flex:1,padding:"16px",background:"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"12px",color:"#FFFFFF",fontSize:"16px",fontWeight:"700",cursor:j?"not-allowed":"pointer",boxShadow:"0 0 20px rgba(34, 197, 94, 0.4)"},children:[(0,p.jsx)(d.G3G,{size:20,style:{marginRight:"8px",verticalAlign:"middle"}}),e("p2p.buttons.markAsPaid")]}),!H&&"payment_made"===x.status&&(0,p.jsx)("button",{onClick:async()=>{k(!0);try{(await n.A.post("".concat(c,"/api/p2p/trade/release"),{trade_id:t,user_id:F.user_id})).data.success&&(l.oR.success("\u2705 Crypto released successfully!"),Y(F.user_id))}catch(i){var e,r;l.oR.error((null===(e=i.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.detail)||"Failed to release crypto")}finally{k(!1)}},disabled:j,style:{flex:1,padding:"16px",background:"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"12px",color:"#FFFFFF",fontSize:"16px",fontWeight:"700",cursor:j?"not-allowed":"pointer",boxShadow:"0 0 20px rgba(34, 197, 94, 0.4)"},children:e("p2p.buttons.releaseCrypto")}),"completed"===x.status&&(0,p.jsxs)("button",{onClick:()=>E(!0),style:{flex:1,padding:"16px",background:"linear-gradient(135deg, #FFA500, #FF8C00)",border:"none",borderRadius:"12px",color:"#FFFFFF",fontSize:"16px",fontWeight:"700",cursor:"pointer",boxShadow:"0 0 20px rgba(255, 165, 0, 0.4)"},children:["\u2b50 ",e("p2p.buttons.rateTrade")]}),"completed"!==x.status&&"cancelled"!==x.status&&"disputed"!==x.status&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("button",{onClick:()=>z(!0),disabled:j,style:{padding:"16px 24px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"12px",color:"#EF4444",fontSize:"16px",fontWeight:"600",cursor:j?"not-allowed":"pointer"},children:[(0,p.jsx)(d.tr_,{size:20,style:{marginRight:"8px",verticalAlign:"middle"}}),e("p2p.buttons.dispute")]}),H&&"pending_payment"===x.status&&(0,p.jsx)("button",{onClick:async()=>{if(window.confirm("Are you sure you want to cancel this order?")){k(!0);try{(await n.A.post("".concat(c,"/api/p2p/trade/cancel"),{trade_id:t,user_id:F.user_id})).data.success&&(l.oR.success("Order cancelled"),Y(F.user_id))}catch(i){var e,r;l.oR.error((null===(e=i.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.detail)||"Failed to cancel")}finally{k(!1)}}},disabled:j,style:{padding:"16px 24px",background:"rgba(143, 155, 179, 0.1)",border:"1px solid rgba(143, 155, 179, 0.3)",borderRadius:"12px",color:"#8F9BB3",fontSize:"16px",fontWeight:"600",cursor:j?"not-allowed":"pointer"},children:e("p2p.buttons.cancelOrder")})]})]})]}),(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(0, 198, 255, 0.2)",borderRadius:"16px",padding:"24px",height:"fit-content"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,p.jsxs)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#FFFFFF",margin:0},children:["Chat with ",J]}),!O&&(0,p.jsxs)("button",{onClick:async()=>{const e=H?x.seller_id:x.buyer_id;k(!0);try{const t=D?"/api/p2p/block/remove":"/api/p2p/block/add";if((await n.A.post("".concat(c).concat(t),{user_id:F.user_id,blocked_user_id:e})).data.success){if(M(!D),l.oR.success(D?"\u2705 User unblocked - Marketplace will update":"\ud83d\udeab User blocked - Redirecting to marketplace..."),!D)try{await n.A.post("".concat(c,"/api/p2p/favourites/remove"),{user_id:F.user_id,merchant_id:e})}catch(s){console.error("Failed to remove from favourites:",s)}setTimeout(()=>{r("/p2p")},1500)}}catch(a){var t,i;l.oR.error((null===(t=a.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.detail)||"Failed to update block status")}finally{k(!1)}},disabled:j,title:D?"Unblock user":"Block user",style:{padding:"8px 16px",background:D?"rgba(239, 68, 68, 0.1)":"rgba(143, 155, 179, 0.1)",border:"1px solid ".concat(D?"rgba(239, 68, 68, 0.3)":"rgba(143, 155, 179, 0.3)"),borderRadius:"8px",color:D?"#EF4444":"#8F9BB3",fontSize:"12px",fontWeight:"600",cursor:j?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s"},children:[(0,p.jsx)(d.Xyd,{size:14}),D?"Unblock":"Block"]})]}),(0,p.jsx)("div",{style:{height:"400px",overflowY:"auto",marginBottom:"16px",padding:"12px",background:"rgba(0, 0, 0, 0.2)",borderRadius:"8px"},children:0===y.length?(0,p.jsx)("div",{style:{textAlign:"center",color:"#8F9BB3",padding:"40px"},children:"No messages yet"}):y.map((e,t)=>{const r="SYSTEM"===e.sender_id,i=e.sender_id===F.user_id;return(0,p.jsxs)("div",{style:{marginBottom:"12px",padding:"12px",background:r?"rgba(255, 165, 0, 0.15)":i?"rgba(0, 198, 255, 0.1)":"rgba(143, 155, 179, 0.1)",border:r?"1px solid rgba(255, 165, 0, 0.3)":"none",borderRadius:"8px",textAlign:r?"center":i?"right":"left"},children:[(0,p.jsxs)("div",{style:{fontSize:"11px",color:r?"#FFA500":"#8F9BB3",marginBottom:"4px",fontWeight:r?"700":"600"},children:[r?"\ud83e\udd16 SYSTEM":i?"You":J,e.timestamp&&(0,p.jsx)("span",{style:{marginLeft:"8px",fontSize:"10px",opacity:.7},children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,p.jsx)("div",{style:{color:r?"#FFA500":"#FFFFFF",fontWeight:r?"600":"400"},children:e.message}),e.attachment&&(0,p.jsx)("img",{src:e.attachment,alt:"proof",style:{maxWidth:"200px",marginTop:"8px",borderRadius:"4px",cursor:"pointer"},onClick:()=>window.open(e.attachment,"_blank")})]},t)})}),(0,p.jsxs)("div",{style:{display:"flex",gap:"8px",flexDirection:"column"},children:[(0,p.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,p.jsx)("input",{type:"text",value:f,onChange:e=>v(e.target.value),onKeyPress:e=>"Enter"===e.key&&L(),placeholder:"Type a message...",style:{flex:1,padding:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(0, 198, 255, 0.2)",borderRadius:"8px",color:"#FFFFFF",fontSize:"14px"}}),(0,p.jsx)("button",{onClick:L,disabled:j||!f.trim()&&!S,style:{padding:"12px 20px",background:"linear-gradient(135deg, #00C6FF, #0099CC)",border:"none",borderRadius:"8px",color:"#FFFFFF",cursor:j?"not-allowed":"pointer"},children:(0,p.jsx)(d.$_z,{size:20})})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("input",{type:"file",accept:"image/*",onChange:e=>R(e.target.files[0]),id:"proof-upload",style:{display:"none"}}),(0,p.jsxs)("label",{htmlFor:"proof-upload",style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"8px 16px",background:"rgba(0, 198, 255, 0.1)",border:"1px solid rgba(0, 198, 255, 0.3)",borderRadius:"8px",color:"#00C6FF",fontSize:"14px",cursor:"pointer"},children:[(0,p.jsx)(d.xvb,{size:20}),S?S.name:"Upload Payment Proof"]})]})]})]})]})]})}),A&&(0,p.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"16px",padding:"32px",maxWidth:"480px",width:"90%"},children:[(0,p.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#FFFFFF",marginBottom:"16px"},children:e("p2p.dispute.title")}),(0,p.jsx)("p",{style:{color:"#8F9BB3",marginBottom:"16px"},children:e("p2p.dispute.description")}),(0,p.jsx)("textarea",{value:w,onChange:e=>C(e.target.value),placeholder:e("p2p.dispute.placeholder"),style:{width:"100%",height:"120px",padding:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#FFFFFF",fontSize:"14px",marginBottom:"16px",resize:"vertical"}}),(0,p.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,p.jsx)("button",{onClick:()=>z(!1),style:{flex:1,padding:"12px",background:"rgba(143, 155, 179, 0.1)",border:"1px solid rgba(143, 155, 179, 0.3)",borderRadius:"8px",color:"#8F9BB3",fontWeight:"600",cursor:"pointer"},children:e("common.cancel")}),(0,p.jsx)("button",{onClick:async()=>{if(w.trim()){k(!0);try{(await n.A.post("".concat(c,"/api/p2p/trade/dispute"),{trade_id:t,user_id:F.user_id,reason:w})).data.success&&(l.oR.success(e("p2p.disputeOpened")),z(!1),Y(F.user_id))}catch(s){var r,i;l.oR.error((null===(r=s.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.detail)||"Failed to open dispute")}finally{k(!1)}}else l.oR.error("Please provide a reason for dispute")},disabled:j||!w.trim(),style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #EF4444, #DC2626)",border:"none",borderRadius:"8px",color:"#FFFFFF",fontWeight:"700",cursor:j||!w.trim()?"not-allowed":"pointer"},children:e("p2p.dispute.submit")})]})]})}),W&&(0,p.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #0A1929 0%, #051018 100%)",border:"1px solid rgba(0, 198, 255, 0.3)",borderRadius:"16px",padding:"32px",maxWidth:"480px",width:"90%"},children:[(0,p.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#FFFFFF",marginBottom:"16px"},children:"Rate Your Counterparty"}),(0,p.jsxs)("p",{style:{color:"#8F9BB3",marginBottom:"20px"},children:["How was your experience with ",J,"?"]}),(0,p.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,p.jsx)("label",{style:{color:"#8F9BB3",fontSize:"14px",display:"block",marginBottom:"8px"},children:"Rating *"}),(0,p.jsx)("div",{style:{display:"flex",gap:"12px"},children:["positive","neutral","negative"].map(e=>(0,p.jsx)("button",{onClick:()=>T(e),style:{flex:1,padding:"12px",background:I===e?"positive"===e?"rgba(34, 197, 94, 0.2)":"neutral"===e?"rgba(255, 165, 0, 0.2)":"rgba(239, 68, 68, 0.2)":"rgba(143, 155, 179, 0.1)",border:I===e?"positive"===e?"2px solid #22C55E":"neutral"===e?"2px solid #FFA500":"2px solid #EF4444":"1px solid rgba(143, 155, 179, 0.3)",borderRadius:"8px",color:I===e?"positive"===e?"#22C55E":"neutral"===e?"#FFA500":"#EF4444":"#8F9BB3",fontWeight:I===e?"700":"400",cursor:"pointer",fontSize:"14px"},children:"positive"===e?"\ud83d\udc4d Positive":"neutral"===e?"\ud83d\ude10 Neutral":"\ud83d\udc4e Negative"},e))})]}),(0,p.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,p.jsx)("label",{style:{color:"#8F9BB3",fontSize:"14px",display:"block",marginBottom:"8px"},children:"Comment (Optional)"}),(0,p.jsx)("textarea",{value:P,onChange:e=>N(e.target.value),placeholder:"Share your experience... (max 500 characters)",maxLength:500,style:{width:"100%",height:"100px",padding:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(0, 198, 255, 0.3)",borderRadius:"8px",color:"#FFFFFF",fontSize:"14px",resize:"vertical"}}),(0,p.jsxs)("div",{style:{textAlign:"right",fontSize:"12px",color:"#8F9BB3",marginTop:"4px"},children:[P.length,"/500"]})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,p.jsx)("button",{onClick:()=>E(!1),style:{flex:1,padding:"12px",background:"rgba(143, 155, 179, 0.1)",border:"1px solid rgba(143, 155, 179, 0.3)",borderRadius:"8px",color:"#8F9BB3",fontWeight:"600",cursor:"pointer"},children:"Skip"}),(0,p.jsx)("button",{onClick:async()=>{if(P.trim()||""!==I){k(!0);try{(await n.A.post("".concat(c,"/api/p2p/trade/").concat(t,"/feedback"),{from_user_id:F.user_id,rating:I,comment:P.trim()})).data.success&&(l.oR.success("\u2705 Feedback submitted!"),E(!1),T("positive"),N(""))}catch(i){var e,r;l.oR.error((null===(e=i.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.detail)||"Failed to submit feedback")}finally{k(!1)}}else l.oR.error("Please provide a rating")},disabled:j,style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"8px",color:"#FFFFFF",fontWeight:"700",cursor:j?"not-allowed":"pointer",opacity:j?.6:1},children:j?"Submitting...":"Submit Feedback"})]})]})})]})}}]]);