{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{toast}from'sonner';import{Download,Filter,IoCheckmark as Check,IoCheckmarkCircle,IoClose as X,IoCloseCircle,IoCloudDownload,IoFilter,IoSearch,IoShield,IoWarning,Search}from'react-icons/io5';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API=process.env.REACT_APP_BACKEND_URL;// API already defined\nexport default function AdminSecurityLogs(){const[logs,setLogs]=useState([]);const[loading,setLoading]=useState(true);const[filters,setFilters]=useState({eventType:'all',success:'all',startDate:'',endDate:'',search:''});const[stats,setStats]=useState({totalAttempts:0,successfulLogins:0,failedLogins:0,newDevices:0});useEffect(()=>{loadSecurityLogs();},[filters]);const loadSecurityLogs=async()=>{try{setLoading(true);const response=await axios.get(\"\".concat(API,\"/api/admin/security-logs\"),{params:filters});if(response.data.success){setLogs(response.data.logs||[]);setStats(response.data.stats||{});}}catch(error){console.error('Failed to load security logs:',error);toast.error('Failed to load security logs');}finally{setLoading(false);}};const handleFilterChange=(key,value)=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[key]:value}));};const exportLogs=async()=>{try{const response=await axios.get(\"\".concat(API,\"/api/admin/security-logs/export\"),{params:filters,responseType:'blob'});const url=window.URL.createObjectURL(new Blob([response.data]));const link=document.createElement('a');link.href=url;link.setAttribute('download',\"security_logs_\".concat(new Date().toISOString(),\".csv\"));document.body.appendChild(link);link.click();link.remove();toast.success('Logs exported successfully');}catch(error){console.error('Failed to export logs:',error);toast.error('Failed to export logs');}};const getStatusIcon=success=>{return success?/*#__PURE__*/_jsx(IoCheckmarkCircle,{className:\"w-5 h-5 text-green-400\"}):/*#__PURE__*/_jsx(IoCloseCircle,{className:\"w-5 h-5 text-red-400\"});};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-2\",children:[/*#__PURE__*/_jsx(IoShield,{className:\"w-8 h-8 text-cyan-400\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-white\",children:\"Security Logs\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Monitor all login attempts and security events\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm mb-2\",children:\"Total Attempts\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl font-bold text-white\",children:stats.totalAttempts})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm mb-2\",children:\"Successful\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl font-bold text-green-400\",children:stats.successfulLogins})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm mb-2\",children:\"Failed\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl font-bold text-red-400\",children:stats.failedLogins})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm mb-2\",children:\"New Devices\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl font-bold text-yellow-400\",children:stats.newDevices})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-4\",children:[/*#__PURE__*/_jsx(IoFilter,{className:\"w-5 h-5 text-cyan-400\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-white\",children:\"Filters\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-5 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-400 mb-2\",children:\"Event Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.eventType,onChange:e=>handleFilterChange('eventType',e.target.value),className:\"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All Events\"}),/*#__PURE__*/_jsx(\"option\",{value:\"login\",children:\"Login\"}),/*#__PURE__*/_jsx(\"option\",{value:\"signup\",children:\"Signup\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-400 mb-2\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.success,onChange:e=>handleFilterChange('success',e.target.value),className:\"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All\"}),/*#__PURE__*/_jsx(\"option\",{value:\"success\",children:\"Success\"}),/*#__PURE__*/_jsx(\"option\",{value:\"failed\",children:\"Failed\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-400 mb-2\",children:\"Start Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:filters.startDate,onChange:e=>handleFilterChange('startDate',e.target.value),className:\"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-400 mb-2\",children:\"End Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:filters.endDate,onChange:e=>handleFilterChange('endDate',e.target.value),className:\"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-400 mb-2\",children:\"Search\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(IoSearch,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:filters.search,onChange:e=>handleFilterChange('search',e.target.value),placeholder:\"Email or IP\",className:\"w-full bg-slate-700 border border-slate-600 rounded-lg pl-10 pr-4 py-2 text-white\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 flex gap-3\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:exportLogs,className:\"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-lg text-white transition-colors\",children:[/*#__PURE__*/_jsx(IoCloudDownload,{className:\"w-4 h-4\"}),\"Export CSV\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-slate-900/50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider\",children:\"Event\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider\",children:\"User\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider\",children:\"IP Address\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider\",children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider\",children:\"Device\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider\",children:\"Timestamp\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-slate-700\",children:loading?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",className:\"px-6 py-12 text-center text-gray-400\",children:\"Loading...\"})}):logs.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",className:\"px-6 py-12 text-center text-gray-400\",children:\"No logs found\"})}):logs.map((log,index)=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-slate-700/30 transition-colors\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[getStatusIcon(log.success),log.is_new_device&&/*#__PURE__*/_jsx(IoWarning,{className:\"w-4 h-4 text-yellow-400\",title:\"New Device\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-xs font-medium bg-cyan-900/50 text-cyan-300\",children:log.event_type})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-white font-medium\",children:log.email}),log.failure_reason&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-red-400 mt-1\",children:log.failure_reason})]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-gray-300 font-mono text-sm\",children:log.ip_address}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 text-gray-300\",children:[log.city,\", \",log.country]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-white text-sm\",children:[log.browser,\" on \",log.os]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-400\",children:log.device_type})]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-gray-300 text-sm\",children:new Date(log.timestamp).toLocaleString()})]},index))})]})})})]})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}