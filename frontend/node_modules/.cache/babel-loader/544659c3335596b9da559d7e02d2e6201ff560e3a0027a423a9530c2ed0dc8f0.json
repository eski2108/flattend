{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import ReactDOM from'react-dom';import{useNavigate}from'react-router-dom';import{Card}from'@/components/ui/card';import{IoCard as CreditCard,IoGlobe as Globe,IoLockClosed as Lock,IoLogOut,IoMail,IoNotifications as Bell,IoPersonOutline as User,IoPhonePortrait as Smartphone,IoShield as Shield,IoTrendingUp,IoCheckmarkCircle}from'react-icons/io5';import{toast}from'sonner';import CurrencySelector from'@/components/CurrencySelector';import PriceAlerts from'@/components/PriceAlerts';import MobileBottomNav from'@/components/MobileBottomNav';// Settings Components\nimport ProfileSettings from'@/components/settings/ProfileSettings';import EmailSettings from'@/components/settings/EmailSettings';import SecuritySettings from'@/components/settings/SecuritySettings';import TwoFactorSettings from'@/components/settings/TwoFactorSettings';import NotificationSettings from'@/components/settings/NotificationSettings';import TelegramSettings from'@/components/settings/TelegramSettings';import LanguageSettings from'@/components/settings/LanguageSettings';import PaymentMethodsManager from'@/components/settings/PaymentMethodsManager';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL;export default function Settings(){const navigate=useNavigate();const[currentUser,setCurrentUser]=useState(null);const[loginEmailAlerts,setLoginEmailAlerts]=useState(true);const[loadingSettings,setLoadingSettings]=useState(false);const[activeModal,setActiveModal]=useState(null);// Prevent body scroll when modal is open\nuseEffect(()=>{if(activeModal){document.body.style.overflow='hidden';}else{document.body.style.overflow='unset';}return()=>{document.body.style.overflow='unset';};},[activeModal]);useEffect(()=>{const userData=localStorage.getItem('cryptobank_user');if(!userData){navigate('/');return;}const user=JSON.parse(userData);setCurrentUser(user);fetchSecuritySettings();},[navigate]);const handleVerifySeller=async()=>{try{const token=localStorage.getItem('token');const response=await fetch(\"\".concat(BACKEND_URL,\"/api/monetization/verify-seller\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({user_id:currentUser===null||currentUser===void 0?void 0:currentUser.user_id})});const data=await response.json();if(data.success){toast.success(data.message);window.location.reload();}else{toast.error(data.detail||'Failed to verify seller');}}catch(error){toast.error(error.message||'Failed to verify seller');}};const fetchSecuritySettings=async()=>{try{const token=localStorage.getItem('token');if(!token)return;const response=await fetch(\"\".concat(BACKEND_URL,\"/api/user/security/settings\"),{headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'}});if(response.ok){const data=await response.json();setLoginEmailAlerts(data.settings.login_email_alerts_enabled);}}catch(error){console.error('Failed to fetch security settings:',error);}};const updateSecuritySettings=async login_email_alerts_enabled=>{try{setLoadingSettings(true);const token=localStorage.getItem('token');if(!token)return;const response=await fetch(\"\".concat(BACKEND_URL,\"/api/user/security/settings\"),{method:'PUT',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({login_email_alerts_enabled})});if(response.ok){setLoginEmailAlerts(login_email_alerts_enabled);toast.success('Security settings updated successfully');}else{toast.error('Failed to update security settings');}}catch(error){console.error('Failed to update security settings:',error);toast.error('Failed to update security settings');}finally{setLoadingSettings(false);}};const handleLogout=()=>{localStorage.removeItem('cryptobank_user');localStorage.removeItem('user');localStorage.removeItem('token');toast.success('Logged out successfully');navigate('/');};if(!currentUser){return/*#__PURE__*/_jsx(\"div\",{style:{minHeight:'100vh',background:'linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%)',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\",style:{border:'4px solid rgba(0, 240, 255, 0.1)',borderTop:'4px solid #00F0FF',borderRadius:'50%',width:'50px',height:'50px',animation:'spin 1s linear infinite'}})});}const settingSections=[{title:'Account',items:[{icon:User,label:'Profile',description:'Manage your personal information',action:()=>setActiveModal('profile'),dataTestId:'btn-profile-settings'},{icon:Lock,label:'Security',description:'Password and security settings',action:()=>setActiveModal('security'),dataTestId:'btn-security-settings'},{icon:Shield,label:'Two-Factor Authentication',description:'2FA for enhanced security',action:()=>setActiveModal('2fa'),dataTestId:'btn-2fa-settings'}]},{title:'Preferences',items:[{icon:Bell,label:'Notifications',description:'Manage notification preferences',action:()=>setActiveModal('notifications'),dataTestId:'btn-notification-settings'},{icon:Smartphone,label:'Telegram',description:'Connect Telegram for instant alerts',action:()=>setActiveModal('telegram'),dataTestId:'btn-telegram-settings'},{icon:Globe,label:'Language',description:currentUser.language?\"\".concat(currentUser.language.toUpperCase()):'English',action:()=>setActiveModal('language'),dataTestId:'btn-language-settings'}]},{title:'Payment',items:[{icon:CreditCard,label:'Payment Methods',description:'Manage P2P payment methods',action:()=>setActiveModal('payment'),dataTestId:'btn-payment-methods'}]},{title:'P2P Trading',items:[{icon:IoTrendingUp,label:'Become a Seller',description:'Start selling on P2P marketplace',action:handleVerifySeller,highlight:true,dataTestId:'btn-become-seller'}]}];return/*#__PURE__*/_jsxs(\"div\",{style:{minHeight:'100vh',background:'linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%)',padding:'3rem 2rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:'1100px',margin:'0 auto'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'3rem',display:'flex',alignItems:'center',gap:'2rem',paddingBottom:'2rem',borderBottom:'1px solid rgba(0, 240, 255, 0.1)'},children:[/*#__PURE__*/_jsx(\"img\",{src:\"/logo1-transparent.png\",alt:\"CoinHubX\",style:{width:'60px',height:'60px',objectFit:'contain'}}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:'32px',fontWeight:'700',color:'#fff',marginBottom:'0.5rem',letterSpacing:'-0.5px'},children:\"Settings\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#888',fontSize:'15px',marginBottom:0},children:\"Manage your account settings and preferences\"})]})]}),/*#__PURE__*/_jsx(Card,{style:{background:'linear-gradient(135deg, rgba(0, 240, 255, 0.05) 0%, rgba(168, 85, 247, 0.05) 100%)',border:'1px solid rgba(0, 240, 255, 0.2)',borderRadius:'16px',padding:'2.5rem',marginBottom:'3rem'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'flex-start',gap:'2rem',flexDirection:'column'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'80px',height:'80px',borderRadius:'50%',background:'linear-gradient(135deg, #00F0FF, #A855F7)',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden',border:'3px solid rgba(0, 240, 255, 0.3)',margin:'0 auto'},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'32px',fontWeight:'700',color:'#000'},children:(currentUser.full_name||currentUser.name||'U').charAt(0).toUpperCase()})}),/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2rem'},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#00F0FF',fontSize:'11px',marginBottom:'0.75rem',display:'block',textTransform:'uppercase',letterSpacing:'1px',fontWeight:'600'},children:\"Full Name\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'0.75rem',alignItems:'stretch',flexDirection:'column'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:currentUser.full_name||currentUser.name||'',onChange:e=>{const newName=e.target.value;setCurrentUser(_objectSpread(_objectSpread({},currentUser),{},{full_name:newName}));},disabled:loadingSettings,\"data-testid\":\"input-full-name\",style:{flex:1,padding:'1rem 1.25rem',background:'rgba(0, 0, 0, 0.4)',border:'1px solid rgba(0, 240, 255, 0.3)',borderRadius:'10px',color:'#fff',fontSize:'17px',fontWeight:'600',outline:'none',transition:'all 0.2s ease',boxSizing:'border-box'},onFocus:e=>{e.target.style.borderColor='rgba(0, 240, 255, 0.6)';e.target.style.background='rgba(0, 0, 0, 0.5)';},onBlur:e=>{e.target.style.borderColor='rgba(0, 240, 255, 0.3)';e.target.style.background='rgba(0, 0, 0, 0.4)';}}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{const newName=(currentUser.full_name||currentUser.name||'').trim();if(!newName){toast.error('Please enter a name');return;}setLoadingSettings(true);try{const response=await fetch(\"\".concat(BACKEND_URL,\"/api/user/profile\"),{method:'PUT',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify({user_id:currentUser.user_id,full_name:newName})});const data=await response.json();if(data.success){toast.success('âœ“ Name saved successfully');const updatedUser=_objectSpread(_objectSpread({},currentUser),{},{full_name:newName});setCurrentUser(updatedUser);localStorage.setItem('cryptobank_user',JSON.stringify(updatedUser));}else{toast.error('Failed to save name');}}catch(error){toast.error('Failed to save name');}finally{setLoadingSettings(false);}},disabled:loadingSettings,\"data-testid\":\"btn-save-name\",style:{width:'100%',padding:'1rem',background:loadingSettings?'#666':'linear-gradient(135deg, #00F0FF, #0099CC)',border:'none',borderRadius:'10px',color:'#000',fontSize:'15px',fontWeight:'700',cursor:loadingSettings?'not-allowed':'pointer',transition:'all 0.2s ease'},onMouseEnter:e=>{if(!loadingSettings){e.currentTarget.style.transform='translateY(-2px)';e.currentTarget.style.boxShadow='0 4px 12px rgba(0, 240, 255, 0.3)';}},onMouseLeave:e=>{e.currentTarget.style.transform='translateY(0)';e.currentTarget.style.boxShadow='none';},children:loadingSettings?'Saving...':'Save'})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#888',fontSize:'11px',marginBottom:'0.75rem',display:'block',textTransform:'uppercase',letterSpacing:'1px',fontWeight:'600'},children:\"Email Address\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem',padding:'1rem 1.25rem',background:'rgba(0, 0, 0, 0.3)',border:'1px solid rgba(100, 100, 100, 0.3)',borderRadius:'10px'},children:[/*#__PURE__*/_jsx(Lock,{size:18,color:\"#666\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:'#aaa',fontSize:'17px',fontWeight:'500',flex:1},children:currentUser.email}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'10px',color:'#666',textTransform:'uppercase',letterSpacing:'0.5px',padding:'4px 8px',background:'rgba(100, 100, 100, 0.2)',borderRadius:'4px'},children:\"Locked\"})]}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'12px',color:'#666',marginTop:'0.75rem',marginBottom:0,lineHeight:'1.5'},children:\"Email cannot be changed for security reasons. Contact support if you need to update your email address.\"})]})]})]})}),settingSections.map((section,sectionIdx)=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2.5rem'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'#fff',fontSize:'14px',fontWeight:'600',marginBottom:'1rem',paddingLeft:'4px',textTransform:'uppercase',letterSpacing:'1px'},children:section.title}),/*#__PURE__*/_jsx(Card,{style:{background:'rgba(26, 31, 58, 0.5)',border:'1px solid rgba(0, 240, 255, 0.15)',borderRadius:'12px',overflow:'hidden'},children:section.items.map((item,idx)=>{const Icon=item.icon;return/*#__PURE__*/_jsxs(\"button\",{onClick:item.action,\"data-testid\":item.dataTestId,style:{width:'100%',padding:'1.5rem 1.75rem',borderBottom:idx<section.items.length-1?'1px solid rgba(255, 255, 255, 0.05)':'none',cursor:'pointer',transition:'all 0.2s ease',display:'flex',alignItems:'center',gap:'1.25rem',background:item.highlight?'rgba(0, 240, 255, 0.05)':'transparent',border:'none',textAlign:'left'},onMouseEnter:e=>{e.currentTarget.style.background='rgba(0, 240, 255, 0.08)';e.currentTarget.style.transform='translateX(4px)';},onMouseLeave:e=>{e.currentTarget.style.background=item.highlight?'rgba(0, 240, 255, 0.05)':'transparent';e.currentTarget.style.transform='translateX(0)';},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'48px',height:'48px',borderRadius:'12px',background:'rgba(0, 240, 255, 0.1)',border:'1px solid rgba(0, 240, 255, 0.2)',display:'flex',alignItems:'center',justifyContent:'center',flexShrink:0},children:/*#__PURE__*/_jsx(Icon,{size:22,color:\"#00F0FF\"})}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{color:'#fff',fontSize:'16px',fontWeight:'600',marginBottom:'4px'},children:item.label}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:'13px',lineHeight:'1.4'},children:item.description})]}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#00F0FF',fontSize:'20px',opacity:0.6},children:\"\\u2192\"})]},idx);})})]},sectionIdx)),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2.5rem'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'#fff',fontSize:'14px',fontWeight:'600',marginBottom:'1rem',paddingLeft:'4px',textTransform:'uppercase',letterSpacing:'1px'},children:\"Display Currency\"}),/*#__PURE__*/_jsx(CurrencySelector,{})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2.5rem'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'#fff',fontSize:'14px',fontWeight:'600',marginBottom:'1rem',paddingLeft:'4px',textTransform:'uppercase',letterSpacing:'1px'},children:\"Price Alerts\"}),/*#__PURE__*/_jsx(PriceAlerts,{})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2.5rem'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'#fff',fontSize:'14px',fontWeight:'600',marginBottom:'1rem',paddingLeft:'4px',textTransform:'uppercase',letterSpacing:'1px'},children:\"Login Notifications\"}),/*#__PURE__*/_jsx(Card,{style:{background:'rgba(26, 31, 58, 0.5)',border:'1px solid rgba(0, 240, 255, 0.15)',borderRadius:'12px',padding:'1.5rem 1.75rem'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',gap:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,display:'flex',alignItems:'center',gap:'1rem'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'48px',height:'48px',borderRadius:'12px',background:'rgba(0, 240, 255, 0.1)',border:'1px solid rgba(0, 240, 255, 0.2)',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsx(IoMail,{size:22,color:\"#00F0FF\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{color:'#fff',fontSize:'16px',fontWeight:'600',marginBottom:'4px'},children:\"Email Login Alerts\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:'13px'},children:\"Get notified when someone logs into your account\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateSecuritySettings(!loginEmailAlerts),disabled:loadingSettings,\"data-testid\":\"toggle-login-alerts\",style:{position:'relative',width:'52px',height:'28px',borderRadius:'14px',border:'none',cursor:loadingSettings?'not-allowed':'pointer',background:loginEmailAlerts?'#00F0FF':'#333',transition:'background 0.3s ease',flexShrink:0},children:/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'3px',left:loginEmailAlerts?'27px':'3px',width:'22px',height:'22px',borderRadius:'50%',background:'#fff',transition:'left 0.3s ease',display:'flex',alignItems:'center',justifyContent:'center'},children:loginEmailAlerts&&/*#__PURE__*/_jsx(IoCheckmarkCircle,{size:14,color:\"#00F0FF\"})})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2.5rem'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'#fff',fontSize:'14px',fontWeight:'600',marginBottom:'1rem',paddingLeft:'4px',textTransform:'uppercase',letterSpacing:'1px'},children:\"Mobile App\"}),/*#__PURE__*/_jsxs(Card,{style:{background:'rgba(26, 31, 58, 0.5)',border:'1px solid rgba(100, 100, 100, 0.3)',borderRadius:'12px',padding:'2.5rem',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'80px',height:'80px',borderRadius:'50%',background:'rgba(100, 100, 100, 0.2)',display:'flex',alignItems:'center',justifyContent:'center',margin:'0 auto 1.5rem'},children:/*#__PURE__*/_jsx(Smartphone,{size:40,color:\"#666\"})}),/*#__PURE__*/_jsx(\"h4\",{style:{color:'#aaa',fontSize:'18px',fontWeight:'600',marginBottom:'0.75rem'},children:\"Mobile App Coming Soon\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',fontSize:'14px',marginBottom:0,maxWidth:'400px',margin:'0 auto',lineHeight:'1.6'},children:\"iOS and Android apps are currently in development. You'll be notified when they're available.\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleLogout,\"data-testid\":\"btn-logout\",style:{width:'100%',padding:'1rem',background:'linear-gradient(135deg, #EF4444, #DC2626)',border:'none',borderRadius:'12px',fontSize:'16px',fontWeight:'700',color:'#fff',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',gap:'12px',transition:'all 0.2s ease'},onMouseEnter:e=>{e.currentTarget.style.transform='translateY(-2px)';e.currentTarget.style.opacity='0.9';},onMouseLeave:e=>{e.currentTarget.style.transform='translateY(0)';e.currentTarget.style.opacity='1';},children:[/*#__PURE__*/_jsx(IoLogOut,{size:20}),\"Log Out\"]}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',marginTop:'2rem',color:'#555',fontSize:'12px'},children:\"CoinHubX v2.0.0 \\u2022 Premium Exchange Platform\"})]}),activeModal==='profile'&&/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(ProfileSettings,{user:currentUser,onClose:()=>{setActiveModal(null);},onUpdate:updatedUser=>setCurrentUser(updatedUser)}),document.body),activeModal==='email'&&/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(EmailSettings,{user:currentUser,onClose:()=>setActiveModal(null)}),document.body),activeModal==='security'&&/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(SecuritySettings,{user:currentUser,onClose:()=>setActiveModal(null)}),document.body),activeModal==='2fa'&&/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(TwoFactorSettings,{user:currentUser,onClose:()=>setActiveModal(null),onUpdate:updatedUser=>setCurrentUser(updatedUser)}),document.body),activeModal==='notifications'&&/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(NotificationSettings,{user:currentUser,onClose:()=>setActiveModal(null)}),document.body),activeModal==='telegram'&&/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(TelegramSettings,{user:currentUser,onClose:()=>setActiveModal(null)}),document.body),activeModal==='language'&&/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(LanguageSettings,{user:currentUser,onClose:()=>setActiveModal(null)}),document.body),activeModal==='payment'&&/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(PaymentMethodsManager,{user:currentUser,onClose:()=>setActiveModal(null)}),document.body),/*#__PURE__*/_jsx(MobileBottomNav,{})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}