{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{IoClose,IoLockClosed,IoCheckmarkCircle,IoEye,IoEyeOff}from'react-icons/io5';import{toast}from'sonner';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API=process.env.REACT_APP_BACKEND_URL;const SecuritySettings=_ref=>{let{user,onClose}=_ref;const[loading,setLoading]=useState(false);const[formData,setFormData]=useState({currentPassword:'',newPassword:'',confirmPassword:''});const[showPasswords,setShowPasswords]=useState({current:false,new:false,confirm:false});const[errors,setErrors]=useState({});const validateForm=()=>{const newErrors={};if(!formData.currentPassword){newErrors.currentPassword='Current password is required';}if(!formData.newPassword){newErrors.newPassword='New password is required';}else if(formData.newPassword.length<8){newErrors.newPassword='Password must be at least 8 characters';}else if(!/(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/.test(formData.newPassword)){newErrors.newPassword='Password must contain uppercase, lowercase, and numbers';}if(!formData.confirmPassword){newErrors.confirmPassword='Please confirm your new password';}else if(formData.newPassword!==formData.confirmPassword){newErrors.confirmPassword='Passwords do not match';}if(formData.newPassword===formData.currentPassword){newErrors.newPassword='New password must be different from current password';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){toast.error('Please fix the errors before submitting');return;}setLoading(true);try{const token=localStorage.getItem('token');const response=await axios.post(\"\".concat(API,\"/api/user/security/change-password\"),{user_id:user.user_id,current_password:formData.currentPassword,new_password:formData.newPassword},{headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'}});if(response.data.success){toast.success('âœ… Password changed successfully!');setTimeout(()=>onClose(),1000);}}catch(error){var _error$response,_error$response$data;console.error('Password change error:',error);const errorMsg=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Failed to change password';if(errorMsg.includes('current password')||errorMsg.includes('incorrect')){setErrors(_objectSpread(_objectSpread({},errors),{},{currentPassword:'Incorrect current password'}));}toast.error(errorMsg);}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.7)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:99999999,padding:'20px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'#1a1f3a',border:'2px solid rgba(0, 240, 255, 0.3)',borderRadius:'20px',maxWidth:'500px',width:'100%',boxShadow:'0 0 40px rgba(0, 240, 255, 0.3)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:'24px',borderBottom:'1px solid rgba(0, 240, 255, 0.2)',display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{fontSize:'24px',fontWeight:'800',color:'#FFFFFF',margin:0,display:'flex',alignItems:'center',gap:'10px'},children:[/*#__PURE__*/_jsx(IoLockClosed,{size:28,color:\"#00F0FF\"}),\"Change Password\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'none',border:'none',color:'#666',cursor:'pointer',padding:'8px'},children:/*#__PURE__*/_jsx(IoClose,{size:28})})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:{padding:'24px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:'8px',color:'#FFFFFF',fontSize:'13px',fontWeight:'700',marginBottom:'8px',textTransform:'uppercase'},children:[/*#__PURE__*/_jsx(IoLockClosed,{size:16,color:\"#00F0FF\"}),\"Current Password *\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"input\",{type:showPasswords.current?'text':'password',value:formData.currentPassword,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{currentPassword:e.target.value})),style:{width:'100%',padding:'14px 48px 14px 16px',background:'rgba(0, 0, 0, 0.4)',border:\"1px solid \".concat(errors.currentPassword?'#FF4444':'rgba(0, 240, 255, 0.4)'),borderRadius:'12px',color:'#FFFFFF',fontSize:'15px',outline:'none',boxSizing:'border-box'}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPasswords(_objectSpread(_objectSpread({},showPasswords),{},{current:!showPasswords.current})),style:{position:'absolute',right:'14px',top:'50%',transform:'translateY(-50%)',background:'none',border:'none',color:'#00F0FF',cursor:'pointer',padding:'4px'},children:showPasswords.current?/*#__PURE__*/_jsx(IoEyeOff,{size:20}):/*#__PURE__*/_jsx(IoEye,{size:20})})]}),errors.currentPassword&&/*#__PURE__*/_jsx(\"p\",{style:{color:'#FF4444',fontSize:'12px',marginTop:'4px'},children:errors.currentPassword})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:'8px',color:'#FFFFFF',fontSize:'13px',fontWeight:'700',marginBottom:'8px',textTransform:'uppercase'},children:[/*#__PURE__*/_jsx(IoLockClosed,{size:16,color:\"#00F0FF\"}),\"New Password *\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"input\",{type:showPasswords.new?'text':'password',value:formData.newPassword,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{newPassword:e.target.value})),placeholder:\"Minimum 8 characters, mixed case & numbers\",style:{width:'100%',padding:'14px 48px 14px 16px',background:'rgba(0, 0, 0, 0.4)',border:\"1px solid \".concat(errors.newPassword?'#FF4444':'rgba(0, 240, 255, 0.4)'),borderRadius:'12px',color:'#FFFFFF',fontSize:'15px',outline:'none',boxSizing:'border-box'}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPasswords(_objectSpread(_objectSpread({},showPasswords),{},{new:!showPasswords.new})),style:{position:'absolute',right:'14px',top:'50%',transform:'translateY(-50%)',background:'none',border:'none',color:'#00F0FF',cursor:'pointer',padding:'4px'},children:showPasswords.new?/*#__PURE__*/_jsx(IoEyeOff,{size:20}):/*#__PURE__*/_jsx(IoEye,{size:20})})]}),errors.newPassword&&/*#__PURE__*/_jsx(\"p\",{style:{color:'#FF4444',fontSize:'12px',marginTop:'4px'},children:errors.newPassword})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'24px'},children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:'8px',color:'#FFFFFF',fontSize:'13px',fontWeight:'700',marginBottom:'8px',textTransform:'uppercase'},children:[/*#__PURE__*/_jsx(IoCheckmarkCircle,{size:16,color:\"#00F0FF\"}),\"Confirm New Password *\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"input\",{type:showPasswords.confirm?'text':'password',value:formData.confirmPassword,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{confirmPassword:e.target.value})),style:{width:'100%',padding:'14px 48px 14px 16px',background:'rgba(0, 0, 0, 0.4)',border:\"1px solid \".concat(errors.confirmPassword?'#FF4444':'rgba(0, 240, 255, 0.4)'),borderRadius:'12px',color:'#FFFFFF',fontSize:'15px',outline:'none',boxSizing:'border-box'}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPasswords(_objectSpread(_objectSpread({},showPasswords),{},{confirm:!showPasswords.confirm})),style:{position:'absolute',right:'14px',top:'50%',transform:'translateY(-50%)',background:'none',border:'none',color:'#00F0FF',cursor:'pointer',padding:'4px'},children:showPasswords.confirm?/*#__PURE__*/_jsx(IoEyeOff,{size:20}):/*#__PURE__*/_jsx(IoEye,{size:20})})]}),errors.confirmPassword&&/*#__PURE__*/_jsx(\"p\",{style:{color:'#FF4444',fontSize:'12px',marginTop:'4px'},children:errors.confirmPassword})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,disabled:loading,style:{flex:1,padding:'14px',background:'rgba(255, 255, 255, 0.1)',border:'1px solid rgba(255, 255, 255, 0.2)',borderRadius:'12px',color:'#FFFFFF',fontSize:'15px',fontWeight:'700',cursor:loading?'not-allowed':'pointer'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{flex:1,padding:'14px',background:loading?'rgba(0, 240, 255, 0.3)':'linear-gradient(135deg, #00F0FF 0%, #9B4DFF 100%)',border:'none',borderRadius:'12px',color:'#FFFFFF',fontSize:'15px',fontWeight:'700',cursor:loading?'not-allowed':'pointer',boxShadow:loading?'none':'0 4px 20px rgba(0, 240, 255, 0.4)'},children:loading?'Changing...':'Change Password'})]})]})]})});};export default SecuritySettings;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}