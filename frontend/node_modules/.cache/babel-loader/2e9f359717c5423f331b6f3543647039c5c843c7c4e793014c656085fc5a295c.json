{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{Button}from'@/components/ui/button';import{Card}from'@/components/ui/card';import{IoCash,IoCheckmark,IoCopy,IoPeople,IoTrendingUp}from'react-icons/io5';import axios from'axios';import Layout from'@/components/Layout';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL;const API=BACKEND_URL;export default function EnhancedReferralDashboard(){var _dashboard$overall_st,_dashboard$overall_st2,_dashboard$private_co,_dashboard$public_cod;const navigate=useNavigate();const[user,setUser]=useState(null);const[dashboard,setDashboard]=useState(null);const[loading,setLoading]=useState(true);const[copiedCode,setCopiedCode]=useState(null);const[creatingPrivate,setCreatingPrivate]=useState(false);const[creatingPublic,setCreatingPublic]=useState(false);useEffect(()=>{const userData=localStorage.getItem('cryptobank_user');if(!userData){navigate('/');return;}setUser(JSON.parse(userData));},[navigate]);useEffect(()=>{if(user!==null&&user!==void 0&&user.user_id){fetchDashboard();}},[user]);const fetchDashboard=async()=>{try{const response=await axios.get(\"\".concat(API,\"/api/referral/enhanced-dashboard/\").concat(user.user_id));setDashboard(response.data);}catch(error){console.error('Error fetching dashboard:',error);}finally{setLoading(false);}};const createPrivateCode=async()=>{setCreatingPrivate(true);try{await axios.post(\"\".concat(API,\"/api/referral/create-private-code?user_id=\").concat(user.user_id));await fetchDashboard();}catch(error){alert('Failed to create private code');}finally{setCreatingPrivate(false);}};const createPublicCode=async()=>{setCreatingPublic(true);try{await axios.post(\"\".concat(API,\"/api/referral/create-public-code?user_id=\").concat(user.user_id));await fetchDashboard();}catch(error){alert('Failed to create public code');}finally{setCreatingPublic(false);}};const copyToClipboard=(text,type)=>{navigator.clipboard.writeText(text);setCopiedCode(type);setTimeout(()=>setCopiedCode(null),2000);};if(loading){return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(\"div\",{style:{padding:'2rem',textAlign:'center',color:'#fff'},children:\"Loading referral dashboard...\"})});}return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'2rem',maxWidth:'1400px',margin:'0 auto'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:'32px',fontWeight:'800',color:'#fff',marginBottom:'0.5rem'},children:\"Referral Dashboard\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'rgba(255, 255, 255, 0.7)',marginBottom:'2rem'},children:\"Earn commissions by referring users to CoinHubX\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(250px, 1fr))',gap:'1.5rem',marginBottom:'2rem'},children:[/*#__PURE__*/_jsxs(Card,{style:{background:'linear-gradient(135deg, rgba(0, 240, 255, 0.1), rgba(168, 85, 247, 0.1))',border:'2px solid rgba(0, 240, 255, 0.3)',borderRadius:'16px',padding:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem',marginBottom:'0.5rem'},children:[/*#__PURE__*/_jsx(IoPeople,{size:28,color:\"#00F0FF\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px',color:'rgba(255, 255, 255, 0.7)'},children:\"Total Referrals\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'36px',fontWeight:'900',color:'#fff'},children:(dashboard===null||dashboard===void 0?void 0:(_dashboard$overall_st=dashboard.overall_stats)===null||_dashboard$overall_st===void 0?void 0:_dashboard$overall_st.total_referrals)||0})]}),/*#__PURE__*/_jsxs(Card,{style:{background:'linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(168, 85, 247, 0.1))',border:'2px solid rgba(34, 197, 94, 0.3)',borderRadius:'16px',padding:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem',marginBottom:'0.5rem'},children:[/*#__PURE__*/_jsx(IoTrendingUp,{size:28,color:\"#22C55E\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px',color:'rgba(255, 255, 255, 0.7)'},children:\"Lifetime Commission\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'36px',fontWeight:'900',color:'#22C55E'},children:[\"\\xA3\",((dashboard===null||dashboard===void 0?void 0:(_dashboard$overall_st2=dashboard.overall_stats)===null||_dashboard$overall_st2===void 0?void 0:_dashboard$overall_st2.total_commission_earned_gbp)||0).toFixed(2)]})]})]}),/*#__PURE__*/_jsxs(Card,{style:{background:'linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(168, 85, 247, 0.1))',border:'2px solid rgba(255, 193, 7, 0.3)',borderRadius:'16px',padding:'2rem',marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem',marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsx(Gift,{size:32,color:\"#FFC107\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{fontSize:'24px',fontWeight:'700',color:'#fff',marginBottom:'0.25rem'},children:\"Private Referral Link (\\xA310 Bonus)\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',color:'rgba(255, 255, 255, 0.7)'},children:\"Earn \\xA310 when referred user deposits \\xA3150+ | Plus 20% lifetime commission\"})]})]}),dashboard!==null&&dashboard!==void 0&&(_dashboard$private_co=dashboard.private_code)!==null&&_dashboard$private_co!==void 0&&_dashboard$private_co.code?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{background:'rgba(0, 0, 0, 0.4)',borderRadius:'12px',padding:'1rem',marginBottom:'1.5rem'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'rgba(255, 255, 255, 0.5)',marginBottom:'0.5rem'},children:\"YOUR PRIVATE CODE\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'20px',fontWeight:'700',color:'#FFC107',fontFamily:'monospace'},children:dashboard.private_code.code})]}),/*#__PURE__*/_jsxs(Button,{onClick:()=>copyToClipboard(dashboard.private_code.link,'private'),style:{background:'linear-gradient(135deg, #FFC107, #FF9800)',border:'none'},children:[copiedCode==='private'?/*#__PURE__*/_jsx(IoCheckmark,{size:18}):/*#__PURE__*/_jsx(IoCopy,{size:18}),copiedCode==='private'?' Copied!':' Copy Link']})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(150px, 1fr))',gap:'1rem'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'rgba(255, 255, 255, 0.5)',marginBottom:'0.25rem'},children:\"Total Sign-ups\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'24px',fontWeight:'700',color:'#fff'},children:dashboard.private_code.total_signups})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'rgba(255, 255, 255, 0.5)',marginBottom:'0.25rem'},children:\"Deposited \\xA3150+\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'24px',fontWeight:'700',color:'#22C55E'},children:dashboard.private_code.users_deposited_150})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'rgba(255, 255, 255, 0.5)',marginBottom:'0.25rem'},children:\"Total Bonuses\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'24px',fontWeight:'700',color:'#FFC107'},children:[\"\\xA3\",(dashboard.private_code.total_bonus_earned_gbp||0).toFixed(0)]})]})]})]}):/*#__PURE__*/_jsx(Button,{onClick:createPrivateCode,disabled:creatingPrivate,style:{width:'100%',background:'linear-gradient(135deg, #FFC107, #FF9800)',border:'none',padding:'1rem',fontSize:'16px',fontWeight:'700'},children:creatingPrivate?'Creating...':'Create Private Referral Link'})]}),/*#__PURE__*/_jsxs(Card,{style:{background:'linear-gradient(135deg, rgba(0, 240, 255, 0.1), rgba(168, 85, 247, 0.1))',border:'2px solid rgba(0, 240, 255, 0.3)',borderRadius:'16px',padding:'2rem',marginBottom:'2rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem',marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsx(IoCash,{size:32,color:\"#00F0FF\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{fontSize:'24px',fontWeight:'700',color:'#fff',marginBottom:'0.25rem'},children:\"Public Referral Link\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',color:'rgba(255, 255, 255, 0.7)'},children:\"20% lifetime commission on all trading fees (no bonus)\"})]})]}),dashboard!==null&&dashboard!==void 0&&(_dashboard$public_cod=dashboard.public_code)!==null&&_dashboard$public_cod!==void 0&&_dashboard$public_cod.code?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{background:'rgba(0, 0, 0, 0.4)',borderRadius:'12px',padding:'1rem',marginBottom:'1.5rem'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'rgba(255, 255, 255, 0.5)',marginBottom:'0.5rem'},children:\"YOUR PUBLIC CODE\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'20px',fontWeight:'700',color:'#00F0FF',fontFamily:'monospace'},children:dashboard.public_code.code})]}),/*#__PURE__*/_jsxs(Button,{onClick:()=>copyToClipboard(dashboard.public_code.link,'public'),style:{background:'linear-gradient(135deg, #00F0FF, #A855F7)',border:'none'},children:[copiedCode==='public'?/*#__PURE__*/_jsx(IoCheckmark,{size:18}):/*#__PURE__*/_jsx(IoCopy,{size:18}),copiedCode==='public'?' Copied!':' Copy Link']})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'rgba(255, 255, 255, 0.5)',marginBottom:'0.25rem'},children:\"Total Sign-ups\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'24px',fontWeight:'700',color:'#fff'},children:dashboard.public_code.total_signups})]})]}):/*#__PURE__*/_jsx(Button,{onClick:createPublicCode,disabled:creatingPublic,style:{width:'100%',background:'linear-gradient(135deg, #00F0FF, #A855F7)',border:'none',padding:'1rem',fontSize:'16px',fontWeight:'700'},children:creatingPublic?'Creating...':'Create Public Referral Link'})]}),(dashboard===null||dashboard===void 0?void 0:dashboard.referral_list)&&dashboard.referral_list.length>0&&/*#__PURE__*/_jsxs(Card,{style:{background:'rgba(0, 0, 0, 0.3)',border:'1px solid rgba(0, 240, 255, 0.2)',borderRadius:'16px',padding:'2rem'},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{fontSize:'20px',fontWeight:'700',color:'#fff',marginBottom:'1.5rem'},children:[\"Your Referrals (\",dashboard.referral_list.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'1rem'},children:dashboard.referral_list.map((ref,idx)=>/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',padding:'1rem',background:'rgba(0, 0, 0, 0.4)',borderRadius:'12px',border:\"1px solid \".concat(ref.type==='private'?'rgba(255, 193, 7, 0.3)':'rgba(0, 240, 255, 0.3)')},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'14px',fontWeight:'600',color:'#fff',marginBottom:'0.25rem'},children:[\"User \",ref.user_id.substring(0,8),\"...\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'rgba(255, 255, 255, 0.5)'},children:[\"Signed up: \",new Date(ref.signup_date).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'right'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',padding:'0.25rem 0.75rem',borderRadius:'12px',background:ref.type==='private'?'rgba(255, 193, 7, 0.2)':'rgba(0, 240, 255, 0.2)',color:ref.type==='private'?'#FFC107':'#00F0FF',fontWeight:'600',marginBottom:'0.5rem'},children:ref.type==='private'?'Private (£10 Bonus)':'Public'}),ref.type==='private'&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:ref.reached_150?'#22C55E':'rgba(255, 255, 255, 0.5)'},children:[ref.reached_150?'✓ £150 Deposited':\"\\xA3\".concat(ref.total_deposits_gbp.toFixed(2),\" deposited\"),ref.bonus_paid&&' | Bonus Paid']})]})]},idx))})]})]})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}