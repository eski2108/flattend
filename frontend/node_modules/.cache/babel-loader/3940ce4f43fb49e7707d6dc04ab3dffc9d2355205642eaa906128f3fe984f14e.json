{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import{toast}from'sonner';import getCoinLogo from'../utils/coinLogos';import MobileBottomNav from'../components/MobileBottomNav';import'./SavingsVault.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API=process.env.REACT_APP_BACKEND_URL;// Helper to get user_id consistently from localStorage\nconst getUserId=()=>{const userData=localStorage.getItem('cryptobank_user');if(!userData)return null;try{const user=JSON.parse(userData);return user.user_id||null;}catch(_unused){return null;}};const SavingsVault=()=>{const navigate=useNavigate();const[loading,setLoading]=useState(true);const[positions,setPositions]=useState([]);const[totalBalance,setTotalBalance]=useState(0);const[totalBalanceCrypto,setTotalBalanceCrypto]=useState('');const[lockedBalance,setLockedBalance]=useState(0);const[lockedBalanceCrypto,setLockedBalanceCrypto]=useState('');const[availableBalance,setAvailableBalance]=useState(0);const[availableBalanceCrypto,setAvailableBalanceCrypto]=useState('');const[totalInterestEarned,setTotalInterestEarned]=useState(0);const[totalInterestCrypto,setTotalInterestCrypto]=useState('');const[expandedCard,setExpandedCard]=useState(null);const[sortBy,setSortBy]=useState('name');const[showSortMenu,setShowSortMenu]=useState(false);const[filterActive,setFilterActive]=useState(false);const[filterFlexible,setFilterFlexible]=useState(false);const[filterStaked,setFilterStaked]=useState(false);const[selectedWallet,setSelectedWallet]=useState('Main');const[showWalletMenu,setShowWalletMenu]=useState(false);const[graphPeriod,setGraphPeriod]=useState({});const[showTransferModal,setShowTransferModal]=useState(false);const[showWithdrawModal,setShowWithdrawModal]=useState(false);const[showAddModal,setShowAddModal]=useState(false);const[showHistoryModal,setShowHistoryModal]=useState(false);// Currency selector\nconst[displayCurrency,setDisplayCurrency]=useState('GBP');const[showCurrencyMenu,setShowCurrencyMenu]=useState(false);const currencySymbols={GBP:'Â£',USD:'$',EUR:'â‚¬'};const currencyRates={GBP:1,USD:1.27,EUR:1.17};// Approximate rates from GBP\n// Modal state for deposit flow\nconst[depositStep,setDepositStep]=useState(1);// 1-5 steps\nconst[selectedCoin,setSelectedCoin]=useState('');const[depositAmount,setDepositAmount]=useState('');const[selectedNoticePeriod,setSelectedNoticePeriod]=useState(30);const[selectedPosition,setSelectedPosition]=useState(null);const[showReferralBanner,setShowReferralBanner]=useState(true);const[availableCoins,setAvailableCoins]=useState([]);const[loadingCoins,setLoadingCoins]=useState(false);const[showNoticeRulesModal,setShowNoticeRulesModal]=useState(false);const[depositLoading,setDepositLoading]=useState(false);// Helper to format balance with selected currency\nconst formatBalance=amount=>{const converted=amount*currencyRates[displayCurrency];return\"\".concat(currencySymbols[displayCurrency]).concat(converted.toFixed(2));};useEffect(()=>{loadSavingsData();loadAvailableCoins();// Check for payment success/cancel from URL params\nconst urlParams=new URLSearchParams(window.location.search);const status=urlParams.get('status');const savingsId=urlParams.get('id');if(status==='success'&&savingsId){toast.success('ðŸŽ‰ Payment successful! Your savings are being activated...');// Clean URL\nwindow.history.replaceState({},document.title,'/savings');// Reload data after a short delay\nsetTimeout(()=>{loadSavingsData();},2000);}else if(status==='cancelled'){toast.error('Payment was cancelled');window.history.replaceState({},document.title,'/savings');}},[]);// Emoji mapping for coins - COMPREHENSIVE LIST\nconst getCoinEmoji=symbol=>{const emojiMap={// Top cryptos\n'BTC':'â‚¿','ETH':'â—†','USDT':'ðŸ’µ','USDC':'ðŸ’²','BNB':'ðŸ”¶','XRP':'âœ–ï¸','SOL':'â˜€ï¸','ADA':'ðŸŒ','DOGE':'ðŸ¶','TRX':'ðŸ”º','DOT':'ðŸŽ¯','MATIC':'ðŸ”·','LTC':'ðŸŒ•','SHIB':'ðŸ•','AVAX':'ðŸ”ï¸','LINK':'ðŸ”—','ATOM':'âš›ï¸','UNI':'ðŸ¦„','XLM':'â­','XMR':'ðŸ•¶ï¸','BCH':'ðŸ’š','TON':'ðŸ”µ','DAI':'ðŸŸ¡','ETC':'ðŸŸ¢','FIL':'ðŸ“','VET':'â™¦ï¸','ALGO':'â—¯','WBTC':'ðŸ”„','NEAR':'ðŸŒˆ','ICP':'âˆž',// Meme coins\n'PEPE':'ðŸ¸','FLOKI':'ðŸ•','BONK':'ðŸ’¥','WIF':'ðŸ§¢','MEME':'ðŸ˜‚','LEASH':'ðŸ¦´','ELON':'ðŸš€','BABYDOGE':'ðŸ¶','KISHU':'ðŸ•',// Stablecoins\n'BUSD':'ðŸ’µ','TUSD':'ðŸ’µ','USDP':'ðŸ’²','GUSD':'ðŸ¦','USDD':'ðŸ’µ','FRAX':'ðŸ›ï¸','LUSD':'ðŸ’µ','SUSD':'ðŸ’µ',// DeFi tokens\n'AAVE':'ðŸ‘»','COMP':'ðŸ›ï¸','MKR':'ðŸ‘‘','SNX':'âš¡','CRV':'ðŸŒŠ','SUSHI':'ðŸ£','CAKE':'ðŸŽ‚','1INCH':'ðŸ¦„','BAL':'âš–ï¸','YFI':'ðŸ’Ž','RUNE':'âš”ï¸','ALPHA':'ðŸº','CREAM':'ðŸ¦','BADGER':'ðŸ¦¡',// Gaming/Metaverse\n'AXS':'ðŸŽ®','SAND':'ðŸ–ï¸','MANA':'ðŸŒ','ENJ':'ðŸŽ®','GALA':'ðŸŽª','IMX':'ðŸŽ®','GODS':'âš”ï¸','SUPER':'ðŸ¦¸','STARL':'ðŸŒŸ','RACA':'ðŸŽ¨',// Layer 2 & Scaling\n'ARB':'ðŸ”·','OP':'ðŸ”´','LRC':'â­•','ZK':'ðŸ”','METIS':'âš¡',// Exchange tokens\n'FTT':'ðŸ“ˆ','OKB':'â­•','HT':'ðŸ”¥','KCS':'ðŸŽ¯','GT':'ðŸŽ¯','CRO':'ðŸ’Ž','LEO':'ðŸ¦','WOO':'ðŸŒŠ','MX':'ðŸ’¹',// AI & Tech\n'FET':'ðŸ¤–','AGIX':'ðŸ§ ','OCEAN':'ðŸŒŠ','GRT':'ðŸ“Š','RENDER':'ðŸŽ¨','INJ':'ðŸ’‰','RNDR':'ðŸŽ¬','PAAL':'ðŸ¤–',// Privacy coins\n'DASH':'ðŸ’¸','ZEC':'ðŸ”’','DCR':'ðŸ”','SC':'â˜ï¸',// Other major coins\n'APT':'ðŸ”·','ARB':'ðŸ”µ','OP':'ðŸ”´','SUI':'ðŸ’§','SEI':'âš¡','TIA':'ðŸŒŒ','INJ':'ðŸ’‰','RUNE':'âš”ï¸','OSMO':'ðŸŒŠ','KUJI':'ðŸŒªï¸','LUNA':'ðŸŒ™','LUNC':'ðŸŒ‘','UST':'ðŸ’µ','USTC':'ðŸ’µ',// Specific tokens from your list\n'MEW':'ðŸ˜º','USDR':'ðŸ’²','USDTMATIC':'ðŸ’µ','USDCBSC':'ðŸ’²','SHIBBSC':'ðŸ•','AVAXC':'ðŸ”ï¸','BERA':'ðŸ»','RVN':'ðŸ¦…','WOLFERC20':'ðŸº','GUARD':'ðŸ›¡ï¸','AWEBASE':'âš¡','USDTSOL':'ðŸ’µ','VET':'ðŸ’Ž','WETH':'â—†','WBNB':'ðŸ”¶','WMATIC':'ðŸ”·',// Base/Chain specific\n'BASE':'ðŸ”µ','ARB':'ðŸ”·','OP':'ðŸ”´','ZKSYNC':'ðŸ”','POLYGON':'ðŸ”·','ARBITRUM':'ðŸ”·','OPTIMISM':'ðŸ”´',// Others\n'FTM':'ðŸ‘»','ONE':'1ï¸âƒ£','HBAR':'â™¾ï¸','THETA':'ðŸ“º','TFUEL':'â›½','EGLD':'âš¡','FLOW':'ðŸŒŠ','ROSE':'ðŸŒ¹','KDA':'â›“ï¸','KLAY':'ðŸŽ®','MINA':'ðŸ”','ZIL':'âš¡'};// Try exact match first\nconst upperSymbol=symbol.toUpperCase();if(emojiMap[upperSymbol])return emojiMap[upperSymbol];// Try partial matches for wrapped/chain-specific tokens\nif(upperSymbol.includes('USDT'))return'ðŸ’µ';if(upperSymbol.includes('USDC'))return'ðŸ’²';if(upperSymbol.includes('BTC'))return'â‚¿';if(upperSymbol.includes('ETH'))return'â—†';if(upperSymbol.includes('SHIB'))return'ðŸ•';if(upperSymbol.includes('DOGE'))return'ðŸ¶';// Default fallback\nreturn'ðŸ’Ž';};const loadAvailableCoins=async()=>{try{setLoadingCoins(true);// Try NowPayments first for 230+ coins\nconst nowPaymentsResponse=await axios.get(\"\".concat(API,\"/api/nowpayments/currencies\"));if(nowPaymentsResponse.data.success&&nowPaymentsResponse.data.currencies){const currencies=nowPaymentsResponse.data.currencies;// Convert NowPayments format to our format\nconst coinList=currencies.map(symbol=>({symbol:symbol.toUpperCase(),name:symbol.charAt(0).toUpperCase()+symbol.slice(1),emoji:getCoinEmoji(symbol)}));setAvailableCoins(coinList);setLoadingCoins(false);// FIX: SET TO FALSE HERE\nreturn;}}catch(error){console.error('NowPayments fetch failed, trying backend fallback:',error);}// Fallback to backend supported cryptocurrencies\ntry{const response=await axios.get(\"\".concat(API,\"/api/supported/cryptocurrencies\"));if(response.data.success){const cryptos=response.data.cryptocurrencies;const coinList=Object.keys(cryptos).map(symbol=>({symbol:symbol,name:cryptos[symbol].name,emoji:getCoinEmoji(symbol)}));setAvailableCoins(coinList);}}catch(error){console.error('Error loading coins:',error);// Final fallback to default list\nsetAvailableCoins([{symbol:'BTC',name:'Bitcoin',emoji:'â‚¿'},{symbol:'ETH',name:'Ethereum',emoji:'â—†'},{symbol:'USDT',name:'Tether',emoji:'ðŸ’µ'},{symbol:'USDC',name:'USD Coin',emoji:'ðŸ’²'},{symbol:'BNB',name:'Binance Coin',emoji:'ðŸ”¶'},{symbol:'SOL',name:'Solana',emoji:'â˜€ï¸'},{symbol:'XRP',name:'Ripple',emoji:'âœ–ï¸'},{symbol:'ADA',name:'Cardano',emoji:'ðŸŒ'},{symbol:'DOGE',name:'Dogecoin',emoji:'ðŸ¶'},{symbol:'DOT',name:'Polkadot',emoji:'ðŸŽ¯'},{symbol:'MATIC',name:'Polygon',emoji:'ðŸ”·'},{symbol:'LTC',name:'Litecoin',emoji:'ðŸŒ•'},{symbol:'LINK',name:'Chainlink',emoji:'ðŸ”—'},{symbol:'AVAX',name:'Avalanche',emoji:'ðŸ”ï¸'}]);}finally{setLoadingCoins(false);}};useEffect(()=>{loadSavingsData();loadAvailableCoins();// LOAD COINS ON PAGE MOUNT\n},[]);const loadSavingsData=async()=>{try{setLoading(true);const userId=getUserId();if(!userId){console.error('No user_id found - user not logged in');setLoading(false);return;}// REAL BACKEND CALL\nconst response=await axios.get(\"\".concat(API,\"/api/savings/positions/\").concat(userId));if(response.data.success){var _data$positions;const data=response.data;setPositions(data.positions||[]);setTotalBalance(data.total_balance_usd||0);setTotalBalanceCrypto(data.total_balance_crypto||'0.00 BTC');setLockedBalance(data.locked_balance_usd||0);setLockedBalanceCrypto(data.locked_balance_crypto||'0.00 BTC');setAvailableBalance(data.available_balance_usd||0);setAvailableBalanceCrypto(data.available_balance_crypto||'0.00 BTC');setTotalInterestEarned(data.total_interest_earned_usd||0);setTotalInterestCrypto(data.total_interest_earned_crypto||'0.00 BTC');// Initialize graph periods\nconst periods={};(_data$positions=data.positions)===null||_data$positions===void 0?void 0:_data$positions.forEach((pos,idx)=>{periods[idx]='30d';});setGraphPeriod(periods);}}catch(error){console.error('Error loading savings:',error);setPositions([]);}finally{setLoading(false);}};const toggleCard=index=>{setExpandedCard(expandedCard===index?null:index);};const handleSort=criteria=>{setSortBy(criteria);setShowSortMenu(false);// Sort positions\nconst sorted=[...positions].sort((a,b)=>{if(criteria==='name')return a.symbol.localeCompare(b.symbol);if(criteria==='apy')return(b.apy||0)-(a.apy||0);if(criteria==='earned')return(b.interest_earned_usd||0)-(a.interest_earned_usd||0);if(criteria==='balance')return(b.balance_usd||0)-(a.balance_usd||0);return 0;});setPositions(sorted);};const getFilteredPositions=()=>{let filtered=positions;if(filterActive){filtered=filtered.filter(p=>p.balance>0);}if(filterFlexible&&!filterStaked){filtered=filtered.filter(p=>p.type==='flexible');}else if(filterStaked&&!filterFlexible){filtered=filtered.filter(p=>p.type==='staked');}return filtered;};const handleToggleFlexibleStaked=async(index,newType)=>{try{const position=positions[index];const userId=getUserId();if(!userId){toast.error('Please log in first');return;}const response=await axios.post(\"\".concat(API,\"/api/savings/toggle-type\"),{user_id:userId,position_id:position.id,new_type:newType});if(response.data.success){toast.success(\"Changed to \".concat(newType,\" savings\"));loadSavingsData();}}catch(error){console.error('Toggle type error:',error);toast.error('Failed to change savings type');}};const handleToggleAutoCompound=async index=>{try{const position=positions[index];const userId=getUserId();if(!userId){toast.error('Please log in first');return;}const newValue=!position.auto_compound;const response=await axios.post(\"\".concat(API,\"/api/savings/auto-compound\"),{user_id:userId,position_id:position.id,enabled:newValue});if(response.data.success){toast.success(\"Auto-compound \".concat(newValue?'enabled':'disabled'));loadSavingsData();}}catch(error){console.error('Auto-compound error:',error);toast.error('Failed to update auto-compound setting');}};const handleLockPeriodChange=async(index,period)=>{try{const position=positions[index];const userId=getUserId();if(!userId){toast.error('Please log in first');return;}const response=await axios.post(\"\".concat(API,\"/api/savings/change-period\"),{user_id:userId,position_id:position.id,new_period:period});if(response.data.success){toast.success(\"Lock period changed to \".concat(period,\" days\"));loadSavingsData();}}catch(error){console.error('Lock period change error:',error);toast.error('Failed to change lock period');}};const filteredPositions=getFilteredPositions();return/*#__PURE__*/_jsxs(\"div\",{className:\"savings-vault-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"savings-vault-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-title-section\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"savings-vault-title\",children:\"Savings Vault\"}),/*#__PURE__*/_jsx(\"p\",{className:\"savings-vault-subtitle\",children:\"Securely store your crypto in locked accounts. Choose 30, 60, or 90 day notice periods for withdrawals.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-actions\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"wallet-selector-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"wallet-selector-btn\",onClick:()=>setShowWalletMenu(!showWalletMenu),children:[/*#__PURE__*/_jsxs(\"span\",{className:\"wallet-label\",children:[\"Wallet: \",selectedWallet]}),/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-arrow\",children:\"\\u25BC\"})]}),showWalletMenu&&/*#__PURE__*/_jsxs(\"div\",{className:\"wallet-dropdown-menu\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item \".concat(selectedWallet==='Main'?'active':''),onClick:()=>{navigate('/wallet');setShowWalletMenu(false);},children:\"Main Wallet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item \".concat(selectedWallet==='Trading'?'active':''),onClick:()=>{navigate('/trading');setShowWalletMenu(false);},children:\"Trading Wallet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item \".concat(selectedWallet==='Savings'?'active':''),onClick:()=>{setSelectedWallet('Savings');setShowWalletMenu(false);},children:\"Savings Wallet (Current)\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"transfer-from-wallet-btn\",onClick:()=>setShowTransferModal(true),children:\"Add to Savings\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-cards-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"currency-selector-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"currency-label-text\",children:\"Display Currency:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"currency-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"currency-toggle-btn\",onClick:()=>setShowCurrencyMenu(!showCurrencyMenu),children:[currencySymbols[displayCurrency],\" \",displayCurrency,/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-arrow\",children:\"\\u25BC\"})]}),showCurrencyMenu&&/*#__PURE__*/_jsx(\"div\",{className:\"currency-menu\",children:['GBP','USD','EUR'].map(curr=>/*#__PURE__*/_jsxs(\"button\",{className:\"currency-option \".concat(displayCurrency===curr?'active':''),onClick:()=>{setDisplayCurrency(curr);setShowCurrencyMenu(false);},children:[currencySymbols[curr],\" \",curr]},curr))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-card glassmorphic-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-icon-bg wallet-icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-label\",children:[\"Total Balance\",/*#__PURE__*/_jsx(\"span\",{className:\"info-tooltip\",title:\"Total value of all your savings deposits\",children:\"\\u24D8\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-value-main\",children:formatBalance(totalBalance)}),/*#__PURE__*/_jsx(\"div\",{className:\"card-value-fiat\",children:positions.length>0?\"\".concat(positions.length,\" asset(s)\"):'No deposits yet'}),/*#__PURE__*/_jsxs(\"div\",{className:\"live-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"live-dot pulsing\"}),/*#__PURE__*/_jsx(\"span\",{className:\"live-text\",children:\"Live\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-card glassmorphic-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-icon-bg lock-icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-label\",children:[\"Locked Balance\",/*#__PURE__*/_jsx(\"span\",{className:\"info-tooltip\",title:\"Funds currently in notice period. Early withdrawal will incur penalty.\",children:\"\\u24D8\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-value-main\",children:formatBalance(lockedBalance)}),/*#__PURE__*/_jsx(\"div\",{className:\"card-value-fiat\",children:\"In notice period\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"live-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"live-dot pulsing\"}),/*#__PURE__*/_jsx(\"span\",{className:\"live-text\",children:\"Live\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-card glassmorphic-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-icon-bg unlock-icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-label\",children:[\"Available to Withdraw\",/*#__PURE__*/_jsx(\"span\",{className:\"info-tooltip\",title:\"Funds ready to withdraw without penalty. Notice period has ended.\",children:\"\\u24D8\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-value-main\",children:formatBalance(availableBalance)}),/*#__PURE__*/_jsx(\"div\",{className:\"card-value-fiat\",children:\"Ready to withdraw\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"live-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"live-dot pulsing\"}),/*#__PURE__*/_jsx(\"span\",{className:\"live-text\",children:\"Live\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"locked-savings-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"locked-savings-header\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"locked-savings-title\",children:\"Notice Savings \\u2014 Secure Storage\"}),/*#__PURE__*/_jsx(\"p\",{className:\"locked-savings-subtitle\",children:\"Lock your crypto for added security. Early withdrawals incur a fee.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"early-withdrawal-warning\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"warning-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"warning-content\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"warning-title\",children:\"Early Withdrawal Penalty\"}),/*#__PURE__*/_jsx(\"span\",{className:\"warning-text\",children:\"Withdrawing before the lock period ends will result in a fee (see cards below). Locked funds cannot be withdrawn until the period ends without penalty.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"savings-periods-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"savings-card savings-card-30 \".concat(selectedNoticePeriod===30?'selected':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"period-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"period-days\",children:\"30\"}),/*#__PURE__*/_jsx(\"div\",{className:\"period-label\",children:\"DAYS\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"apy-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"apy-value\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"div\",{className:\"apy-label\",children:\"Secure Storage\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fee-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"fee-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"fee-icon\",children:\"\\u26A0\"}),/*#__PURE__*/_jsx(\"span\",{className:\"fee-title\",children:\"Early Withdrawal\"}),/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"If you withdraw before the lock period ends, this fee is deducted from your principal.\",children:\"?\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"fee-amount\",children:\"1.5% Fee\"}),/*#__PURE__*/_jsx(\"div\",{className:\"fee-note\",children:\"Deducted from principal\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tagline-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"tagline\",children:\"\\uD83D\\uDCA1 Short-term Goals\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-visual\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill progress-30-day\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"time-label\",children:\"33% of max term\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"cta-button cta-30-day\",onClick:()=>{setSelectedNoticePeriod(30);setShowTransferModal(true);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"button-icon\",children:\"\\uD83D\\uDD12\"}),\"Lock for 30 Days\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"savings-card savings-card-60 most-popular \".concat(selectedNoticePeriod===60?'selected':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"popular-badge\",children:\"\\u2B50 Most Popular\"}),/*#__PURE__*/_jsx(\"div\",{className:\"most-popular-glow\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"period-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"period-days\",children:\"60\"}),/*#__PURE__*/_jsx(\"div\",{className:\"period-label\",children:\"DAYS\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"apy-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"apy-value\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"div\",{className:\"apy-label\",children:\"Secure Storage\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fee-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"fee-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"fee-icon\",children:\"\\u26A0\"}),/*#__PURE__*/_jsx(\"span\",{className:\"fee-title\",children:\"Early Withdrawal\"}),/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"If you withdraw before the lock period ends, this fee is deducted from your principal.\",children:\"?\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"fee-amount\",children:\"1.0% Fee\"}),/*#__PURE__*/_jsx(\"div\",{className:\"fee-note\",children:\"Deducted from principal\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tagline-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"tagline\",children:\"\\u2696\\uFE0F Balanced Option\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-visual\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill progress-60-day\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"time-label\",children:\"66% of max term\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"cta-button cta-60-day\",onClick:()=>{setSelectedNoticePeriod(60);setShowTransferModal(true);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"button-icon\",children:\"\\uD83D\\uDD12\"}),\"Lock for 60 Days\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"savings-card savings-card-90 \".concat(selectedNoticePeriod===90?'selected':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"max-returns-badge\",children:\"\\uD83D\\uDC8E Lowest Fee\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"period-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"period-days\",children:\"90\"}),/*#__PURE__*/_jsx(\"div\",{className:\"period-label\",children:\"DAYS\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"apy-container apy-highest\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"apy-value\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"div\",{className:\"apy-label\",children:\"Secure Storage\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fee-container fee-lowest\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"fee-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"fee-icon\",children:\"\\u26A0\"}),/*#__PURE__*/_jsx(\"span\",{className:\"fee-title\",children:\"Early Withdrawal\"}),/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-icon\",title:\"If you withdraw before the lock period ends, this fee is deducted from your principal.\",children:\"?\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"fee-amount\",children:\"0.5% Fee\"}),/*#__PURE__*/_jsx(\"div\",{className:\"fee-note\",children:\"Lowest penalty rate\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tagline-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"tagline\",children:\"\\uD83D\\uDC8E Maximum Security\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-visual\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill progress-90-day\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"time-label\",children:\"100% - Full term\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"cta-button cta-90-day\",onClick:()=>{setSelectedNoticePeriod(90);setShowTransferModal(true);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"button-icon\",children:\"\\uD83D\\uDD12\"}),\"Lock for 90 Days\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"calculator-hint\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"calculator-icon\",children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsx(\"span\",{className:\"calculator-text\",children:\"Example: Lock $1,000 for 90 days for secure storage. Early withdrawal fee applies.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"security-footer\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"security-icon\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"span\",{className:\"security-text\",children:\"Funds are secured and protected. Your principal is never at risk.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"notice-rules-btn\",onClick:()=>setShowNoticeRulesModal(true),children:\"View Terms & Conditions\"})]})]}),showReferralBanner&&/*#__PURE__*/_jsxs(\"div\",{className:\"referral-banner glassmorphic-card purple-accent clickable\",onClick:()=>navigate('/referrals'),style:{cursor:'pointer'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"referral-content\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"referral-icon\",children:\"\\uD83C\\uDF81\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"referral-text-section\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"referral-title\",children:\"Invite friends, earn more\"}),/*#__PURE__*/_jsx(\"span\",{className:\"referral-subtitle\",children:\"Get 10% bonus when your referrals use CoinHubX\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"referral-arrow\",children:\"\\u2192\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"dismiss-banner-btn\",onClick:e=>{e.stopPropagation();setShowReferralBanner(false);},children:\"\\u2715\"})]}),positions.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"controls-toolbar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sort-control\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"sort-btn\",onClick:()=>setShowSortMenu(!showSortMenu),children:[/*#__PURE__*/_jsx(\"span\",{className:\"sort-label\",children:\"Sort: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"sort-value\",children:sortBy==='name'?'Token Name':sortBy==='balance'?'Balance':'Balance'}),/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-arrow\",children:\"\\u25BC\"})]}),showSortMenu&&/*#__PURE__*/_jsxs(\"div\",{className:\"sort-dropdown-menu\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item\",onClick:()=>handleSort('name'),children:\"Token Name\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item\",onClick:()=>handleSort('balance'),children:\"Balance (High to Low)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item\",onClick:()=>handleSort('earned'),children:\"Total Earned\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item\",onClick:()=>handleSort('balance'),children:\"Balance\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-toggles\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"filter-toggle-btn \".concat(filterActive?'active':''),onClick:()=>setFilterActive(!filterActive),children:[\"Active \",filterActive&&'âœ“']}),/*#__PURE__*/_jsxs(\"button\",{className:\"filter-toggle-btn \".concat(filterFlexible?'active':''),onClick:()=>setFilterFlexible(!filterFlexible),children:[\"30 Day \",filterFlexible&&'âœ“']}),/*#__PURE__*/_jsxs(\"button\",{className:\"filter-toggle-btn \".concat(filterStaked?'active':''),onClick:()=>setFilterStaked(!filterStaked),children:[\"60/90 Day \",filterStaked&&'âœ“']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"visible-count\",children:[filteredPositions.length,\"/\",positions.length,\" assets shown\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"portfolio-list-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header-with-description\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-heading\",children:\"Your Savings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-description\",children:\"Monitor your locked funds. Each row shows amount, lock period, and time remaining.\"})]}),loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-card\"}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-card\"}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-card\"})]}):filteredPositions.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state-card glassmorphic-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-state-icon\",children:\"\\uD83C\\uDFE6\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"empty-state-title\",children:\"Start Earning with Notice Accounts\"}),/*#__PURE__*/_jsx(\"p\",{className:\"empty-state-description\",children:\"Lock your crypto for 30, 60, or 90 days for secure storage.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state-steps\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"step-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"step-number\",children:\"1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"step-text\",children:\"Choose lock period above\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"step-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"step-number\",children:\"2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"step-text\",children:\"Transfer from wallet\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"step-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"step-number\",children:\"3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"step-text\",children:\"Funds securely locked\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"empty-state-cta\",onClick:()=>setShowTransferModal(true),children:\"Add to Savings\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"savings-table-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"savings-table-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-cell asset-col\",children:\"Asset\"}),/*#__PURE__*/_jsx(\"div\",{className:\"header-cell amount-col\",children:\"Locked Amount\"}),/*#__PURE__*/_jsx(\"div\",{className:\"header-cell apy-col\",children:\"Status\"}),/*#__PURE__*/_jsx(\"div\",{className:\"header-cell date-col\",children:\"End Date\"}),/*#__PURE__*/_jsx(\"div\",{className:\"header-cell fee-col\",children:\"Early Withdrawal Fee\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"token-cards-list\",children:filteredPositions.map((position,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"token-card glassmorphic-card \".concat(expandedCard===index?'expanded':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"token-card-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"token-identity\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"token-icon-circle\",children:/*#__PURE__*/_jsx(\"img\",{src:getCoinLogo(position.symbol),alt:position.symbol,onError:e=>{if(!e.target.dataset.triedSvg){e.target.dataset.triedSvg='true';e.target.src=\"/crypto-icons/\".concat(position.symbol.toLowerCase(),\".svg\");}else{var _position$symbol;e.target.style.display='none';const letter=((_position$symbol=position.symbol)===null||_position$symbol===void 0?void 0:_position$symbol.substring(0,1))||'?';e.target.parentElement.innerHTML=\"<div class=\\\"fallback-icon\\\">\".concat(letter,\"</div>\");}}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"token-name-label\",children:[position.name||position.symbol,\" (\",position.symbol,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"token-balance-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"balance-primary\",children:[position.balance||'0.000',\" \",position.symbol]}),/*#__PURE__*/_jsxs(\"div\",{className:\"balance-fiat\",children:[\"\\u2248 $\",position.balance_usd||'0.00']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"token-apy-section\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"apy-label\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"apy-value\",children:[position.apy||0,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"token-pnl-section\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"pnl-label\",children:\"P/L:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"pnl-value \".concat(position.pnl_percentage>=0?'positive':'negative'),children:[position.pnl_percentage>=0?'â†‘ +':'â†“ ',position.pnl_percentage||0,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"token-24h-section\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"h24-label\",children:\"24h:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"h24-value \".concat(position.price_change_24h>=0?'positive':'negative'),children:[position.price_change_24h>=0?'+':'',position.price_change_24h||0,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"token-interest-earned\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"earned-label\",children:\"Interest earned:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"earned-value\",children:[position.interest_earned||'0.00',\" \",position.symbol]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"token-est-monthly\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"monthly-label\",children:\"Est. Monthly:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"monthly-value\",children:[\"~$\",position.estimated_monthly||'0.00']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"token-sparkline\",children:/*#__PURE__*/_jsx(\"svg\",{width:\"80\",height:\"30\",viewBox:\"0 0 80 30\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M 0 20 L 20 18 L 40 15 L 60 12 L 80 10\",stroke:position.pnl_percentage>=0?'#00FF85':'#FF4D6D',strokeWidth:\"2\",fill:\"none\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"token-status-badge\",children:/*#__PURE__*/_jsx(\"span\",{className:\"status-badge \".concat(position.type==='flexible'?'available':'locked'),children:position.type==='flexible'?'Available':'Locked'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"token-toggles-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"notice-period-display\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"notice-label\",children:\"Notice Period:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"notice-value\",children:[position.lock_period||30,\" Days\"]})]}),position.type!=='flexible'&&/*#__PURE__*/_jsxs(\"div\",{className:\"countdown-timer\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"countdown-label\",children:\"Days Remaining:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"countdown-value\",children:\"23 Days\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"auto-compound-switch\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"switch-label\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"switch-text\",children:\"Auto-Compound\"}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",className:\"switch-input\",checked:position.auto_compound||false,onChange:e=>{e.stopPropagation();handleToggleAutoCompound(index);}}),/*#__PURE__*/_jsx(\"span\",{className:\"switch-slider\"})]})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"expand-collapse-btn\",onClick:()=>toggleCard(index),children:expandedCard===index?'â–²':'â–¼'})]}),expandedCard===index&&/*#__PURE__*/_jsxs(\"div\",{className:\"token-card-expanded\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"price-info-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"price-info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"price-label\",children:\"Current Price\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"price-value\",children:[\"$\",position.current_price||'Loading...']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"price-label\",children:\"P/L (Unrealised)\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"price-value \".concat(position.pnl_percentage>=0?'positive':'negative'),children:[position.pnl_percentage>=0?'â†‘':'â†“',\" \",position.pnl_percentage>=0?'+':'',position.pnl_percentage||'0.00',\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"price-label\",children:\"P/L Value\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"price-value \".concat(position.pnl_usd>=0?'positive':'negative'),children:[position.pnl_usd>=0?'+':'',\"$\",position.pnl_usd||'0.00']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"price-label\",children:\"Entry Price\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"price-value secondary\",children:[\"$\",position.entry_price||'N/A']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"earnings-graph-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"graph-period-toggle\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"period-btn \".concat((graphPeriod[index]||'30d')==='30d'?'active':''),onClick:()=>setGraphPeriod(_objectSpread(_objectSpread({},graphPeriod),{},{[index]:'30d'})),children:\"30D\"}),/*#__PURE__*/_jsx(\"button\",{className:\"period-btn \".concat((graphPeriod[index]||'30d')==='90d'?'active':''),onClick:()=>setGraphPeriod(_objectSpread(_objectSpread({},graphPeriod),{},{[index]:'90d'})),children:\"90D\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"graph-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"graph-label\",children:\"Price Movement (30D)\"}),/*#__PURE__*/_jsxs(\"svg\",{className:\"earnings-chart\",viewBox:\"0 0 600 100\",preserveAspectRatio:\"none\",children:[/*#__PURE__*/_jsx(\"defs\",{children:/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"grad-\".concat(index),x1:\"0%\",y1:\"0%\",x2:\"0%\",y2:\"100%\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"0%\",style:{stopColor:position.pnl_percentage>=0?'#00FF85':'#FF4D4F',stopOpacity:0.3}}),/*#__PURE__*/_jsx(\"stop\",{offset:\"100%\",style:{stopColor:position.pnl_percentage>=0?'#00FF85':'#FF4D4F',stopOpacity:0}})]})}),/*#__PURE__*/_jsx(\"path\",{className:\"earnings-line\",d:\"M 0 80 L 100 70 L 200 50 L 300 40 L 400 45 L 500 30 L 600 20\",stroke:position.pnl_percentage>=0?'#00FF85':'#FF4D4F',strokeWidth:\"2\",fill:\"none\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M 0 100 L 0 80 L 100 70 L 200 50 L 300 40 L 400 45 L 500 30 L 600 20 L 600 100 Z\",fill:\"url(#grad-\".concat(index,\")\")})]})]})]}),position.type!=='flexible'&&/*#__PURE__*/_jsxs(\"div\",{className:\"early-withdrawal-warning\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"warning-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"warning-text\",children:[\"Early withdrawal fee: \",position.lock_period===30?'1.5%':position.lock_period===60?'1.0%':'0.5%',\" will be deducted from principal\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons-row\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"action-btn add-btn\",onClick:()=>{setSelectedPosition(position);setShowAddModal(true);},children:\"Add to Savings\"}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn withdraw-btn\",onClick:()=>{setSelectedPosition(position);setShowWithdrawModal(true);},children:position.type==='flexible'?'Withdraw':'Early Withdrawal'}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn details-btn\",onClick:()=>{setSelectedPosition(position);setShowHistoryModal(true);},children:\"View Details\"})]}),position.type==='staked'&&/*#__PURE__*/_jsxs(\"div\",{className:\"lockup-period-selectors\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"lockup-pill \".concat(position.lock_period===7?'active':''),onClick:()=>handleLockPeriodChange(index,7),children:\"7d\"}),/*#__PURE__*/_jsx(\"button\",{className:\"lockup-pill \".concat(position.lock_period===30?'active':''),onClick:()=>handleLockPeriodChange(index,30),children:\"30d\"}),/*#__PURE__*/_jsx(\"button\",{className:\"lockup-pill \".concat(position.lock_period===90?'active':''),onClick:()=>handleLockPeriodChange(index,90),children:\"90d\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"interest-history-btn\",onClick:()=>{setSelectedPosition(position);setShowHistoryModal(true);},children:\"\\uD83D\\uDCD1 Interest History\"})]})]},index))})]})]}),/*#__PURE__*/_jsx(MobileBottomNav,{}),showTransferModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowTransferModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content glassmorphic-card modal-large\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Add to Savings\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close-btn\",onClick:()=>{setShowTransferModal(false);setDepositStep(1);},children:\"\\u2715\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-flow-steps\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-indicator \".concat(depositStep>=1?'active':'',\" \").concat(depositStep>1?'completed':''),children:\"1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-line\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-indicator \".concat(depositStep>=2?'active':'',\" \").concat(depositStep>2?'completed':''),children:\"2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-line\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-indicator \".concat(depositStep>=3?'active':'',\" \").concat(depositStep>3?'completed':''),children:\"3\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-line\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-indicator \".concat(depositStep>=4?'active':'',\" \").concat(depositStep>4?'completed':''),children:\"4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-line\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-indicator \".concat(depositStep>=5?'active':''),children:\"5\"})]}),depositStep===1&&/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-step\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Step 1: Select Wallet Source\"}),/*#__PURE__*/_jsx(\"p\",{className:\"step-description\",children:\"Select which wallet to transfer funds from\"}),/*#__PURE__*/_jsx(\"div\",{className:\"wallet-source-options\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"wallet-source-card selected\",onClick:()=>{},children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"wallet-svg-icon\",width:\"32\",height:\"32\",viewBox:\"0 0 48 48\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:[/*#__PURE__*/_jsx(\"rect\",{x:\"6\",y:\"14\",width:\"36\",height:\"24\",rx:\"4\",fill:\"#1e3a5f\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"6\",y:\"14\",width:\"36\",height:\"8\",fill:\"#2563eb\",opacity:\"0.3\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"28\",y:\"22\",width:\"14\",height:\"10\",rx:\"2\",fill:\"#0f172a\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"35\",cy:\"27\",r:\"3\",fill:\"#22d3ee\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"wallet-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"wallet-name\",children:\"Main Wallet\"}),/*#__PURE__*/_jsx(\"span\",{className:\"wallet-hint\",children:\"Your primary wallet balance\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"check-mark\",children:\"\\u2713\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"step-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"modal-secondary-btn\",onClick:()=>{setShowTransferModal(false);setDepositStep(1);navigate('/wallet');},children:\"Go to Main Wallet\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-cta-btn\",onClick:()=>setDepositStep(2),children:\"Next\"})]})]}),depositStep===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-step\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Step 2: Select Coin\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"step-subtitle\",children:[availableCoins.length,\" cryptocurrencies available\"]}),loadingCoins?/*#__PURE__*/_jsx(\"div\",{className:\"loading-coins\",children:\"Loading coins...\"}):/*#__PURE__*/_jsx(\"div\",{className:\"coin-grid\",children:availableCoins.map(coin=>/*#__PURE__*/_jsxs(\"div\",{className:\"coin-option-card \".concat(selectedCoin===coin.symbol?'selected':''),onClick:()=>setSelectedCoin(coin.symbol),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"coin-option-logo-wrapper\",children:[/*#__PURE__*/_jsx(\"img\",{src:getCoinLogo(coin.symbol),alt:coin.symbol,className:\"coin-option-logo\",onError:e=>{e.target.style.display='none';e.target.nextSibling.style.display='flex';}}),/*#__PURE__*/_jsx(\"div\",{className:\"coin-emoji-fallback\",style:{display:'none'},children:coin.symbol.charAt(0)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"coin-option-info\",children:/*#__PURE__*/_jsx(\"span\",{className:\"coin-option-symbol\",children:coin.symbol})})]},coin.symbol))}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-cta-btn\",onClick:()=>setDepositStep(3),disabled:!selectedCoin,children:\"Next\"})]}),depositStep===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-step\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Step 3: Enter Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"deposit-input\",placeholder:\"0.00\",value:depositAmount,onChange:e=>setDepositAmount(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-secondary-btn\",onClick:()=>setDepositAmount('1.0'),children:\"Max\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-cta-btn\",onClick:()=>setDepositStep(4),disabled:!depositAmount,children:\"Next\"})]}),depositStep===4&&/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-step\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Step 4: Select Notice Period\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"notice-selector-mini\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"notice-mini-btn \".concat(selectedNoticePeriod===30?'active':''),onClick:()=>setSelectedNoticePeriod(30),children:\"30 Days\"}),/*#__PURE__*/_jsx(\"button\",{className:\"notice-mini-btn \".concat(selectedNoticePeriod===60?'active':''),onClick:()=>setSelectedNoticePeriod(60),children:\"60 Days\"}),/*#__PURE__*/_jsx(\"button\",{className:\"notice-mini-btn \".concat(selectedNoticePeriod===90?'active':''),onClick:()=>setSelectedNoticePeriod(90),children:\"90 Days\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-cta-btn\",onClick:()=>setDepositStep(5),children:\"Next\"})]}),depositStep===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-step\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Step 5: Confirm Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-box\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Amount:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[depositAmount,\" \",selectedCoin]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Notice Period:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[selectedNoticePeriod,\" days\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Lock Period:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"success-text\",children:[selectedNoticePeriod,\" Days\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Unlock Date:\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(Date.now()+selectedNoticePeriod*24*60*60*1000).toLocaleDateString()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Early Withdrawal Fee:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"danger-text\",children:[selectedNoticePeriod===30?'1.5%':selectedNoticePeriod===60?'1.0%':'0.5%',\" of principal\"]})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-cta-btn\",disabled:depositLoading,onClick:async()=>{try{setDepositLoading(true);const userId=getUserId();if(!userId){toast.error('Please log in first');setDepositLoading(false);return;}// Call initiate endpoint - returns NowPayments URL\nconst response=await axios.post(\"\".concat(API,\"/api/savings/initiate\"),{user_id:userId,asset:selectedCoin,amount:parseFloat(depositAmount),lock_period_days:selectedNoticePeriod});if(response.data.success&&response.data.payment_url){toast.success('Redirecting to payment...');// Redirect to NowPayments hosted checkout\nwindow.location.href=response.data.payment_url;}else{toast.error('Failed to create payment');setDepositLoading(false);}}catch(error){var _error$response,_error$response$data;console.error('Deposit error:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Deposit failed');setDepositLoading(false);}},children:depositLoading?'Processing...':'Proceed to Payment'})]})]})}),showWithdrawModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowWithdrawModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content glassmorphic-card\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Withdraw from Savings\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close-btn\",onClick:()=>setShowWithdrawModal(false),children:\"\\u2715\"}),selectedPosition&&selectedPosition.type!=='flexible'&&/*#__PURE__*/_jsxs(\"div\",{className:\"modal-warning-box\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"modal-warning-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-warning-content\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-warning-title\",children:\"Early Withdrawal Penalty\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"modal-warning-text\",children:[\"Withdrawing before your notice period ends will incur a \",(selectedPosition===null||selectedPosition===void 0?void 0:selectedPosition.lock_period)===30?'1.5%':(selectedPosition===null||selectedPosition===void 0?void 0:selectedPosition.lock_period)===60?'1.0%':'0.5%',\" fee deducted from your principal.\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"withdraw-form\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount to withdraw\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"deposit-input\",placeholder:\"Max: \".concat((selectedPosition===null||selectedPosition===void 0?void 0:selectedPosition.balance)||0,\" \").concat((selectedPosition===null||selectedPosition===void 0?void 0:selectedPosition.symbol)||''),max:(selectedPosition===null||selectedPosition===void 0?void 0:selectedPosition.balance)||0}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-secondary-btn\",onClick:e=>{const input=e.target.previousElementSibling;input.value=(selectedPosition===null||selectedPosition===void 0?void 0:selectedPosition.balance)||0;},children:\"Max\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-cta-btn\",onClick:async e=>{try{const amount=parseFloat(e.target.parentElement.querySelector('input').value);if(!amount||amount<=0){alert('Please enter a valid amount');return;}const userId=getUserId();if(!userId){toast.error('Please log in first');return;}const response=await axios.post(\"\".concat(API,\"/api/savings/withdraw\"),{user_id:userId,coin:selectedPosition.symbol,amount:amount});if(response.data.success){const withdrawal=response.data.withdrawal;if(withdrawal.penalty_applied>0){alert(\"Withdrawal completed. Penalty applied: \".concat(withdrawal.penalty_applied.toFixed(6),\" \").concat(selectedPosition.symbol,\" (\").concat(withdrawal.penalty_percentage.toFixed(1),\"%)\"));}else{alert('Withdrawal completed successfully!');}setShowWithdrawModal(false);loadSavingsData();}}catch(error){var _error$response2,_error$response2$data;alert('Withdrawal failed: '+(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||error.message));}},children:\"Confirm Withdrawal\"})]})]})}),showAddModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowAddModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content glassmorphic-card\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Add \",selectedPosition===null||selectedPosition===void 0?void 0:selectedPosition.symbol]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close-btn\",onClick:()=>setShowAddModal(false),children:\"\\u2715\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Add more to your notice account deposit to increase your earnings\"})]})}),showHistoryModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowHistoryModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content glassmorphic-card modal-large\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Interest History - \",selectedPosition===null||selectedPosition===void 0?void 0:selectedPosition.symbol]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close-btn\",onClick:()=>setShowHistoryModal(false),children:\"\\u2715\"}),/*#__PURE__*/_jsx(\"div\",{className:\"history-list\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No interest history yet\"})})]})}),showNoticeRulesModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowNoticeRulesModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content glassmorphic-card modal-large\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Notice Rules & Early Withdrawal Penalties\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close-btn\",onClick:()=>setShowNoticeRulesModal(false),children:\"\\u2715\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"notice-rules-content\",style:{padding:'20px 0',lineHeight:'1.8'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{color:'var(--accent)',marginTop:'0'},children:\"How Notice Accounts Work\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"When you deposit into a savings vault, you choose a \",/*#__PURE__*/_jsx(\"strong\",{children:\"notice period\"}),\" (30, 60, or 90 days). Your funds are locked for this duration for secure storage.\"]}),/*#__PURE__*/_jsx(\"h4\",{style:{color:'var(--accent)',marginTop:'24px'},children:\"Interest Rates\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"30-day lock:\"}),\" 1.5% early withdrawal fee\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"60-day lock:\"}),\" 1.0% early withdrawal fee\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"90-day lock:\"}),\" 0.5% early withdrawal fee\"]})]}),/*#__PURE__*/_jsx(\"h4\",{style:{color:'var(--accent)',marginTop:'24px'},children:\"Early Withdrawal Penalties (OPTION A)\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#ff6b6b',fontWeight:600},children:\"If you withdraw before the lock period ends:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"30-day lock:\"}),\" 2% penalty on principal + forfeit 100% interest\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"60-day lock:\"}),\" 1.0% fee deducted from principal\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"90-day lock:\"}),\" 5% penalty on principal + forfeit 100% interest\"]})]}),/*#__PURE__*/_jsx(\"h4\",{style:{color:'var(--accent)',marginTop:'24px'},children:\"Important Notes\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2705 Your principal is \",/*#__PURE__*/_jsx(\"strong\",{children:\"NEVER lost\"}),\" (you only pay a small percentage)\"]}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2705 Penalty is taken from the withdrawal amount, not your total balance\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2705 After the lock period ends, withdraw anytime without penalty\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2705 Interest is calculated daily and paid at maturity\"})]}),/*#__PURE__*/_jsx(\"h4\",{style:{color:'var(--accent)',marginTop:'24px'},children:\"Example\"}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'rgba(19, 215, 255, 0.1)',padding:'16px',borderRadius:'8px',border:'1px solid var(--border)'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Scenario:\"}),\" You deposit 1 BTC in a 30-day lock\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"After 15 days:\"}),\" You earned 0.05 BTC interest\"]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Early withdrawal:\"})}),/*#__PURE__*/_jsxs(\"ul\",{style:{marginLeft:'20px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"Penalty: 1 BTC \\xD7 2% = 0.02 BTC\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Forfeit interest: 0.05 BTC\"}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"You receive:\"}),\" 0.98 BTC\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Platform keeps:\"}),\" 0.07 BTC (penalty + interest)\"]})]})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-cta-btn\",onClick:()=>setShowNoticeRulesModal(false),style:{marginTop:'24px'},children:\"Got it\"})]})})]});};export default SavingsVault;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}