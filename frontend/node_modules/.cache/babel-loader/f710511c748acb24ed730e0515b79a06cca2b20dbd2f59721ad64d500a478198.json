{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{IoAdd,IoNotifications,IoNotificationsOff,IoTrash,IoTrendingDown,IoTrendingUp}from'react-icons/io5';import{toast}from'sonner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL;const COINS=['BTC','ETH','USDT','BNB','SOL','XRP','LTC'];const THRESHOLDS=[5,10,15,20,25];export default function PriceAlerts(){const[alerts,setAlerts]=useState([]);const[loading,setLoading]=useState(true);const[showAddModal,setShowAddModal]=useState(false);const[newAlert,setNewAlert]=useState({coin:'BTC',threshold:5,direction:'up'});useEffect(()=>{fetchAlerts();},[]);const fetchAlerts=async()=>{try{const userId=localStorage.getItem('user_id');if(!userId)return;const response=await axios.get(\"\".concat(BACKEND_URL,\"/api/price-alerts/user/\").concat(userId));if(response.data.success){setAlerts(response.data.alerts);}}catch(error){console.error('Failed to fetch alerts:',error);}finally{setLoading(false);}};const createAlert=async()=>{try{const userId=localStorage.getItem('user_id');const response=await axios.post(\"\".concat(BACKEND_URL,\"/api/price-alerts/create\"),_objectSpread({user_id:userId},newAlert));if(response.data.success){toast.success('Price alert created!');setShowAddModal(false);fetchAlerts();}else{toast.error(response.data.error||'Failed to create alert');}}catch(error){toast.error('Failed to create alert');}};const toggleAlert=async(alertId,currentState)=>{try{const userId=localStorage.getItem('user_id');const response=await axios.patch(\"\".concat(BACKEND_URL,\"/api/price-alerts/\").concat(alertId,\"/toggle\"),{user_id:userId,enabled:!currentState});if(response.data.success){toast.success(\"Alert \".concat(!currentState?'enabled':'disabled'));fetchAlerts();}}catch(error){toast.error('Failed to toggle alert');}};const deleteAlert=async alertId=>{try{const userId=localStorage.getItem('user_id');const response=await axios.delete(\"\".concat(BACKEND_URL,\"/api/price-alerts/\").concat(alertId,\"?user_id=\").concat(userId));if(response.data.success){toast.success('Alert deleted');fetchAlerts();}}catch(error){toast.error('Failed to delete alert');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{padding:'2rem',textAlign:'center',color:'#888'},children:\"Loading alerts...\"});}return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,fontSize:'20px',fontWeight:'700',color:'#00F0FF'},children:\"Price Alerts\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0.5rem 0 0',fontSize:'14px',color:'#888'},children:\"Get notified when prices move by your chosen percentage\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAddModal(true),style:{padding:'0.75rem 1.5rem',background:'linear-gradient(135deg, #00F0FF, #A855F7)',border:'none',borderRadius:'8px',color:'#000',fontWeight:'700',cursor:'pointer',display:'flex',alignItems:'center',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(IoAdd,{size:18}),\"New Alert\"]})]}),alerts.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{padding:'3rem',textAlign:'center',background:'rgba(0, 0, 0, 0.2)',borderRadius:'12px',border:'1px solid rgba(255, 255, 255, 0.1)'},children:[/*#__PURE__*/_jsx(IoNotifications,{size:48,color:\"#444\",style:{marginBottom:'1rem'}}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#888',fontSize:'16px',margin:0},children:\"No price alerts set up yet\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',fontSize:'14px',marginTop:'0.5rem'},children:\"Create your first alert to get notified of price movements\"})]}):/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gap:'1rem'},children:alerts.map(alert=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:'1.25rem',background:'rgba(0, 0, 0, 0.3)',border:\"1px solid \".concat(alert.enabled?'rgba(0, 240, 255, 0.3)':'rgba(255, 255, 255, 0.1)'),borderRadius:'12px',display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'48px',height:'48px',borderRadius:'50%',background:alert.direction==='up'?'rgba(34, 197, 94, 0.2)':'rgba(239, 68, 68, 0.2)',display:'flex',alignItems:'center',justifyContent:'center'},children:alert.direction==='up'?/*#__PURE__*/_jsx(IoTrendingUp,{size:24,color:\"#22C55E\"}):/*#__PURE__*/_jsx(IoTrendingDown,{size:24,color:\"#EF4444\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.75rem',marginBottom:'0.25rem'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:0,fontSize:'18px',fontWeight:'700',color:'#E2E8F0'},children:alert.coin}),/*#__PURE__*/_jsxs(\"span\",{style:{padding:'0.25rem 0.75rem',background:alert.direction==='up'?'rgba(34, 197, 94, 0.2)':'rgba(239, 68, 68, 0.2)',color:alert.direction==='up'?'#22C55E':'#EF4444',borderRadius:'6px',fontSize:'13px',fontWeight:'700'},children:[alert.direction==='up'?'↑':'↓',\" \",alert.threshold,\"%\"]})]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:0,fontSize:'13px',color:'#888'},children:[\"Triggered \",alert.triggered_count,\" times\",alert.last_triggered_at&&\" \\u2022 Last: \".concat(new Date(alert.last_triggered_at).toLocaleDateString())]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.75rem'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>toggleAlert(alert.alert_id,alert.enabled),style:{padding:'0.5rem',background:'none',border:'none',cursor:'pointer',color:alert.enabled?'#00F0FF':'#666'},title:alert.enabled?'Disable alert':'Enable alert',children:alert.enabled?/*#__PURE__*/_jsx(IoNotifications,{size:20}):/*#__PURE__*/_jsx(IoNotificationsOff,{size:20})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteAlert(alert.alert_id),style:{padding:'0.5rem',background:'none',border:'none',cursor:'pointer',color:'#EF4444'},title:\"Delete alert\",children:/*#__PURE__*/_jsx(IoTrash,{size:20})})]})]},alert.alert_id))}),showAddModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.8)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #0F172A, #1E293B)',border:'2px solid rgba(0, 240, 255, 0.3)',borderRadius:'16px',padding:'2rem',maxWidth:'500px',width:'90%'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 1.5rem',fontSize:'24px',fontWeight:'700',color:'#00F0FF'},children:\"Create Price Alert\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'0.5rem',color:'#888',fontSize:'14px',fontWeight:'600'},children:\"Coin\"}),/*#__PURE__*/_jsx(\"select\",{value:newAlert.coin,onChange:e=>setNewAlert(_objectSpread(_objectSpread({},newAlert),{},{coin:e.target.value})),style:{width:'100%',padding:'0.75rem',background:'rgba(0, 0, 0, 0.5)',border:'1px solid rgba(255, 255, 255, 0.1)',borderRadius:'8px',color:'#fff',fontSize:'16px'},children:COINS.map(coin=>/*#__PURE__*/_jsx(\"option\",{value:coin,children:coin},coin))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'0.5rem',color:'#888',fontSize:'14px',fontWeight:'600'},children:\"Direction\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'0.75rem'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setNewAlert(_objectSpread(_objectSpread({},newAlert),{},{direction:'up'})),style:{flex:1,padding:'0.75rem',background:newAlert.direction==='up'?'rgba(34, 197, 94, 0.2)':'rgba(0, 0, 0, 0.3)',border:\"1px solid \".concat(newAlert.direction==='up'?'#22C55E':'rgba(255, 255, 255, 0.1)'),borderRadius:'8px',color:newAlert.direction==='up'?'#22C55E':'#888',fontWeight:'700',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(IoTrendingUp,{size:18}),\"Price Up\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setNewAlert(_objectSpread(_objectSpread({},newAlert),{},{direction:'down'})),style:{flex:1,padding:'0.75rem',background:newAlert.direction==='down'?'rgba(239, 68, 68, 0.2)':'rgba(0, 0, 0, 0.3)',border:\"1px solid \".concat(newAlert.direction==='down'?'#EF4444':'rgba(255, 255, 255, 0.1)'),borderRadius:'8px',color:newAlert.direction==='down'?'#EF4444':'#888',fontWeight:'700',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(IoTrendingDown,{size:18}),\"Price Down\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2rem'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'0.5rem',color:'#888',fontSize:'14px',fontWeight:'600'},children:\"Threshold\"}),/*#__PURE__*/_jsx(\"select\",{value:newAlert.threshold,onChange:e=>setNewAlert(_objectSpread(_objectSpread({},newAlert),{},{threshold:Number(e.target.value)})),style:{width:'100%',padding:'0.75rem',background:'rgba(0, 0, 0, 0.5)',border:'1px solid rgba(255, 255, 255, 0.1)',borderRadius:'8px',color:'#fff',fontSize:'16px'},children:THRESHOLDS.map(threshold=>/*#__PURE__*/_jsxs(\"option\",{value:threshold,children:[threshold,\"%\"]},threshold))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'0.75rem'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAddModal(false),style:{flex:1,padding:'0.75rem',background:'rgba(255, 255, 255, 0.1)',border:'none',borderRadius:'8px',color:'#888',fontWeight:'700',cursor:'pointer'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:createAlert,style:{flex:1,padding:'0.75rem',background:'linear-gradient(135deg, #00F0FF, #A855F7)',border:'none',borderRadius:'8px',color:'#000',fontWeight:'700',cursor:'pointer'},children:\"Create Alert\"})]})]})})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}