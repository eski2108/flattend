{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{toast}from'sonner';import{IoAdd,IoCopy,IoRefresh as RefreshCw,IoTrendingDown as TrendingDown,IoTrendingUp as TrendingUp,IoWallet as Wallet}from'react-icons/io5';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL;export default function AdminPlatformWallet(){var _stats$total_referral,_stats$total_referral2,_stats$total_bonus_pa,_stats$total_bonus_pa2;const[balances,setBalances]=useState({});const[totalGBPEquivalent,setTotalGBPEquivalent]=useState(0);const[stats,setStats]=useState({});const[warnings,setWarnings]=useState([]);const[transactions,setTransactions]=useState([]);const[depositAddresses,setDepositAddresses]=useState({});const[showTopUpModal,setShowTopUpModal]=useState(false);const[topUpForm,setTopUpForm]=useState({amount:'',currency:'USDT',notes:''});const[loading,setLoading]=useState(false);const supportedCoins=[{symbol:'BTC',name:'Bitcoin',icon:'₿'},{symbol:'ETH',name:'Ethereum',icon:'Ξ'},{symbol:'USDT',name:'Tether',icon:'₮'},{symbol:'BNB',name:'Binance Coin',icon:'B'},{symbol:'SOL',name:'Solana',icon:'S'},{symbol:'XRP',name:'Ripple',icon:'X'},{symbol:'LTC',name:'Litecoin',icon:'Ł'}];useEffect(()=>{fetchWalletData();fetchDepositAddresses();const interval=setInterval(fetchWalletData,30000);// Refresh every 30s\nreturn()=>clearInterval(interval);},[]);const fetchWalletData=async()=>{try{const response=await axios.get(\"\".concat(BACKEND_URL,\"/api/admin/platform-wallet/balance\"));if(response.data.success){setBalances(response.data.balances);setTotalGBPEquivalent(response.data.total_gbp_equivalent);setStats(response.data.stats);setWarnings(response.data.active_warnings||[]);}}catch(error){console.error('Failed to fetch wallet balance:',error);}};const fetchDepositAddresses=async()=>{try{const addresses={};for(const coin of supportedCoins){const response=await axios.get(\"\".concat(BACKEND_URL,\"/api/admin/platform-wallet/deposit-address/\").concat(coin.symbol));if(response.data.success){addresses[coin.symbol]=response.data.address;}}setDepositAddresses(addresses);}catch(error){console.error('Failed to fetch deposit addresses:',error);}};const fetchTransactions=async()=>{try{const response=await axios.get(\"\".concat(BACKEND_URL,\"/api/admin/platform-wallet/transactions?limit=50\"));if(response.data.success){setTransactions(response.data.transactions);}}catch(error){console.error('Failed to fetch transactions:',error);}};const handleManualTopUp=async()=>{try{setLoading(true);const response=await axios.post(\"\".concat(BACKEND_URL,\"/api/admin/platform-wallet/top-up\"),{amount:parseFloat(topUpForm.amount),currency:topUpForm.currency,admin_user_id:'ADMIN',notes:topUpForm.notes});if(response.data.success){toast.success(\"Platform wallet topped up with \".concat(topUpForm.amount,\" \").concat(topUpForm.currency));setShowTopUpModal(false);setTopUpForm({amount:'',currency:'USDT',notes:''});fetchWalletData();fetchTransactions();}}catch(error){console.error('Failed to top up wallet:',error);toast.error('Failed to top up wallet');}finally{setLoading(false);}};const copyToClipboard=text=>{navigator.clipboard.writeText(text);toast.success('Address copied to clipboard!');};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'2rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'2rem'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:'28px',fontWeight:'900',color:'#00F0FF',marginBottom:'0.5rem'},children:\"Admin Top-Up Wallet\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#888',fontSize:'14px'},children:\"Central treasury for all platform operations: referral bonuses, commissions, liquidity, fees\"})]}),warnings.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'2rem'},children:warnings.map(warning=>{var _warning$gbp_equivale;return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'1rem 1.5rem',background:warning.level==='critical'?'rgba(239, 68, 68, 0.1)':'rgba(251, 146, 60, 0.1)',border:\"2px solid \".concat(warning.level==='critical'?'#EF4444':'#FB923C'),borderRadius:'12px',display:'flex',alignItems:'center',gap:'1rem',marginBottom:'0.75rem'},children:[/*#__PURE__*/_jsx(AlertTriangle,{size:24,color:warning.level==='critical'?'#EF4444':'#FB923C'}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsxs(\"p\",{style:{margin:0,fontWeight:'700',color:warning.level==='critical'?'#EF4444':'#FB923C'},children:[warning.level==='critical'?'CRITICAL':'WARNING',\": Low Balance Alert\"]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0.25rem 0 0',fontSize:'14px',color:'#E2E8F0'},children:[warning.currency,\" balance: \",warning.balance,\" (\\xA3\",(_warning$gbp_equivale=warning.gbp_equivalent)===null||_warning$gbp_equivale===void 0?void 0:_warning$gbp_equivale.toFixed(2),\" equivalent)\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>toast.info('Top up required'),style:{padding:'0.5rem 1rem',background:warning.level==='critical'?'#EF4444':'#FB923C',border:'none',borderRadius:'6px',color:'#fff',fontWeight:'700',cursor:'pointer'},children:\"Top Up Now\"})]},warning.warning_id);})}),/*#__PURE__*/_jsx(\"div\",{style:{background:'linear-gradient(135deg, rgba(0, 240, 255, 0.15), rgba(168, 85, 247, 0.15))',border:'2px solid rgba(0, 240, 255, 0.3)',borderRadius:'16px',padding:'2rem',marginBottom:'2rem'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,color:'#888',fontSize:'14px',fontWeight:'600'},children:\"Total Platform Balance\"}),/*#__PURE__*/_jsxs(\"h2\",{style:{margin:'0.5rem 0 0',fontSize:'36px',fontWeight:'900',color:'#00F0FF'},children:[\"\\xA3\",totalGBPEquivalent.toLocaleString('en-GB',{minimumFractionDigits:2,maximumFractionDigits:2})]}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0.5rem 0 0',color:'#888',fontSize:'13px'},children:\"GBP Equivalent \\u2022 Updated every 30 seconds\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowTopUpModal(true),style:{padding:'1rem 2rem',background:'linear-gradient(135deg, #00F0FF, #A855F7)',border:'none',borderRadius:'12px',color:'#000',fontWeight:'900',fontSize:'16px',cursor:'pointer',display:'flex',alignItems:'center',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(IoAdd,{size:20}),\"Manual Top-Up\"]})]})}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(300px, 1fr))',gap:'1.5rem',marginBottom:'3rem'},children:supportedCoins.map(coin=>{const balance=balances[coin.symbol]||0;const isLow=balance<10;// Simple threshold for demo\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{background:'rgba(0, 0, 0, 0.3)',border:\"2px solid \".concat(isLow?'#EF4444':'rgba(0, 240, 255, 0.2)'),borderRadius:'12px',padding:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.75rem',marginBottom:'1rem'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'40px',height:'40px',borderRadius:'50%',background:'linear-gradient(135deg, #00F0FF, #A855F7)',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'20px',fontWeight:'900'},children:coin.icon}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,fontSize:'16px',fontWeight:'700',color:'#E2E8F0'},children:coin.name}),/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontSize:'12px',color:'#888'},children:coin.symbol})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1rem'},children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontSize:'28px',fontWeight:'900',color:isLow?'#EF4444':'#00F0FF'},children:balance.toLocaleString('en-GB',{minimumFractionDigits:4,maximumFractionDigits:8})}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0.25rem 0 0',fontSize:'12px',color:'#888'},children:[coin.symbol,\" Available\"]})]}),depositAddresses[coin.symbol]&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'rgba(0, 240, 255, 0.05)',border:'1px solid rgba(0, 240, 255, 0.2)',borderRadius:'8px',padding:'0.75rem',marginBottom:'1rem'},children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:'0 0 0.5rem',fontSize:'11px',color:'#888',fontWeight:'600'},children:\"DEPOSIT ADDRESS:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontSize:'11px',color:'#00F0FF',fontFamily:'monospace',wordBreak:'break-all',flex:1},children:depositAddresses[coin.symbol]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>copyToClipboard(depositAddresses[coin.symbol]),style:{background:'rgba(0, 240, 255, 0.2)',border:'none',borderRadius:'6px',padding:'0.5rem',cursor:'pointer',display:'flex',alignItems:'center'},children:/*#__PURE__*/_jsx(IoCopy,{size:14,color:\"#00F0FF\"})})]})]}),isLow&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'rgba(239, 68, 68, 0.1)',border:'1px solid rgba(239, 68, 68, 0.3)',borderRadius:'6px',padding:'0.5rem 0.75rem',display:'flex',alignItems:'center',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(AlertTriangle,{size:14,color:\"#EF4444\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px',color:'#EF4444',fontWeight:'600'},children:\"Low Balance - Top Up Required\"})]})]},coin.symbol);})}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'rgba(0, 0, 0, 0.3)',border:'1px solid rgba(0, 240, 255, 0.2)',borderRadius:'12px',padding:'2rem',marginBottom:'2rem'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 1.5rem',fontSize:'20px',fontWeight:'700',color:'#00F0FF'},children:\"Platform Wallet Usage\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'2rem'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontSize:'12px',color:'#888',fontWeight:'600',textTransform:'uppercase'},children:\"Referral Payouts\"}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0.5rem 0 0',fontSize:'24px',fontWeight:'900',color:'#22C55E'},children:[\"\\xA3\",(((_stats$total_referral=stats.total_referral_payouts)===null||_stats$total_referral===void 0?void 0:(_stats$total_referral2=_stats$total_referral[0])===null||_stats$total_referral2===void 0?void 0:_stats$total_referral2.total)||0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontSize:'12px',color:'#888',fontWeight:'600',textTransform:'uppercase'},children:\"Bonus Payouts\"}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0.5rem 0 0',fontSize:'24px',fontWeight:'900',color:'#A855F7'},children:[\"\\xA3\",(((_stats$total_bonus_pa=stats.total_bonus_payouts)===null||_stats$total_bonus_pa===void 0?void 0:(_stats$total_bonus_pa2=_stats$total_bonus_pa[0])===null||_stats$total_bonus_pa2===void 0?void 0:_stats$total_bonus_pa2.total)||0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontSize:'12px',color:'#888',fontWeight:'600',textTransform:'uppercase'},children:\"Liquidity Deployed\"}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0.5rem 0 0',fontSize:'24px',fontWeight:'900',color:'#3B82F6'},children:[\"$\",Object.values(stats.total_liquidity||{}).reduce((a,b)=>a+b,0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontSize:'12px',color:'#888',fontWeight:'600',textTransform:'uppercase'},children:\"Withdrawal Fees Collected\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0.5rem 0 0',fontSize:'24px',fontWeight:'900',color:'#00F0FF'},children:\"3% on All Withdrawals\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'rgba(0, 240, 255, 0.05)',border:'1px solid rgba(0, 240, 255, 0.2)',borderRadius:'12px',padding:'1.5rem',marginTop:'2rem'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 1rem',color:'#00F0FF',fontSize:'16px',fontWeight:'700'},children:\"\\uD83D\\uDCA1 Admin Top-Up Wallet Powers Everything\"}),/*#__PURE__*/_jsxs(\"ul\",{style:{margin:0,paddingLeft:'1.5rem',color:'#888',fontSize:'14px',lineHeight:'1.8'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"Paying \\xA320 referral bonuses when users top up \\u2265\\xA3150\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Paying 20% lifetime commissions to referrers\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Receiving all 3% withdrawal fees automatically\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Funding trading liquidity for Spot Trading\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Funding Express Buy / Instant Buy platform liquidity\"}),/*#__PURE__*/_jsx(\"li\",{children:\"All internal platform operations and payouts\"})]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'1rem 0 0',color:'#888',fontSize:'13px'},children:[\"\\uD83D\\uDD12 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Privacy:\"}),\" This wallet is completely private. No user can ever see these balances. Only visible in Admin Dashboard.\"]})]}),showTopUpModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.9)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999},onClick:()=>setShowTopUpModal(false),children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #0F172A, #1E293B)',border:'2px solid rgba(0, 240, 255, 0.3)',borderRadius:'16px',padding:'2rem',maxWidth:'500px',width:'90%'},onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 1.5rem',fontSize:'24px',fontWeight:'900',color:'#00F0FF'},children:\"Manual Top-Up\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1rem'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'0.5rem',color:'#888',fontSize:'14px',fontWeight:'600'},children:\"Currency\"}),/*#__PURE__*/_jsx(\"select\",{value:topUpForm.currency,onChange:e=>setTopUpForm(_objectSpread(_objectSpread({},topUpForm),{},{currency:e.target.value})),style:{width:'100%',padding:'0.75rem',background:'rgba(0, 0, 0, 0.5)',border:'1px solid rgba(255, 255, 255, 0.1)',borderRadius:'8px',color:'#fff',fontSize:'14px'},children:supportedCoins.map(coin=>/*#__PURE__*/_jsxs(\"option\",{value:coin.symbol,children:[coin.name,\" (\",coin.symbol,\")\"]},coin.symbol))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1rem'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'0.5rem',color:'#888',fontSize:'14px',fontWeight:'600'},children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.00000001\",value:topUpForm.amount,onChange:e=>setTopUpForm(_objectSpread(_objectSpread({},topUpForm),{},{amount:e.target.value})),placeholder:\"Enter amount\",style:{width:'100%',padding:'0.75rem',background:'rgba(0, 0, 0, 0.5)',border:'1px solid rgba(255, 255, 255, 0.1)',borderRadius:'8px',color:'#fff',fontSize:'14px'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'0.5rem',color:'#888',fontSize:'14px',fontWeight:'600'},children:\"Notes (Optional)\"}),/*#__PURE__*/_jsx(\"textarea\",{value:topUpForm.notes,onChange:e=>setTopUpForm(_objectSpread(_objectSpread({},topUpForm),{},{notes:e.target.value})),placeholder:\"Add notes about this top-up...\",rows:3,style:{width:'100%',padding:'0.75rem',background:'rgba(0, 0, 0, 0.5)',border:'1px solid rgba(255, 255, 255, 0.1)',borderRadius:'8px',color:'#fff',fontSize:'14px',resize:'vertical'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'1rem'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowTopUpModal(false),style:{flex:1,padding:'0.75rem',background:'rgba(255, 255, 255, 0.1)',border:'none',borderRadius:'8px',color:'#fff',fontWeight:'600',cursor:'pointer'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleManualTopUp,disabled:loading||!topUpForm.amount,style:{flex:1,padding:'0.75rem',background:loading?'#666':'linear-gradient(135deg, #00F0FF, #A855F7)',border:'none',borderRadius:'8px',color:'#000',fontWeight:'900',cursor:loading?'not-allowed':'pointer'},children:loading?'Processing...':'Top Up Wallet'})]})]})})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}