"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8783],{8783:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});var a=t(5043),l=t(8163),r=t(9722),d=t(6328),i=t(1817),n=t(221),o=t(579);const c="https://nowpay-debug.preview.emergentagent.com";function x(){var e,s,t;const{disputeId:x}=(0,l.g)(),m=(0,l.Zp)(),[p,h]=(0,a.useState)(null),[u,b]=(0,a.useState)(null),[g,j]=(0,a.useState)([]),[N,y]=(0,a.useState)(!0),[v,f]=(0,a.useState)(""),[w,_]=(0,a.useState)(""),[k,C]=(0,a.useState)(!1),[S,D]=(0,a.useState)("");(0,a.useEffect)(()=>{R();const e=setInterval(R,1e4);return()=>clearInterval(e)},[x]);const R=async()=>{try{const e=await r.A.get("".concat(c,"/api/p2p/disputes/").concat(x));if(e.data.success&&(h(e.data.dispute),j(e.data.dispute.messages||[]),e.data.dispute.trade_id)){const s=await r.A.get("".concat(c,"/api/p2p/trade/").concat(e.data.dispute.trade_id));s.data.success&&b(s.data.trade)}}catch(e){console.error("Error loading dispute:",e),d.oR.error("Failed to load dispute details")}finally{y(!1)}},A=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";if(v.trim())try{if((await r.A.post("".concat(c,"/api/p2p/disputes/").concat(x,"/message"),{sender_id:"admin",sender_type:"admin",message:v,recipient:e})).data.success){f(""),R();const s="all"===e?"both parties":e;d.oR.success("Message sent to ".concat(s))}}catch(s){console.error("Error sending message:",s),d.oR.error("Failed to send message")}};return N?(0,o.jsx)(i.A,{children:(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-purple-950 to-slate-900 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center text-white",children:[(0,o.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-cyan-400 border-t-transparent rounded-full mx-auto mb-4"}),(0,o.jsx)("p",{children:"Loading dispute..."})]})})}):p?(0,o.jsx)(i.A,{children:(0,o.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-purple-950 to-slate-900 p-4 md:p-6",children:[(0,o.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsxs)("button",{onClick:()=>m("/admin/disputes"),className:"flex items-center gap-2 text-cyan-400 hover:text-cyan-300 mb-4 transition-colors",children:[(0,o.jsx)(n.NEn,{})," Back to All Disputes"]}),(0,o.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-white mb-2",children:"\ud83d\udea8 Dispute Detail"}),(0,o.jsxs)("p",{className:"text-gray-400 text-sm",children:["ID: ",p.dispute_id]})]}),(0,o.jsxs)("button",{onClick:()=>{const e="".concat(window.location.origin,"/admin/disputes/").concat(x);navigator.clipboard.writeText(e),d.oR.success("Dispute link copied to clipboard")},className:"flex items-center gap-2 bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg transition-colors",children:[(0,o.jsx)(n.iyF,{className:"w-4 h-4"}),"Copy Shareable Link"]})]})]}),(0,o.jsx)("div",{className:"mb-6 p-4 rounded-xl border-2 ".concat("resolved"===p.status?"bg-green-500/10 border-green-500":"bg-red-500/10 border-red-500"),children:(0,o.jsxs)("div",{className:"flex items-center gap-3",children:["resolved"===p.status?(0,o.jsx)(n.G3G,{className:"w-8 h-8 text-green-400"}):(0,o.jsx)(n.tr_,{className:"w-8 h-8 text-red-400"}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("p",{className:"text-white font-bold text-lg",children:["Status: ",null===(e=p.status)||void 0===e?void 0:e.toUpperCase()]}),(0,o.jsxs)("p",{className:"text-gray-300 text-sm",children:["Created: ",new Date(p.created_at).toLocaleString()]})]})]})}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6",children:[(0,o.jsxs)("div",{className:"lg:col-span-2 space-y-4 md:space-y-6",children:[(0,o.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4 md:p-6",children:[(0,o.jsxs)("h2",{className:"text-lg md:text-xl font-bold text-white mb-3 md:mb-4 flex items-center gap-2",children:[(0,o.jsx)(n.mk,{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-400"}),"Trade Information"]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4",children:[(0,o.jsxs)("div",{className:"bg-slate-900/50 p-3 rounded-lg",children:[(0,o.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Order ID"}),(0,o.jsx)("p",{className:"text-white font-mono text-xs break-all",children:p.trade_id||"N/A"})]}),(0,o.jsxs)("div",{className:"bg-slate-900/50 p-3 rounded-lg",children:[(0,o.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Fiat Amount"}),(0,o.jsxs)("p",{className:"text-white font-semibold text-sm",children:[p.fiat_amount||p.amount||"0"," ",p.fiat_currency||p.currency||"GBP"]})]}),(0,o.jsxs)("div",{className:"bg-orange-500/10 border border-orange-500/30 p-3 rounded-lg",children:[(0,o.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Crypto in Escrow"}),(0,o.jsxs)("p",{className:"text-orange-400 font-semibold text-sm",children:[p.amount||(null===u||void 0===u?void 0:u.crypto_amount)||"0"," ",p.currency||(null===u||void 0===u?void 0:u.crypto_currency)||"BTC"]})]}),(0,o.jsxs)("div",{className:"bg-slate-900/50 p-3 rounded-lg",children:[(0,o.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Trade Status"}),(0,o.jsx)("p",{className:"text-white capitalize text-sm",children:null===(s=(null===u||void 0===u?void 0:u.status)||p.trade_status||"pending")||void 0===s?void 0:s.replace(/_/g," ")})]})]})]}),(0,o.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4 md:p-6",children:[(0,o.jsx)("h2",{className:"text-lg md:text-xl font-bold text-white mb-3 md:mb-4",children:"Dispute Reason"}),(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsxs)("div",{className:"bg-slate-900/50 p-3 rounded-lg",children:[(0,o.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Reason"}),(0,o.jsx)("p",{className:"text-orange-400 font-semibold capitalize text-sm",children:(null===(t=p.reason)||void 0===t?void 0:t.replace(/_/g," "))||"Not specified"})]}),(0,o.jsxs)("div",{className:"bg-slate-900/50 p-3 rounded-lg",children:[(0,o.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Initiated By"}),(0,o.jsx)("p",{className:"text-white capitalize text-sm",children:p.initiated_by||"Unknown"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-gray-400 text-xs mb-2",children:"Description"}),(0,o.jsx)("div",{className:"bg-slate-900/50 border border-slate-700 rounded-lg p-3",children:(0,o.jsx)("p",{className:"text-white text-sm",children:p.description||"No description provided"})})]})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4",children:[(0,o.jsxs)("div",{className:"bg-cyan-500/10 border-2 border-cyan-500/30 rounded-xl p-3 md:p-4",children:[(0,o.jsxs)("h3",{className:"text-cyan-400 font-bold mb-2 flex items-center gap-2 text-sm",children:[(0,o.jsx)(n.eeu,{className:"w-4 h-4 md:w-5 md:h-5"}),"Buyer"]}),(0,o.jsx)("p",{className:"text-white font-mono text-xs break-all",children:p.buyer_id||"N/A"})]}),(0,o.jsxs)("div",{className:"bg-purple-500/10 border-2 border-purple-500/30 rounded-xl p-3 md:p-4",children:[(0,o.jsxs)("h3",{className:"text-purple-400 font-bold mb-2 flex items-center gap-2 text-sm",children:[(0,o.jsx)(n.eeu,{className:"w-4 h-4 md:w-5 md:h-5"}),"Seller"]}),(0,o.jsx)("p",{className:"text-white font-mono text-xs break-all",children:p.seller_id||"N/A"})]})]}),(0,o.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4 md:p-6",children:[(0,o.jsxs)("h2",{className:"text-lg md:text-xl font-bold text-white mb-3 md:mb-4 flex items-center gap-2",children:[(0,o.jsx)(n.mNJ,{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-400"}),"Messages & Evidence"]}),(0,o.jsx)("div",{className:"space-y-3 mb-4 max-h-96 overflow-y-auto",children:0===g.length?(0,o.jsx)("p",{className:"text-gray-500 text-center py-8 text-sm",children:"No messages yet"}):g.map((e,s)=>(0,o.jsxs)("div",{className:"p-3 rounded-lg ".concat("admin"===e.sender_type?"bg-purple-600/20 border border-purple-500/30 ml-4 md:ml-8":"bg-slate-900/50 border border-slate-700 mr-4 md:mr-8"),children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:["admin"===e.sender_type&&(0,o.jsx)(n.eeu,{className:"w-4 h-4 text-purple-400"}),(0,o.jsx)("span",{className:"text-xs md:text-sm font-semibold text-white capitalize",children:e.sender_type}),e.recipient&&"all"!==e.recipient&&(0,o.jsxs)("span",{className:"text-xs bg-orange-500/20 text-orange-300 px-2 py-0.5 rounded",children:["To: ",e.recipient]}),(0,o.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.timestamp).toLocaleString()})]}),(0,o.jsx)("p",{className:"text-white text-xs md:text-sm break-words",children:e.message})]},s))}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("input",{type:"text",value:v,onChange:e=>f(e.target.value),onKeyPress:e=>"Enter"===e.key&&A("all"),placeholder:"Message both parties...",className:"flex-1 min-w-0 bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 md:px-4 md:py-3 text-white text-sm focus:border-purple-500 focus:outline-none"}),(0,o.jsx)("button",{onClick:()=>A("all"),disabled:!v.trim(),className:"bg-purple-600 hover:bg-purple-700 disabled:opacity-50 text-white px-3 py-2 md:px-6 md:py-3 rounded-lg transition-colors font-semibold text-sm md:text-base whitespace-nowrap flex-shrink-0",children:"Send to All"})]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("button",{onClick:()=>A("buyer"),disabled:!v.trim(),className:"flex-1 bg-cyan-600 hover:bg-cyan-700 disabled:opacity-50 text-white px-3 py-2 rounded-lg transition-colors text-xs md:text-sm font-semibold",children:"Send to Buyer Only"}),(0,o.jsx)("button",{onClick:()=>A("seller"),disabled:!v.trim(),className:"flex-1 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 text-white px-3 py-2 rounded-lg transition-colors text-xs md:text-sm font-semibold",children:"Send to Seller Only"})]})]})]})]}),(0,o.jsxs)("div",{className:"space-y-4",children:["resolved"!==p.status&&(0,o.jsxs)("div",{className:"bg-slate-800/50 border-2 border-orange-500/30 rounded-xl p-4 md:p-6",children:[(0,o.jsxs)("h3",{className:"text-lg md:text-xl font-bold text-white mb-3 md:mb-4 flex items-center gap-2",children:[(0,o.jsx)(n.tr_,{className:"w-5 h-5 md:w-6 md:h-6 text-orange-400"}),"Resolve Dispute"]}),(0,o.jsx)("p",{className:"text-gray-400 text-xs md:text-sm mb-3 md:mb-4",children:"Choose the winning party. The losing party will be charged a \xa35 dispute fee."}),(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsxs)("button",{onClick:()=>{D("buyer"),C(!0)},className:"w-full bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-700 hover:to-blue-700 text-white px-4 py-3 md:px-6 md:py-4 rounded-xl transition-all font-semibold flex items-center justify-center gap-2 text-sm md:text-base",children:[(0,o.jsx)(n.G3G,{className:"w-4 h-4 md:w-5 md:h-5"}),"Release Crypto to Buyer"]}),(0,o.jsxs)("button",{onClick:()=>{D("seller"),C(!0)},className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-4 py-3 md:px-6 md:py-4 rounded-xl transition-all font-semibold flex items-center justify-center gap-2 text-sm md:text-base",children:[(0,o.jsx)(n.G3G,{className:"w-4 h-4 md:w-5 md:h-5"}),"Return Crypto to Seller"]})]})]}),(0,o.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[(0,o.jsxs)("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[(0,o.jsx)(n.Gm4,{className:"w-6 h-6 text-cyan-400"}),"Timeline"]}),(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsxs)("div",{className:"flex items-start gap-3",children:[(0,o.jsx)("div",{className:"w-2 h-2 bg-cyan-400 rounded-full mt-2"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-white font-semibold text-sm",children:"Dispute Opened"}),(0,o.jsx)("p",{className:"text-gray-400 text-xs",children:new Date(p.created_at).toLocaleString()})]})]}),"resolved"===p.status&&p.resolved_at&&(0,o.jsxs)("div",{className:"flex items-start gap-3",children:[(0,o.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full mt-2"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-white font-semibold text-sm",children:"Dispute Resolved"}),(0,o.jsx)("p",{className:"text-gray-400 text-xs",children:new Date(p.resolved_at).toLocaleString()}),p.winner&&(0,o.jsxs)("p",{className:"text-green-400 text-xs mt-1",children:["Winner: ",p.winner]})]})]})]})]})]})]})]}),k&&(0,o.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,o.jsxs)("div",{className:"bg-slate-900 border-2 border-green-500 rounded-2xl max-w-lg w-full shadow-2xl",children:[(0,o.jsxs)("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 p-6 rounded-t-2xl",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Confirm Resolution"}),(0,o.jsx)("p",{className:"text-green-100 text-sm mt-1",children:"buyer"===S?"Release crypto to buyer":"Return crypto to seller"})]}),(0,o.jsxs)("div",{className:"p-6 space-y-4",children:[(0,o.jsx)("div",{className:"bg-orange-500/10 border-l-4 border-orange-500 p-4",children:(0,o.jsxs)("p",{className:"text-orange-300 text-sm",children:[(0,o.jsx)("strong",{children:"Warning:"})," This action cannot be undone. The losing party will be charged a \xa35 dispute fee."]})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-gray-300 font-semibold mb-2",children:"Resolution Details *"}),(0,o.jsx)("textarea",{value:w,onChange:e=>_(e.target.value),placeholder:"Explain your decision...",rows:4,className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-green-500 focus:outline-none resize-none"})]}),(0,o.jsxs)("div",{className:"flex gap-3",children:[(0,o.jsx)("button",{onClick:()=>{C(!1),D(""),_("")},className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg transition-colors font-semibold",children:"Cancel"}),(0,o.jsx)("button",{onClick:()=>(async e=>{if(w.trim())try{const s="buyer"===e?"release_to_buyer":"return_to_seller",t=await r.A.post("".concat(c,"/api/admin/disputes/").concat(x,"/resolve"),{resolution:s,admin_id:"admin",admin_note:"".concat(w," | Winner: ").concat(e)});t.data.success?(d.oR.success("Crypto ".concat("buyer"===e?"released to buyer":"returned to seller")),C(!1),_(""),D(""),R()):d.oR.error(t.data.message||"Failed to resolve dispute")}catch(a){var s,t;console.error("Error resolving dispute:",a),d.oR.error((null===(s=a.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed to resolve dispute")}else d.oR.error("Please provide resolution details")})(S),disabled:!w.trim(),className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 disabled:opacity-50 text-white px-6 py-3 rounded-lg transition-all font-semibold",children:"Confirm"})]})]})]})})]})}):(0,o.jsx)(i.A,{children:(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-purple-950 to-slate-900 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center text-white",children:[(0,o.jsx)(n.tr_,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),(0,o.jsx)("p",{className:"text-xl",children:"Dispute not found"}),(0,o.jsx)("button",{onClick:()=>m("/admin/disputes"),className:"mt-4 bg-cyan-600 hover:bg-cyan-700 px-6 py-3 rounded-lg transition-colors",children:"Back to Disputes"})]})})})}}}]);
//# sourceMappingURL=8783.eb0d356c.chunk.js.map