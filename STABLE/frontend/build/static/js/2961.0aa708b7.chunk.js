"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2961],{2961:(e,r,t)=>{t.r(r),t.d(r,{default:()=>p});var s=t(5043),a=t(8163),n=(t(1140),t(807)),i=t(221),o=t(9722),d=t(6328),l=t(579);const c="https://controlpanel-4.preview.emergentagent.com";function p(){const e=(0,a.Zp)(),[r,t]=(0,s.useState)([]),[p,g]=(0,s.useState)(null),[m,u]=(0,s.useState)([]),[x,h]=(0,s.useState)(""),[f,y]=(0,s.useState)(!0);(0,s.useEffect)(()=>{const r=localStorage.getItem("cryptobank_user");if(!r)return void e("/admin-login");if(!JSON.parse(r).is_admin)return void e("/");b();const t=setInterval(b,1e4);return()=>clearInterval(t)},[e]);const b=async()=>{try{const e=await o.A.get("".concat(c,"/admin/support-chats"));e.data.success&&t(e.data.chats)}catch(e){console.error("Failed to load chats:",e),d.oR.error("Failed to load support chats")}finally{y(!1)}},v=async e=>{try{const r=await o.A.get("".concat(c,"/admin/support-chat/").concat(e));r.data.success&&(u(r.data.messages),g(e))}catch(r){console.error("Failed to load messages:",r),d.oR.error("Failed to load messages")}},j=async()=>{if(x.trim()&&p)try{await o.A.post("".concat(c,"/admin/support-reply"),{chat_id:p,message:x}),d.oR.success("Reply sent successfully"),h(""),v(p)}catch(e){console.error("Failed to send reply:",e),d.oR.error("Failed to send reply")}},F=e=>new Date(e).toLocaleString(),k=e=>{switch(e){case"open":return"#F59E0B";case"in_progress":return"#3B82F6";case"resolved":return"#10B981";case"closed":return"#6B7280";default:return"#888"}};return f?(0,l.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff"},children:(0,l.jsx)("div",{children:"Loading support chats..."})}):(0,l.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%)",padding:"2rem"},children:(0,l.jsxs)("div",{style:{maxWidth:"1600px",margin:"0 auto"},children:[(0,l.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{style:{fontSize:"32px",fontWeight:"900",background:"linear-gradient(135deg, #00F0FF 0%, #A855F7 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginBottom:"0.5rem"},children:"Support Dashboard"}),(0,l.jsx)("p",{style:{color:"#a0a0a0",fontSize:"16px"},children:"Manage customer support chats and inquiries"})]}),(0,l.jsx)(n.$,{onClick:()=>e("/admin"),children:"Back to Admin"})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"2rem"},children:[(0,l.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.8)",border:"2px solid rgba(0, 240, 255, 0.2)",borderRadius:"16px",padding:"1.5rem",maxHeight:"80vh",overflowY:"auto"},children:[(0,l.jsxs)("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#00F0FF",marginBottom:"1rem"},children:["Active Chats (",r.length,")"]}),0===r.length?(0,l.jsx)("p",{style:{color:"#888",textAlign:"center",padding:"2rem"},children:"No support chats yet"}):r.map(e=>(0,l.jsxs)("div",{onClick:()=>v(e.chat_id),style:{background:p===e.chat_id?"rgba(0, 240, 255, 0.2)":"rgba(0, 0, 0, 0.3)",border:p===e.chat_id?"2px solid #00F0FF":"1px solid rgba(0, 240, 255, 0.1)",borderRadius:"12px",padding:"1rem",marginBottom:"1rem",cursor:"pointer",transition:"all 0.3s"},onMouseEnter:r=>{p!==e.chat_id&&(r.currentTarget.style.background="rgba(0, 240, 255, 0.1)")},onMouseLeave:r=>{p!==e.chat_id&&(r.currentTarget.style.background="rgba(0, 0, 0, 0.3)")},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,l.jsx)(i.SNd,{size:16,color:"#00F0FF"}),(0,l.jsx)("span",{style:{color:"#fff",fontWeight:"600"},children:e.user_name||"User ".concat(e.user_id.substring(0,8))})]}),(0,l.jsx)("span",{style:{background:k(e.status),color:"#000",padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"700",textTransform:"uppercase"},children:e.status})]}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#888"},children:[(0,l.jsx)(i.Gm4,{size:12,style:{display:"inline",marginRight:"4px"}}),F(e.created_at)]}),e.last_message&&(0,l.jsx)("div",{style:{fontSize:"13px",color:"#aaa",marginTop:"0.5rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.last_message})]},e.chat_id))]}),(0,l.jsx)("div",{style:{background:"rgba(26, 31, 58, 0.8)",border:"2px solid rgba(0, 240, 255, 0.2)",borderRadius:"16px",padding:"1.5rem",display:"flex",flexDirection:"column",maxHeight:"80vh"},children:p?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{style:{flex:1,overflowY:"auto",marginBottom:"1rem",padding:"1rem"},children:m.map((e,r)=>(0,l.jsx)("div",{style:{display:"flex",justifyContent:"user"===e.sender?"flex-start":"flex-end",marginBottom:"1rem"},children:(0,l.jsxs)("div",{style:{background:"user"===e.sender?"rgba(0, 240, 255, 0.2)":"rgba(168, 85, 247, 0.2)",border:"1px solid ".concat("user"===e.sender?"#00F0FF":"#A855F7"),borderRadius:"12px",padding:"0.75rem 1rem",maxWidth:"70%"},children:[(0,l.jsx)("div",{style:{fontSize:"11px",color:"#888",marginBottom:"0.25rem",fontWeight:"600"},children:"user"===e.sender?"Customer":"Support Team"}),(0,l.jsx)("div",{style:{color:"#fff",fontSize:"14px"},children:e.message}),(0,l.jsx)("div",{style:{fontSize:"10px",color:"#666",marginTop:"0.25rem",textAlign:"right"},children:F(e.created_at)})]})},r))}),(0,l.jsxs)("div",{style:{borderTop:"1px solid rgba(0, 240, 255, 0.2)",paddingTop:"1rem"},children:[(0,l.jsxs)("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:[(0,l.jsx)("textarea",{value:x,onChange:e=>h(e.target.value),placeholder:"Type your reply...",rows:3,style:{flex:1,background:"rgba(0, 0, 0, 0.4)",border:"1px solid rgba(0, 240, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",color:"#fff",fontSize:"14px",resize:"none"},onKeyPress:e=>{"Enter"===e.key&&e.ctrlKey&&j()}}),(0,l.jsxs)("button",{onClick:j,disabled:!x.trim(),style:{background:x.trim()?"linear-gradient(135deg, #00F0FF, #A855F7)":"rgba(100, 100, 100, 0.3)",border:"none",borderRadius:"8px",padding:"1rem",cursor:x.trim()?"pointer":"not-allowed",color:"#fff",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,l.jsx)(i.$_z,{size:20}),"Send"]})]}),(0,l.jsxs)("button",{onClick:()=>(async e=>{try{await o.A.post("".concat(c,"/admin/resolve-chat"),{chat_id:e}),d.oR.success("Chat marked as resolved"),b(),g(null),u([])}catch(r){console.error("Failed to resolve chat:",r),d.oR.error("Failed to resolve chat")}})(p),style:{background:"linear-gradient(135deg, #10B981, #059669)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:"700",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,l.jsx)(i.G3G,{size:16}),"Mark as Resolved"]})]})]}):(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#888",fontSize:"18px"},children:[(0,l.jsx)(i.mNJ,{size:48,style:{marginRight:"1rem"}}),"Select a chat to view messages"]})})]})]})})}}}]);
//# sourceMappingURL=2961.0aa708b7.chunk.js.map