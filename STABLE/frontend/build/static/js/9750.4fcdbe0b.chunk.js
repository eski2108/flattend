"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9750],{2264:(e,a,s)=>{s.d(a,{p:()=>c});var r=s(9379),l=s(3986),n=s(5043),t=s(9766),i=s(579);const d=["className","type"],c=n.forwardRef((e,a)=>{let{className:s,type:n}=e,c=(0,l.A)(e,d);return(0,i.jsx)("input",(0,r.A)({type:n,className:(0,t.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a},c))});c.displayName="Input"},5598:(e,a,s)=>{s.d(a,{Cf:()=>f,L3:()=>y,c7:()=>b,lG:()=>x,rr:()=>v});var r=s(9379),l=s(3986),n=s(5043),t=s(6008),i=s(221),d=s(9766),c=s(579);const o=["className"],m=["className","children"],p=["className"],u=["className"],h=["className"],x=t.bL,j=(t.l9,t.ZL),N=(t.bm,n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,o);return(0,c.jsx)(t.hJ,(0,r.A)({ref:a,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},n))}));N.displayName=t.hJ.displayName;const f=n.forwardRef((e,a)=>{let{className:s,children:n}=e,o=(0,l.A)(e,m);return(0,c.jsxs)(j,{children:[(0,c.jsx)(N,{}),(0,c.jsxs)(t.UC,(0,r.A)((0,r.A)({ref:a,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},o),{},{children:[n,(0,c.jsxs)(t.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,c.jsx)(i.$8F,{className:"h-4 w-4"}),(0,c.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});f.displayName=t.UC.displayName;const b=e=>{let{className:a}=e,s=(0,l.A)(e,p);return(0,c.jsx)("div",(0,r.A)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a)},s))};b.displayName="DialogHeader";const y=n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,u);return(0,c.jsx)(t.hE,(0,r.A)({ref:a,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",s)},n))});y.displayName=t.hE.displayName;const v=n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,h);return(0,c.jsx)(t.VY,(0,r.A)({ref:a,className:(0,d.cn)("text-sm text-muted-foreground",s)},n))});v.displayName=t.VY.displayName},9750:(e,a,s)=>{s.r(a),s.d(a,{default:()=>j});var r=s(5043),l=s(8163),n=s(2447),t=s(1817),i=s(1140),d=s(807),c=s(2264),o=s(5598),m=s(221),p=s(9722),u=s(6328),h=s(579);const x="https://bugsecurehub.preview.emergentagent.com";function j(){const{account:e,refreshUser:a}=(0,n.v)(),s=(0,l.Zp)(),[j,N]=(0,r.useState)([]),[f,b]=(0,r.useState)(!0),[y,v]=(0,r.useState)(""),[g,_]=(0,r.useState)(null),[k,w]=(0,r.useState)(""),[C,A]=(0,r.useState)(!1),[S,z]=(0,r.useState)(null),[E,T]=(0,r.useState)(!1),[P,R]=(0,r.useState)("");(0,r.useEffect)(()=>{e?$():s("/")},[e,s]);const $=async()=>{try{const e=await p.A.get("".concat(x,"/crypto-market/sell/orders"));e.data.success&&N(e.data.orders)}catch(e){console.error("Error fetching sell orders:",e),u.oR.error("Failed to load sell orders")}finally{b(!1)}},F=e=>{navigator.clipboard.writeText(e),u.oR.success("Copied to clipboard")},L=j.filter(e=>e.crypto_amount.toString().includes(y)||e.seller_address.toLowerCase().includes(y.toLowerCase()));return(0,h.jsxs)(t.A,{children:[(0,h.jsxs)("div",{className:"buy-crypto-page","data-testid":"buy-crypto-page",children:[(0,h.jsx)("div",{className:"page-header",children:(0,h.jsxs)("div",{children:[(0,h.jsx)("h1",{className:"page-title","data-testid":"buy-crypto-title",children:"Buy Crypto with Bank Transfer"}),(0,h.jsx)("p",{className:"page-subtitle",children:"Purchase crypto directly from lenders using bank transfer"})]})}),(0,h.jsx)("div",{className:"search-container",children:(0,h.jsxs)("div",{className:"search-input-wrapper",children:[(0,h.jsx)(m.zfp,{className:"search-icon",size:20}),(0,h.jsx)(c.p,{placeholder:"Search by amount or seller address...",value:y,onChange:e=>v(e.target.value),className:"search-input","data-testid":"search-input"})]})}),f?(0,h.jsx)("div",{className:"loading-container","data-testid":"loading-spinner",children:(0,h.jsx)("div",{className:"spinner"})}):L.length>0?(0,h.jsx)("div",{className:"offers-grid",children:L.map(a=>{const s=a.crypto_amount*a.price_per_unit;return(0,h.jsxs)(i.Zp,{className:"sell-order-card","data-testid":"sell-order-card",children:[(0,h.jsxs)("div",{className:"order-header",children:[(0,h.jsx)("div",{className:"order-badge",children:"Available"}),(0,h.jsx)(m.AaD,{size:20,className:"order-icon"})]}),(0,h.jsxs)("div",{className:"order-amount",children:[(0,h.jsx)("span",{className:"amount-value",children:a.crypto_amount||0}),(0,h.jsx)("span",{className:"amount-currency",children:"ETH"})]}),(0,h.jsxs)("div",{className:"order-price",children:[(0,h.jsx)("span",{className:"price-label",children:"Price:"}),(0,h.jsxs)("span",{className:"price-value",children:["$",(a.price_per_unit||0).toLocaleString()," / ETH"]})]}),(0,h.jsxs)("div",{className:"order-details",children:[(0,h.jsxs)("div",{className:"detail-row",children:[(0,h.jsx)("span",{className:"detail-label",children:"Total Value:"}),(0,h.jsxs)("span",{className:"detail-value",children:["$",isNaN(s)?"0":s.toLocaleString()]})]}),(0,h.jsxs)("div",{className:"detail-row",children:[(0,h.jsx)("span",{className:"detail-label",children:"Min Purchase:"}),(0,h.jsxs)("span",{className:"detail-value",children:[a.min_purchase||0," ETH"]})]}),(0,h.jsxs)("div",{className:"detail-row",children:[(0,h.jsx)("span",{className:"detail-label",children:"Max Purchase:"}),(0,h.jsxs)("span",{className:"detail-value",children:[a.max_purchase||0," ETH"]})]}),(0,h.jsxs)("div",{className:"detail-row",children:[(0,h.jsx)("span",{className:"detail-label",children:"Seller:"}),(0,h.jsxs)("span",{className:"detail-value address",children:[a.seller_address.slice(0,6),"...",a.seller_address.slice(-4)]})]}),(0,h.jsxs)("div",{className:"detail-row",children:[(0,h.jsx)("span",{className:"detail-label",children:"Payment:"}),(0,h.jsx)("span",{className:"detail-value",children:"Bank Transfer"})]})]}),(0,h.jsx)(d.$,{className:"buy-btn",onClick:()=>_(a),disabled:a.seller_address===e,"data-testid":"buy-now-btn",children:a.seller_address===e?"Your Order":"Buy Now"})]},a.order_id)})}):(0,h.jsxs)(i.Zp,{className:"empty-state","data-testid":"empty-orders",children:[(0,h.jsx)(m.dSe,{size:48,className:"empty-icon"}),(0,h.jsx)("h3",{children:"No Sell Orders Available"}),(0,h.jsx)("p",{children:"Check back later or create your own sell order"}),(0,h.jsx)(d.$,{onClick:()=>s("/sell-crypto"),"data-testid":"create-sell-order-btn",children:"Create Sell Order"})]})]}),(0,h.jsx)(o.lG,{open:!!g,onOpenChange:()=>_(null),children:(0,h.jsxs)(o.Cf,{className:"buy-dialog","data-testid":"buy-dialog",children:[(0,h.jsxs)(o.c7,{children:[(0,h.jsx)(o.L3,{children:"Buy Crypto"}),(0,h.jsx)(o.rr,{children:"Enter amount to purchase"})]}),g&&(0,h.jsxs)("div",{className:"dialog-content",children:[(0,h.jsxs)("div",{className:"order-info",children:[(0,h.jsxs)("div",{className:"info-row",children:[(0,h.jsx)("span",{children:"Available:"}),(0,h.jsxs)("span",{className:"info-value",children:[g.crypto_amount||0," ETH"]})]}),(0,h.jsxs)("div",{className:"info-row",children:[(0,h.jsx)("span",{children:"Price per ETH:"}),(0,h.jsxs)("span",{className:"info-value",children:["$",(g.price_per_unit||0).toLocaleString()]})]}),(0,h.jsxs)("div",{className:"info-row",children:[(0,h.jsx)("span",{children:"Min - Max:"}),(0,h.jsxs)("span",{className:"info-value",children:[g.min_purchase||0," - ",g.max_purchase||0," ETH"]})]})]}),(0,h.jsxs)("div",{className:"input-group",children:[(0,h.jsx)("label",{htmlFor:"buy-amount",children:"Amount (ETH)"}),(0,h.jsx)(c.p,{id:"buy-amount",type:"number",placeholder:"Enter amount",value:k,onChange:e=>w(e.target.value),"data-testid":"buy-amount-input"})]}),k&&(0,h.jsxs)("div",{className:"calculation",children:[(0,h.jsxs)("div",{className:"calc-row",children:[(0,h.jsx)("span",{children:"Crypto Amount:"}),(0,h.jsxs)("span",{children:[parseFloat(k).toFixed(4)," ETH"]})]}),(0,h.jsxs)("div",{className:"calc-row total",children:[(0,h.jsx)("span",{children:"Total to Pay:"}),(0,h.jsxs)("span",{className:"highlight",children:["$",(parseFloat(k)*g.price_per_unit).toLocaleString()]})]})]}),(0,h.jsxs)("div",{className:"info-box",children:[(0,h.jsx)(m.Gm4,{size:20}),(0,h.jsx)("p",{children:"You'll have 30 minutes to complete the bank transfer"})]}),(0,h.jsxs)("div",{className:"dialog-actions",children:[(0,h.jsx)(d.$,{variant:"outline",onClick:()=>_(null),"data-testid":"cancel-btn",children:"Cancel"}),(0,h.jsx)(d.$,{onClick:async()=>{if(!g||!k)return void u.oR.error("Please enter amount");const a=parseFloat(k);if(a<g.min_purchase||a>g.max_purchase)u.oR.error("Amount must be between ".concat(g.min_purchase," and ").concat(g.max_purchase," ETH"));else{A(!0);try{const s=await p.A.post("".concat(x,"/crypto-market/buy/create"),{buyer_address:e,sell_order_id:g.order_id,crypto_amount:a});s.data.success&&(u.oR.success("Buy order created! Please complete bank transfer"),z(s.data),_(null),w(""),T(!0),$())}catch(l){var s,r;console.error("Error creating buy order:",l),u.oR.error((null===(s=l.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.detail)||"Failed to create buy order")}finally{A(!1)}}},disabled:C,"data-testid":"confirm-buy-btn",children:C?"Processing...":"Proceed to Payment"})]})]})]})}),(0,h.jsx)(o.lG,{open:E,onOpenChange:T,children:(0,h.jsxs)(o.Cf,{className:"payment-dialog","data-testid":"payment-dialog",children:[(0,h.jsxs)(o.c7,{children:[(0,h.jsx)(o.L3,{children:"Complete Bank Transfer"}),(0,h.jsx)(o.rr,{children:"Transfer funds to seller's bank account"})]}),S&&(0,h.jsxs)("div",{className:"dialog-content",children:[(0,h.jsxs)("div",{className:"payment-timer",children:[(0,h.jsx)(m.Gm4,{size:24}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"timer-label",children:"Payment Deadline"}),(0,h.jsx)("p",{className:"timer-value",children:new Date(S.payment_deadline).toLocaleString()})]})]}),(0,h.jsxs)("div",{className:"bank-details-card",children:[(0,h.jsx)("h3",{children:"Seller's Bank Details"}),(0,h.jsxs)("div",{className:"bank-detail-row",children:[(0,h.jsx)("span",{children:"Bank Name:"}),(0,h.jsxs)("div",{className:"copy-field",children:[(0,h.jsx)("span",{children:S.seller_bank_details.bank_name}),(0,h.jsx)(d.$,{size:"sm",variant:"ghost",onClick:()=>F(S.seller_bank_details.bank_name),"data-testid":"copy-bank-name",children:(0,h.jsx)(m.iyF,{size:16})})]})]}),(0,h.jsxs)("div",{className:"bank-detail-row",children:[(0,h.jsx)("span",{children:"Account Holder:"}),(0,h.jsxs)("div",{className:"copy-field",children:[(0,h.jsx)("span",{children:S.seller_bank_details.account_holder}),(0,h.jsx)(d.$,{size:"sm",variant:"ghost",onClick:()=>F(S.seller_bank_details.account_holder),"data-testid":"copy-account-holder",children:(0,h.jsx)(m.iyF,{size:16})})]})]}),(0,h.jsxs)("div",{className:"bank-detail-row",children:[(0,h.jsx)("span",{children:"Account Number:"}),(0,h.jsxs)("div",{className:"copy-field",children:[(0,h.jsx)("span",{children:S.seller_bank_details.account_number}),(0,h.jsx)(d.$,{size:"sm",variant:"ghost",onClick:()=>F(S.seller_bank_details.account_number),"data-testid":"copy-account-number",children:(0,h.jsx)(m.iyF,{size:16})})]})]}),S.seller_bank_details.routing_number&&(0,h.jsxs)("div",{className:"bank-detail-row",children:[(0,h.jsx)("span",{children:"Routing Number:"}),(0,h.jsxs)("div",{className:"copy-field",children:[(0,h.jsx)("span",{children:S.seller_bank_details.routing_number}),(0,h.jsx)(d.$,{size:"sm",variant:"ghost",onClick:()=>F(S.seller_bank_details.routing_number),"data-testid":"copy-routing-number",children:(0,h.jsx)(m.iyF,{size:16})})]})]}),(0,h.jsxs)("div",{className:"bank-detail-row highlight",children:[(0,h.jsx)("span",{children:"Amount to Transfer:"}),(0,h.jsxs)("span",{className:"amount-highlight",children:["$",S.order.total_price.toLocaleString()]})]})]}),(0,h.jsxs)("div",{className:"input-group",children:[(0,h.jsx)("label",{htmlFor:"payment-ref",children:"Payment Reference / Transaction ID"}),(0,h.jsx)(c.p,{id:"payment-ref",placeholder:"Enter your bank transfer reference",value:P,onChange:e=>R(e.target.value),"data-testid":"payment-reference-input"}),(0,h.jsx)("p",{className:"input-hint",children:"Enter the transaction ID from your bank transfer"})]}),(0,h.jsxs)("div",{className:"info-box warn",children:[(0,h.jsx)(m.dSe,{size:20}),(0,h.jsx)("p",{children:"After making the transfer, confirm payment below. Seller will release crypto once verified."})]}),(0,h.jsxs)("div",{className:"dialog-actions",children:[(0,h.jsx)(d.$,{variant:"outline",onClick:()=>{T(!1),z(null)},"data-testid":"cancel-payment-btn",children:"Cancel"}),(0,h.jsxs)(d.$,{onClick:async()=>{if(P)try{(await p.A.post("".concat(x,"/crypto-market/payment/mark-paid"),{buyer_address:e,order_id:S.order.order_id,payment_reference:P})).data.success&&(u.oR.success("\u2713 Marked as Paid! Seller will be notified to release crypto"),T(!1),z(null),R(""),await a())}catch(l){var s,r;console.error("Error marking as paid:",l),u.oR.error((null===(s=l.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.detail)||"Failed to mark as paid")}else u.oR.error("Please enter payment reference")},"data-testid":"mark-paid-btn",className:"mark-paid-btn",children:[(0,h.jsx)(m.G3G,{size:20,className:"mr-2"}),"Mark as Paid"]})]})]})]})})]})}}}]);
//# sourceMappingURL=9750.4fcdbe0b.chunk.js.map