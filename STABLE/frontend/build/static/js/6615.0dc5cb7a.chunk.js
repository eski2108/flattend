"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6615],{799:(e,s,t)=>{t.d(s,{A:()=>d});var a=t(5043),r=t(221),n=t(9722),l=t(6328),o=t(579);const i="https://controlpanel-4.preview.emergentagent.com";function d(e){let{isOpen:s,onClose:t,onVerify:d,title:c="Verify OTP",description:x="Enter the 6-digit code sent to your email",userId:m,action:u="generic"}=e;const[p,h]=(0,a.useState)(["","","","","",""]),[g,b]=(0,a.useState)(!1),[y,f]=(0,a.useState)(!1),[j,v]=(0,a.useState)(0);(0,a.useEffect)(()=>{if(j>0){const e=setTimeout(()=>v(j-1),1e3);return()=>clearTimeout(e)}},[j]),(0,a.useEffect)(()=>{s&&m&&N()},[s,m]);const N=async()=>{if(m){f(!0);try{const e=await n.A.post("".concat(i,"/api/auth/send-otp"),{user_id:m,action:u});e.data.success?(l.oR.success("OTP sent to your email"),v(60)):l.oR.error(e.data.message||"Failed to send OTP")}catch(t){var e,s;console.error("Error sending OTP:",t),l.oR.error((null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||"Failed to send OTP")}finally{f(!1)}}else l.oR.error("User ID required")},w=()=>{h(["","","","","",""]),v(0),t()};return s?(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,backdropFilter:"blur(8px)"},onClick:w,children:(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(2, 6, 24, 0.98) 0%, rgba(7, 19, 39, 0.95) 100%)",borderRadius:"24px",padding:"2.5rem",width:"90%",maxWidth:"500px",border:"2px solid rgba(0, 240, 255, 0.4)",boxShadow:"0 0 60px rgba(0, 240, 255, 0.4), 0 20px 80px rgba(0, 0, 0, 0.8)"},onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,o.jsx)(r.eeu,{size:28,color:"#00F0FF",strokeWidth:2.5}),(0,o.jsx)("h2",{style:{color:"#fff",fontSize:"1.75rem",fontWeight:"700",margin:0},children:c})]}),(0,o.jsx)("button",{onClick:w,style:{background:"none",border:"none",color:"#9FA6B2",cursor:"pointer",padding:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.currentTarget.style.color="#fff"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#9FA6B2"},children:(0,o.jsx)(r.$8F,{size:24})})]}),(0,o.jsx)("p",{style:{color:"#8F9BB3",fontSize:"0.9375rem",marginBottom:"2rem",lineHeight:"1.6"},children:x}),(0,o.jsx)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"center",marginBottom:"2rem"},children:p.map((e,s)=>(0,o.jsx)("input",{id:"otp-".concat(s),type:"text",inputMode:"numeric",maxLength:"1",value:e,onChange:e=>((e,s)=>{if(s.length>1&&(s=s.slice(-1)),!/^\d*$/.test(s))return;const t=[...p];if(t[e]=s,h(t),s&&e<5){const s=document.getElementById("otp-".concat(e+1));s&&s.focus()}})(s,e.target.value),onKeyDown:e=>((e,s)=>{if("Backspace"===s.key&&!p[e]&&e>0){const s=document.getElementById("otp-".concat(e-1));s&&s.focus()}})(s,e),style:{width:"3.5rem",height:"4rem",fontSize:"1.75rem",fontWeight:"700",textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.4)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"14px",color:"#00F0FF",outline:"none",transition:"all 0.3s",fontFamily:"monospace"},onFocus:e=>{e.currentTarget.style.borderColor="#00F0FF",e.currentTarget.style.boxShadow="0 0 20px rgba(0, 240, 255, 0.5)",e.currentTarget.style.transform="scale(1.05)"},onBlur:e=>{e.currentTarget.style.borderColor="rgba(0, 240, 255, 0.3)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.transform="scale(1)"}},s))}),(0,o.jsx)("div",{style:{textAlign:"center",marginBottom:"2rem"},children:j>0?(0,o.jsxs)("p",{style:{color:"#8F9BB3",fontSize:"0.9375rem"},children:["Resend OTP in ",(0,o.jsxs)("span",{style:{color:"#00F0FF",fontWeight:"700"},children:[j,"s"]})]}):(0,o.jsxs)("button",{onClick:N,disabled:y,style:{background:"none",border:"1px solid rgba(0, 240, 255, 0.3)",color:"#00F0FF",fontSize:"0.9375rem",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 auto",padding:"0.75rem 1.5rem",borderRadius:"12px",transition:"all 0.3s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(0, 240, 255, 0.1)",e.currentTarget.style.borderColor="rgba(0, 240, 255, 0.6)",e.currentTarget.style.boxShadow="0 0 20px rgba(0, 240, 255, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.borderColor="rgba(0, 240, 255, 0.3)",e.currentTarget.style.boxShadow="none"},children:[(0,o.jsx)(r.a4n,{size:18,style:{animation:y?"spin 1s linear infinite":"none"}}),y?"Sending...":"Resend OTP"]})}),(0,o.jsx)("button",{onClick:async()=>{const e=p.join("");if(6===e.length){b(!0);try{const t=await n.A.post("".concat(i,"/api/auth/verify-otp"),{user_id:m,otp_code:e,action:u});var s;if(t.data.success)l.oR.success("OTP verified successfully"),d(e),w();else l.oR.error(t.data.message||"Invalid OTP"),h(["","","","","",""]),null===(s=document.getElementById("otp-0"))||void 0===s||s.focus()}catch(o){var t,a,r;console.error("Error verifying OTP:",o),l.oR.error((null===(t=o.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Invalid OTP"),h(["","","","","",""]),null===(r=document.getElementById("otp-0"))||void 0===r||r.focus()}finally{b(!1)}}else l.oR.error("Please enter all 6 digits")},disabled:g||6!==p.join("").length,style:{width:"100%",padding:"1.125rem",background:6===p.join("").length?"linear-gradient(135deg, #00F0FF, #0080FF)":"rgba(40, 40, 40, 0.5)",color:"#fff",border:"none",borderRadius:"14px",fontSize:"1.0625rem",fontWeight:"700",cursor:6===p.join("").length?"pointer":"not-allowed",opacity:6===p.join("").length?1:.4,transition:"all 0.3s",boxShadow:6===p.join("").length?"0 0 30px rgba(0, 240, 255, 0.4)":"none",position:"relative",overflow:"hidden"},onMouseEnter:e=>{6===p.join("").length&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 0 40px rgba(0, 240, 255, 0.6)")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=6===p.join("").length?"0 0 30px rgba(0, 240, 255, 0.4)":"none"},children:g?"Verifying...":"Verify OTP"}),(0,o.jsx)("style",{children:"\n          @keyframes spin {\n            from { transform: rotate(0deg); }\n            to { transform: rotate(360deg); }\n          }\n        "})]})}):null}},6615:(e,s,t)=>{t.r(s),t.d(s,{default:()=>g});var a=t(5043),r=t(8163),n=t(9722),l=t(6328),o=t(221),i=t(799),d=t(9107),c=t(579);const x="https://controlpanel-4.preview.emergentagent.com";function m(e){let{isOpen:s,onClose:t,tradeId:r,userId:i,onDisputeCreated:d}=e;const[m,u]=(0,a.useState)(""),[p,h]=(0,a.useState)(""),[g,b]=(0,a.useState)(!1);return s?(0,c.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,c.jsxs)("div",{className:"bg-slate-900 border-2 border-orange-500 rounded-2xl max-w-lg w-full shadow-2xl",children:[(0,c.jsx)("div",{className:"bg-gradient-to-r from-orange-600 to-red-600 p-6 rounded-t-2xl",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)(o.tr_,{className:"w-8 h-8 text-white"}),(0,c.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Open Dispute"})]}),(0,c.jsx)("button",{onClick:t,className:"text-white/80 hover:text-white transition-colors",children:(0,c.jsx)(o.$8F,{className:"w-6 h-6"})})]})}),(0,c.jsx)("div",{className:"bg-orange-500/10 border-l-4 border-orange-500 p-4 m-6",children:(0,c.jsxs)("div",{className:"flex items-start gap-3",children:[(0,c.jsx)(o.dSe,{className:"w-6 h-6 text-orange-400 flex-shrink-0 mt-0.5"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-orange-300 font-semibold mb-1",children:"Dispute Fee: \xa35"}),(0,c.jsx)("p",{className:"text-gray-400 text-sm",children:"Opening a dispute will lock this trade. The losing party will be charged a \xa35 dispute fee. Please only open disputes for legitimate issues."})]})]})}),(0,c.jsxs)("div",{className:"p-6 space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-gray-300 font-semibold mb-2",children:"Reason for Dispute *"}),(0,c.jsxs)("select",{value:m,onChange:e=>u(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none",children:[(0,c.jsx)("option",{value:"",children:"Select a reason..."}),[{value:"payment_not_received",label:"Payment Not Received"},{value:"wrong_amount",label:"Wrong Amount Received"},{value:"crypto_not_released",label:"Crypto Not Released"},{value:"scam_attempt",label:"Suspected Scam"},{value:"other",label:"Other Issue"}].map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-gray-300 font-semibold mb-2",children:"Detailed Description *"}),(0,c.jsx)("textarea",{value:p,onChange:e=>h(e.target.value),placeholder:"Provide as much detail as possible about the issue. Include timestamps, transaction IDs, screenshots, etc.",rows:5,className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none resize-none"}),(0,c.jsxs)("p",{className:"text-gray-500 text-sm mt-1",children:[p.length,"/500 characters"]})]}),(0,c.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,c.jsx)("button",{onClick:t,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg transition-colors font-semibold",children:"Cancel"}),(0,c.jsx)("button",{onClick:async()=>{if(m&&p.trim()){b(!0);try{const e=await n.A.post("".concat(x,"/api/p2p/disputes/create"),{trade_id:r,initiated_by:i,reason:m,description:p});e.data.success?(l.oR.success("Dispute opened. Admin will review shortly."),d(e.data.dispute),t()):l.oR.error(e.data.message||"Failed to open dispute")}catch(a){var e,s;console.error("Error opening dispute:",a),l.oR.error((null===(e=a.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Failed to open dispute")}finally{b(!1)}}else l.oR.error("Please select a reason and provide details")},disabled:g||!m||!p.trim(),className:"flex-1 bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg transition-all font-semibold",children:g?"Opening Dispute...":"Open Dispute"})]})]})]})}):null}const u="https://controlpanel-4.preview.emergentagent.com";function p(e){let{isOpen:s,onClose:t,disputeId:r,userId:i,userRole:d}=e;const[x,m]=(0,a.useState)([]),[p,h]=(0,a.useState)(""),[g,b]=(0,a.useState)(!1),[y,f]=(0,a.useState)(null),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(s&&r){N();const e=setInterval(N,5e3);return()=>clearInterval(e)}},[s,r]),(0,a.useEffect)(()=>{v()},[x]);const v=()=>{var e;null===(e=j.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},N=async()=>{try{const e=await n.A.get("".concat(u,"/api/p2p/disputes/").concat(r));e.data.success&&m(e.data.dispute.messages||[])}catch(e){console.error("Error loading messages:",e)}},w=async()=>{if(p.trim()){b(!0);try{(await n.A.post("".concat(u,"/api/p2p/disputes/").concat(r,"/message"),{sender_id:i,sender_type:d,message:p})).data.success&&(h(""),N())}catch(e){console.error("Error sending message:",e),l.oR.error("Failed to send message")}finally{b(!1)}}};return s?(0,c.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,c.jsxs)("div",{className:"bg-slate-900 border-2 border-orange-500 rounded-2xl max-w-3xl w-full h-[600px] shadow-2xl flex flex-col",children:[(0,c.jsxs)("div",{className:"bg-gradient-to-r from-orange-600 to-red-600 p-4 rounded-t-2xl flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)(o.mNJ,{className:"w-6 h-6 text-white"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{className:"text-xl font-bold text-white",children:"Dispute Chat"}),(0,c.jsxs)("p",{className:"text-orange-100 text-sm",children:["ID: ",null===r||void 0===r?void 0:r.slice(0,8)]})]})]}),(0,c.jsx)("button",{onClick:t,className:"text-white/80 hover:text-white transition-colors",children:(0,c.jsx)(o.$8F,{className:"w-6 h-6"})})]}),(0,c.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[0===x.length?(0,c.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:(0,c.jsx)("p",{children:"No messages yet. Start the conversation."})}):x.map((e,s)=>(0,c.jsx)("div",{className:"flex ".concat("admin"===e.sender_type?"justify-end":"justify-start"),children:(0,c.jsxs)("div",{className:"max-w-[70%] rounded-lg p-3 ".concat("admin"===e.sender_type?"bg-gradient-to-r from-purple-600 to-indigo-600 text-white":"bg-slate-800 text-gray-200"),children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:["admin"===e.sender_type&&(0,c.jsx)(o.eeu,{className:"w-4 h-4"}),(0,c.jsx)("span",{className:"font-semibold text-sm capitalize",children:e.sender_type}),(0,c.jsx)("span",{className:"text-xs opacity-70",children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,c.jsx)("p",{className:"text-sm",children:e.message})]})},s)),(0,c.jsx)("div",{ref:j})]}),(0,c.jsx)("div",{className:"p-4 border-t border-slate-700",children:(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsxs)("label",{className:"cursor-pointer bg-slate-700 hover:bg-slate-600 p-3 rounded-lg transition-colors",children:[(0,c.jsx)(o.xvb,{className:"w-5 h-5 text-cyan-400"}),(0,c.jsx)("input",{type:"file",onChange:async e=>{const s=e.target.files[0];if(!s)return;const t=new FormData;t.append("file",s),t.append("dispute_id",r),t.append("uploaded_by",i);try{(await n.A.post("".concat(u,"/api/p2p/disputes/").concat(r,"/evidence"),t,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(l.oR.success("Evidence uploaded successfully"),N())}catch(a){console.error("Error uploading evidence:",a),l.oR.error("Failed to upload evidence")}},className:"hidden",accept:"image/*,.pdf"})]}),(0,c.jsx)("input",{type:"text",value:p,onChange:e=>h(e.target.value),onKeyPress:e=>"Enter"===e.key&&w(),placeholder:"Type your message...",className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none"}),(0,c.jsx)("button",{onClick:w,disabled:g||!p.trim(),className:"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 disabled:opacity-50 p-3 rounded-lg transition-all",children:(0,c.jsx)(o.$_z,{className:"w-5 h-5 text-white"})})]})})]})}):null}const h="https://controlpanel-4.preview.emergentagent.com";function g(){var e,s,t,x,u,g;const{tradeId:b}=(0,r.g)(),y=(0,r.Zp)(),[f,j]=(0,a.useState)(null),[v,N]=(0,a.useState)(!0),[w,k]=(0,a.useState)(0),[_,C]=(0,a.useState)([]),[S,T]=(0,a.useState)(""),[F,R]=(0,a.useState)(!1),[P,I]=(0,a.useState)(""),[E,O]=(0,a.useState)(null),[D,B]=(0,a.useState)(null),[A,z]=(0,a.useState)(!1),[M,L]=(0,a.useState)(!1),[W,V]=(0,a.useState)(null);(0,a.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("cryptobank_user")||"{}");B(e),G()},[b]),(0,a.useEffect)(()=>{if(w>0){const e=setTimeout(()=>k(w-1),1e3);return()=>clearTimeout(e)}},[w]);const G=async()=>{try{const e=await n.A.get("".concat(h,"/p2p/trade/").concat(b));e.data.success&&(j(e.data.trade),k(e.data.time_remaining_seconds||0),C([{sender:"seller",text:"Hi! Please transfer to the account details shown above.",time:"2 min ago"},{sender:"buyer",text:"Payment sent! Uploading proof now.",time:"1 min ago"}]))}catch(e){console.error("Error loading trade:",e),l.oR.error("Failed to load trade details")}finally{N(!1)}},J=()=>{S.trim()&&(C([..._,{sender:D.user_id===(null===f||void 0===f?void 0:f.buyer_id)?"buyer":"seller",text:S,time:"Just now"}]),T(""))};if(v)return(0,c.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 flex items-center justify-center",children:(0,c.jsx)("div",{className:"text-white text-xl",children:"Loading trade..."})});if(!f)return(0,c.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 flex items-center justify-center",children:(0,c.jsx)("div",{className:"text-white text-xl",children:"Trade not found"})});const $=(null===D||void 0===D?void 0:D.user_id)===f.buyer_id,H=(null===D||void 0===D?void 0:D.user_id)===f.seller_id;return(0,c.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 p-6",children:[(0,c.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,c.jsxs)("div",{className:"mb-6",children:[(0,c.jsx)("button",{onClick:()=>y("/p2p-marketplace"),className:"text-cyan-400 mb-4",children:"\u2190 Back to Marketplace"}),(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("h1",{className:"text-3xl font-bold text-white",children:["Trade #",null===(e=f.trade_id)||void 0===e?void 0:e.slice(0,8)]}),(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[w>0&&(0,c.jsxs)("div",{className:"flex items-center gap-2 bg-orange-900/30 px-6 py-3 rounded-xl border border-orange-500/30",children:[(0,c.jsx)(o.Gm4,{className:"w-6 h-6 text-orange-400"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-orange-400 font-bold text-2xl",children:(e=>{const s=Math.floor(e/60),t=e%60;return"".concat(s,":").concat(t.toString().padStart(2,"0"))})(w)}),(0,c.jsx)("div",{className:"text-orange-300 text-xs",children:"Time remaining"})]})]}),(null===D||void 0===D?void 0:D.user_id)&&(0,c.jsx)(d.A,{userId:D.user_id,tradeId:b,onNotificationClick:e=>{var s;"message_received"===e.notification_type&&(null===(s=document.getElementById("chat-section"))||void 0===s||s.scrollIntoView({behavior:"smooth"}))}})]})]})]}),"disputed"===f.status&&(0,c.jsx)("div",{className:"bg-gradient-to-r from-red-900/50 to-orange-900/50 border-2 border-red-500 rounded-xl p-6 mb-6",children:(0,c.jsxs)("div",{className:"flex items-start gap-4",children:[(0,c.jsx)(o.dSe,{className:"w-8 h-8 text-red-400 flex-shrink-0"}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("h3",{className:"text-xl font-bold text-red-300 mb-2",children:"\u26a0\ufe0f Dispute In Progress"}),(0,c.jsx)("p",{className:"text-gray-300 mb-3",children:"This trade is under admin review. Both parties can submit evidence and communicate with the admin. The losing party will be charged a \xa35 dispute fee."}),W&&(0,c.jsx)("div",{className:"bg-black/20 rounded-lg p-4 mb-3",children:(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Dispute ID:"}),(0,c.jsx)("span",{className:"text-white ml-2 font-mono",children:null===(s=W.dispute_id)||void 0===s?void 0:s.slice(0,8)})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Status:"}),(0,c.jsx)("span",{className:"text-orange-400 ml-2 font-semibold",children:W.status})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Opened:"}),(0,c.jsx)("span",{className:"text-white ml-2",children:new Date(W.created_at).toLocaleString()})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Reason:"}),(0,c.jsx)("span",{className:"text-white ml-2 capitalize",children:null===(t=W.reason)||void 0===t?void 0:t.replace(/_/g," ")})]})]})}),(0,c.jsx)("button",{onClick:()=>L(!0),className:"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-all",children:"View Dispute Chat"})]})]})}),(0,c.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,c.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,c.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,c.jsx)(o.eeu,{className:"w-6 h-6 text-cyan-400"}),(0,c.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Trade Status"})]}),(0,c.jsxs)("div",{className:"flex items-center gap-3",children:["waiting_payment"===f.status&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.dSe,{className:"w-8 h-8 text-yellow-400"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-yellow-400 font-bold text-lg",children:"Waiting for Payment"}),(0,c.jsx)("div",{className:"text-gray-400 text-sm",children:"Buyer must complete payment"})]})]}),"paid"===f.status&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.G3G,{className:"w-8 h-8 text-green-400"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-green-400 font-bold text-lg",children:"Payment Received"}),(0,c.jsx)("div",{className:"text-gray-400 text-sm",children:"Waiting for seller to release crypto"})]})]}),"completed"===f.status&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.G3G,{className:"w-8 h-8 text-green-400"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-green-400 font-bold text-lg",children:"Completed"}),(0,c.jsx)("div",{className:"text-gray-400 text-sm",children:"Trade completed successfully"})]})]})]})]}),(0,c.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-cyan-500/30 rounded-xl p-6",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,c.jsx)(o.eeu,{className:"w-6 h-6 text-cyan-400"}),(0,c.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Escrow Protection"})]}),(0,c.jsxs)("div",{className:"border rounded-lg p-4 ".concat("completed"===f.status?"bg-green-900/20 border-green-500/30":"bg-cyan-900/20 border-cyan-500/30"),children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,c.jsx)("span",{className:"text-gray-300",children:"Amount in Escrow:"}),(0,c.jsxs)("span",{className:"text-cyan-400 font-bold text-lg",children:[f.crypto_amount," ",f.crypto_currency]})]}),(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)("span",{className:"text-gray-300",children:"Escrow Status:"}),"completed"===f.status?(0,c.jsx)("span",{className:"text-green-400 font-semibold",children:"\u2713 Released"}):f.escrow_locked?(0,c.jsx)("span",{className:"text-yellow-400 font-semibold",children:"\ud83d\udd12 Locked"}):(0,c.jsx)("span",{className:"text-gray-400 font-semibold",children:"\u25cb Not Locked"})]}),(0,c.jsx)("div",{className:"mt-3 text-xs text-gray-400",children:"completed"===f.status?"\u2705 Funds have been successfully released to the buyer.":"\ud83d\udd12 Funds are safely held in escrow and will be released once seller confirms payment."})]})]}),(0,c.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Trade Details"}),(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Amount:"}),(0,c.jsxs)("span",{className:"text-white font-semibold",children:[f.crypto_amount," ",f.crypto_currency]})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Price:"}),(0,c.jsxs)("span",{className:"text-white font-semibold",children:["\xa3",null===(x=f.price_per_unit)||void 0===x?void 0:x.toLocaleString()]})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Total:"}),(0,c.jsxs)("span",{className:"text-white font-bold text-lg",children:["\xa3",null===(u=f.fiat_amount)||void 0===u?void 0:u.toLocaleString()]})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Payment Method:"}),(0,c.jsx)("span",{className:"text-white",children:f.payment_method})]}),$&&(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Seller:"}),(0,c.jsx)("span",{className:"text-white",children:"John Seller \u2b50"})]}),H&&(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Buyer:"}),(0,c.jsx)("span",{className:"text-white",children:"gads21083"})]})]})]}),$&&"waiting_payment"===f.status&&(0,c.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-blue-500/30 rounded-xl p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"\ud83d\udcb3 Payment Instructions"}),(0,c.jsxs)("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded-lg p-4 space-y-2",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Bank:"})," ",(0,c.jsx)("span",{className:"text-white",children:"HSBC"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Account:"})," ",(0,c.jsx)("span",{className:"text-white",children:"12345678"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Sort Code:"})," ",(0,c.jsx)("span",{className:"text-white",children:"40-47-84"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-400",children:"Reference:"})," ",(0,c.jsxs)("span",{className:"text-cyan-400 font-mono",children:["TRADE",null===(g=f.trade_id)||void 0===g?void 0:g.slice(0,8)]})]})]}),(0,c.jsx)("div",{className:"mt-4 text-sm text-yellow-400",children:"\u26a0\ufe0f Please include the reference code in your transfer!"})]}),$&&"waiting_payment"===f.status&&(0,c.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"\ud83d\udcce Upload Payment Proof"}),(0,c.jsxs)("div",{className:"border-2 border-dashed border-slate-600 rounded-lg p-8 text-center hover:border-cyan-500 transition-colors cursor-pointer",children:[(0,c.jsx)(o.xvb,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),(0,c.jsx)("input",{type:"file",className:"hidden",id:"proof-upload",onChange:e=>O(e.target.files[0])}),(0,c.jsxs)("label",{htmlFor:"proof-upload",className:"cursor-pointer",children:[(0,c.jsx)("div",{className:"text-white mb-2",children:"Click to upload or drag and drop"}),(0,c.jsx)("div",{className:"text-gray-400 text-sm",children:"PNG, JPG or PDF (max. 5MB)"})]}),E&&(0,c.jsxs)("div",{className:"mt-4 text-green-400",children:["\u2713 ",E.name]})]})]}),H&&"paid"===f.status&&(0,c.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-green-500/30 rounded-xl p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"\u2705 Buyer Marked Payment Complete"}),(0,c.jsxs)("div",{className:"bg-green-900/20 border border-green-500/30 rounded-lg p-4",children:[(0,c.jsx)("div",{className:"text-green-400 font-semibold mb-2",children:"Payment Confirmation Received"}),(0,c.jsx)("div",{className:"text-gray-300 text-sm mb-3",children:"The buyer has marked the payment as complete. Please verify the payment in your bank account before releasing crypto."}),(0,c.jsx)("div",{className:"text-xs text-yellow-400",children:"\u26a0\ufe0f Only release crypto after confirming the payment has arrived in your account!"})]})]}),(0,c.jsxs)("div",{className:"flex gap-4",children:[$&&"waiting_payment"===f.status&&(0,c.jsx)("button",{onClick:async()=>{try{(await n.A.post("".concat(h,"/p2p/mark-paid"),{trade_id:b,buyer_id:D.user_id})).data.success&&(l.oR.success("Payment marked as complete!"),G())}catch(e){console.error("Error marking as paid:",e),l.oR.error("Failed to mark as paid")}},className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-xl transition-colors shadow-lg hover:shadow-green-500/50",children:"\u2713 I Have Paid"}),H&&"paid"===f.status&&(0,c.jsx)("button",{onClick:()=>{R(!0)},className:"flex-1 bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-4 px-6 rounded-xl transition-colors shadow-lg hover:shadow-cyan-500/50",children:"\ud83d\udd13 Release Crypto"}),"completed"===f.status&&(0,c.jsx)("div",{className:"flex-1 bg-green-900/30 border border-green-500/30 text-green-400 font-bold py-4 px-6 rounded-xl text-center",children:"\u2705 Trade Completed"}),("waiting_payment"===f.status||"paid"===f.status)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to cancel this trade? Funds will be returned to seller.")&&l.oR.info("Cancel trade functionality coming soon")},className:"bg-slate-700 hover:bg-slate-600 text-white px-6 py-4 rounded-xl transition-colors",children:"Cancel Trade"}),(0,c.jsx)("button",{onClick:()=>z(!0),className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-4 rounded-xl transition-colors",children:"Open Dispute"})]})]})]}),(0,c.jsx)("div",{className:"lg:col-span-1",children:(0,c.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 h-[600px] flex flex-col",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,c.jsx)(o.mNJ,{className:"w-5 h-5 text-cyan-400"}),(0,c.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Chat"})]}),(0,c.jsx)("div",{className:"flex-1 overflow-y-auto space-y-3 mb-4",children:_.map((e,s)=>(0,c.jsx)("div",{className:"flex ".concat("buyer"===e.sender?"justify-end":"justify-start"),children:(0,c.jsxs)("div",{className:"max-w-[80%] rounded-lg p-3 ".concat("buyer"===e.sender?"bg-cyan-600 text-white":"bg-slate-700 text-gray-200"),children:[(0,c.jsx)("div",{className:"text-sm",children:e.text}),(0,c.jsx)("div",{className:"text-xs opacity-70 mt-1",children:e.time})]})},s))}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)("input",{type:"text",value:S,onChange:e=>T(e.target.value),onKeyPress:e=>"Enter"===e.key&&J(),placeholder:"Type message...",className:"flex-1 bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white"}),(0,c.jsx)("button",{onClick:J,className:"bg-cyan-600 hover:bg-cyan-700 text-white px-4 py-2 rounded-lg",children:"Send"})]})]})})]})]}),(0,c.jsx)(i.A,{isOpen:F,onClose:()=>R(!1),onVerify:async e=>{try{const s=await n.A.post("".concat(h,"/api/crypto-market/release-crypto"),{order_id:b,otp_code:e,seller_id:D.user_id});s.data.success?(l.oR.success("Crypto released successfully!"),R(!1),G()):l.oR.error(s.data.message||"Failed to release crypto")}catch(a){var s,t;console.error("Error releasing crypto:",a),l.oR.error((null===(s=a.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed to release crypto")}},title:"\ud83d\udd10 Confirm Release",description:f?"You are about to release ".concat(f.crypto_amount," ").concat(f.crypto_currency," to the buyer. Enter the 6-digit OTP code sent to your email."):"Verify your identity to release crypto.",userId:null===D||void 0===D?void 0:D.user_id,action:"p2p_release"}),(0,c.jsx)(m,{isOpen:A,onClose:()=>z(!1),tradeId:b,userId:null===D||void 0===D?void 0:D.user_id,onDisputeCreated:e=>{V(e),z(!1),G()}}),W&&(0,c.jsx)(p,{isOpen:M,onClose:()=>L(!1),disputeId:W.dispute_id,userId:null===D||void 0===D?void 0:D.user_id,userRole:(null===D||void 0===D?void 0:D.user_id)===(null===f||void 0===f?void 0:f.buyer_id)?"buyer":"seller"})]})}}}]);
//# sourceMappingURL=6615.0dc5cb7a.chunk.js.map