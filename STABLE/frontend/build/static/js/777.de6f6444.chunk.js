"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[777],{777:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});var a=t(9379),l=t(5043),r=t(9722),c=t(6328),d=t(221),i=t(579);const n="https://crypto-trust-guard.preview.emergentagent.com";function x(){const[e,s]=(0,l.useState)([]),[t,x]=(0,l.useState)(!0),[o,m]=(0,l.useState)({eventType:"all",success:"all",startDate:"",endDate:"",search:""}),[p,h]=(0,l.useState)({totalAttempts:0,successfulLogins:0,failedLogins:0,newDevices:0});(0,l.useEffect)(()=>{g()},[o]);const g=async()=>{try{x(!0);const e=await r.A.get("".concat(n,"/api/admin/security-logs"),{params:o});e.data.success&&(s(e.data.logs||[]),h(e.data.stats||{}))}catch(e){console.error("Failed to load security logs:",e),c.oR.error("Failed to load security logs")}finally{x(!1)}},u=(e,s)=>{m(t=>(0,a.A)((0,a.A)({},t),{},{[e]:s}))};return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 p-6",children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,i.jsx)(d.eeu,{className:"w-8 h-8 text-cyan-400"}),(0,i.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Security Logs"})]}),(0,i.jsx)("p",{className:"text-gray-400",children:"Monitor all login attempts and security events"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,i.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6",children:[(0,i.jsx)("div",{className:"text-gray-400 text-sm mb-2",children:"Total Attempts"}),(0,i.jsx)("div",{className:"text-3xl font-bold text-white",children:p.totalAttempts})]}),(0,i.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6",children:[(0,i.jsx)("div",{className:"text-gray-400 text-sm mb-2",children:"Successful"}),(0,i.jsx)("div",{className:"text-3xl font-bold text-green-400",children:p.successfulLogins})]}),(0,i.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6",children:[(0,i.jsx)("div",{className:"text-gray-400 text-sm mb-2",children:"Failed"}),(0,i.jsx)("div",{className:"text-3xl font-bold text-red-400",children:p.failedLogins})]}),(0,i.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6",children:[(0,i.jsx)("div",{className:"text-gray-400 text-sm mb-2",children:"New Devices"}),(0,i.jsx)("div",{className:"text-3xl font-bold text-yellow-400",children:p.newDevices})]})]}),(0,i.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 mb-6",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,i.jsx)(d.n6t,{className:"w-5 h-5 text-cyan-400"}),(0,i.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Filters"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"Event Type"}),(0,i.jsxs)("select",{value:o.eventType,onChange:e=>u("eventType",e.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white",children:[(0,i.jsx)("option",{value:"all",children:"All Events"}),(0,i.jsx)("option",{value:"login",children:"Login"}),(0,i.jsx)("option",{value:"signup",children:"Signup"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"Status"}),(0,i.jsxs)("select",{value:o.success,onChange:e=>u("success",e.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white",children:[(0,i.jsx)("option",{value:"all",children:"All"}),(0,i.jsx)("option",{value:"success",children:"Success"}),(0,i.jsx)("option",{value:"failed",children:"Failed"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"Start Date"}),(0,i.jsx)("input",{type:"date",value:o.startDate,onChange:e=>u("startDate",e.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"End Date"}),(0,i.jsx)("input",{type:"date",value:o.endDate,onChange:e=>u("endDate",e.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"Search"}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(d.zfp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,i.jsx)("input",{type:"text",value:o.search,onChange:e=>u("search",e.target.value),placeholder:"Email or IP",className:"w-full bg-slate-700 border border-slate-600 rounded-lg pl-10 pr-4 py-2 text-white"})]})]})]}),(0,i.jsx)("div",{className:"mt-4 flex gap-3",children:(0,i.jsxs)("button",{onClick:async()=>{try{const e=await r.A.get("".concat(n,"/api/admin/security-logs/export"),{params:o,responseType:"blob"}),s=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=s,t.setAttribute("download","security_logs_".concat((new Date).toISOString(),".csv")),document.body.appendChild(t),t.click(),t.remove(),c.oR.success("Logs exported successfully")}catch(e){console.error("Failed to export logs:",e),c.oR.error("Failed to export logs")}},className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-lg text-white transition-colors",children:[(0,i.jsx)(d.y10,{className:"w-4 h-4"}),"Export CSV"]})})]}),(0,i.jsx)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl overflow-hidden",children:(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{className:"bg-slate-900/50",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Status"}),(0,i.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Event"}),(0,i.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"User"}),(0,i.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"IP Address"}),(0,i.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Location"}),(0,i.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Device"}),(0,i.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Timestamp"})]})}),(0,i.jsx)("tbody",{className:"divide-y divide-slate-700",children:t?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-400",children:"Loading..."})}):0===e.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-400",children:"No logs found"})}):e.map((e,s)=>{return(0,i.jsxs)("tr",{className:"hover:bg-slate-700/30 transition-colors",children:[(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(t=e.success,t?(0,i.jsx)(d.G3G,{className:"w-5 h-5 text-green-400"}):(0,i.jsx)(d.LyW,{className:"w-5 h-5 text-red-400"})),e.is_new_device&&(0,i.jsx)(d.tr_,{className:"w-4 h-4 text-yellow-400",title:"New Device"})]})}),(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-cyan-900/50 text-cyan-300",children:e.event_type})}),(0,i.jsxs)("td",{className:"px-6 py-4",children:[(0,i.jsx)("div",{className:"text-white font-medium",children:e.email}),e.failure_reason&&(0,i.jsx)("div",{className:"text-xs text-red-400 mt-1",children:e.failure_reason})]}),(0,i.jsx)("td",{className:"px-6 py-4 text-gray-300 font-mono text-sm",children:e.ip_address}),(0,i.jsxs)("td",{className:"px-6 py-4 text-gray-300",children:[e.city,", ",e.country]}),(0,i.jsxs)("td",{className:"px-6 py-4",children:[(0,i.jsxs)("div",{className:"text-white text-sm",children:[e.browser," on ",e.os]}),(0,i.jsx)("div",{className:"text-xs text-gray-400",children:e.device_type})]}),(0,i.jsx)("td",{className:"px-6 py-4 text-gray-300 text-sm",children:new Date(e.timestamp).toLocaleString()})]},s);var t})})]})})})]})})}}}]);
//# sourceMappingURL=777.de6f6444.chunk.js.map