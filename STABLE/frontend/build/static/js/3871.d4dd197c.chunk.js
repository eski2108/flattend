"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3871],{2264:(e,r,t)=>{t.d(r,{p:()=>d});var i=t(9379),o=t(3986),a=t(5043),n=t(9766),s=t(579);const l=["className","type"],d=a.forwardRef((e,r)=>{let{className:t,type:a}=e,d=(0,o.A)(e,l);return(0,s.jsx)("input",(0,i.A)({type:a,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r},d))});d.displayName="Input"},3871:(e,r,t)=>{t.r(r),t.d(r,{default:()=>u});var i=t(5043),o=t(8163),a=t(1817),n=t(807),s=(t(2264),t(221)),l=t(9722),d=t(6328),c=t(4196),m=t(579);const p="https://express-buy-flow.preview.emergentagent.com";function u(){var e,r,t,u;const g=(0,o.zy)(),x=(0,o.Zp)(),f=(null===(e=g.state)||void 0===e?void 0:e.offer)||null,[h,y]=(0,i.useState)(""),[v,b]=(0,i.useState)(""),[j,S]=(0,i.useState)(!1),[w,_]=(0,i.useState)(null),[F,k]=(0,i.useState)(""),[z,B]=(0,i.useState)(""),[C,W]=(0,i.useState)(null),[R,E]=(0,i.useState)(!1),[T,A]=(0,i.useState)(window.innerWidth<=768);(0,i.useEffect)(()=>{const e=()=>A(window.innerWidth<=768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{const e=localStorage.getItem("cryptobank_user");if(!e)return void x("/login");const r=JSON.parse(e);if(_(r),!f)return d.oR.error("No offer data received"),void x("/p2p-marketplace");if(!f.min_purchase||!f.max_purchase||!f.price_per_unit)return d.oR.error("Invalid or incomplete offer data"),void x("/p2p-marketplace");const t=(f.min_purchase+f.max_purchase)/2,i=(t*f.price_per_unit).toFixed(2);y(t.toFixed(8)),b(i)},[f,x]);if(!f)return(0,m.jsx)(a.A,{children:(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",flexDirection:"column",gap:"1rem"},children:[(0,m.jsx)("p",{style:{color:"#888",fontSize:"18px"},children:"No offer selected"}),(0,m.jsx)(n.$,{onClick:()=>x("/p2p-marketplace"),children:"Back to Marketplace"})]})});const I=f.fiat_currency||"GBP",N=(e=>({USD:"$",GBP:"\xa3",EUR:"\u20ac"}[e]||"$"))(I),M=(f.min_purchase*f.price_per_unit).toFixed(2),L=(f.max_purchase*f.price_per_unit).toFixed(2),D=f.crypto_currency||"BTC";return(0,m.jsx)(a.A,{children:(0,m.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"1.5rem 1rem"},children:[(0,m.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,m.jsx)("h1",{style:{fontSize:"1.75rem",fontWeight:"900",color:"#00F0FF",marginBottom:"0.5rem"},children:"Order Preview"}),(0,m.jsx)("p",{style:{color:"#888",fontSize:"0.875rem"},children:"Review details before confirming your purchase"})]}),(0,m.jsx)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},children:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1rem"},children:[(0,m.jsx)("div",{style:{width:"56px",height:"56px",borderRadius:"50%",background:"linear-gradient(135deg, #00F0FF, #A855F7)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",fontWeight:"700",color:"#000",flexShrink:0},children:(null===(r=f.seller_name)||void 0===r?void 0:r.substring(0,2).toUpperCase())||"SE"}),(0,m.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem",flexWrap:"wrap"},children:[(0,m.jsx)("span",{style:{fontSize:"1.125rem",fontWeight:"700",color:"#fff"},children:f.seller_name||"Seller****"}),(0,m.jsx)(s.G3G,{size:18,style:{color:"#10B981",flexShrink:0}})]}),(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.8125rem",flexWrap:"wrap"},children:[(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,m.jsx)(s.DBe,{size:14,fill:"#FFD700",stroke:"#FFD700"}),(0,m.jsx)("span",{style:{color:"#fff",fontWeight:"600"},children:"4.8"})]}),(0,m.jsx)("span",{style:{color:"#888"},children:"156 trades"}),(0,m.jsx)("span",{style:{color:"#10B981",fontWeight:"600"},children:"98.5% completion"})]})]})]})}),(0,m.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,m.jsxs)("div",{style:{marginBottom:"1.25rem"},children:[(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.8125rem",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:["Price per ",D]}),(0,m.jsxs)("div",{style:{color:"#00F0FF",fontSize:"1.75rem",fontWeight:"900"},children:[N,null===(t=f.price_per_unit)||void 0===t?void 0:t.toLocaleString()]})]}),(0,m.jsxs)("div",{style:{paddingTop:"1rem",borderTop:"1px solid rgba(0, 240, 255, 0.15)"},children:[(0,m.jsx)("div",{style:{color:"#888",fontSize:"0.8125rem",marginBottom:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Order Limits"}),(0,m.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{style:{color:"#666",fontSize:"0.75rem",marginBottom:"0.25rem"},children:"Minimum"}),(0,m.jsxs)("div",{style:{color:"#fff",fontSize:"0.9375rem",fontWeight:"700"},children:[N,M]}),(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.75rem"},children:[f.min_purchase," ",D]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{style:{color:"#666",fontSize:"0.75rem",marginBottom:"0.25rem"},children:"Maximum"}),(0,m.jsxs)("div",{style:{color:"#fff",fontSize:"0.9375rem",fontWeight:"700"},children:[N,L]}),(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.75rem"},children:[f.max_purchase," ",D]})]})]})]})]}),(0,m.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,m.jsx)("div",{style:{color:"#888",fontSize:"0.8125rem",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"1rem"},children:"Enter Amount"}),(0,m.jsx)(c.A,{cryptoSymbol:D,fiatCurrency:I,onFiatChange:e=>b(e.toString()),onCryptoChange:e=>y(e.toString()),initialFiatAmount:v,initialCryptoAmount:h,fee:0,showCurrencySelector:!1,label:""})]}),(0,m.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,m.jsx)("div",{style:{color:"#888",fontSize:"0.8125rem",marginBottom:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Payment Methods Available"}),(0,m.jsx)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:null===(u=f.payment_methods)||void 0===u?void 0:u.slice(0,3).map((e,r)=>(0,m.jsxs)("div",{style:{background:"rgba(0, 240, 255, 0.1)",border:"1px solid rgba(0, 240, 255, 0.3)",borderRadius:"8px",padding:"0.5rem 1rem",color:"#00F0FF",fontSize:"0.8125rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,m.jsx)(s.dXk,{size:16}),e.replace(/_/g," ").toUpperCase()]},r))})]}),(0,m.jsxs)("div",{style:{background:"rgba(26, 31, 58, 0.9)",border:"2px solid rgba(168, 85, 247, 0.4)",borderRadius:"16px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.8125rem",marginBottom:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:["Your ",D," Wallet Address"]}),(0,m.jsx)("div",{style:{marginBottom:"0.75rem"},children:(0,m.jsx)("input",{type:"text",value:F,onChange:e=>k(e.target.value),placeholder:"Enter your ".concat(D," wallet address"),style:{width:"100%",fontSize:"1rem",fontWeight:"600",color:"#fff",background:"rgba(0, 0, 0, 0.4)",border:null!==C&&void 0!==C&&C.valid?"2px solid #22C55E":"2px solid rgba(168, 85, 247, 0.3)",borderRadius:"10px",padding:"1rem",fontFamily:"monospace"}})}),(0,m.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,m.jsx)("label",{style:{color:"#888",fontSize:"0.8125rem",display:"block",marginBottom:"0.5rem"},children:"Network (Optional)"}),(0,m.jsxs)("select",{value:z,onChange:e=>B(e.target.value),style:{width:"100%",fontSize:"0.875rem",fontWeight:"600",color:"#fff",background:"rgba(0, 0, 0, 0.4)",border:"2px solid rgba(168, 85, 247, 0.3)",borderRadius:"8px",padding:"0.75rem"},children:[(0,m.jsx)("option",{value:"",children:"Select Network"}),(0,m.jsx)("option",{value:"mainnet",children:"Mainnet"}),(0,m.jsx)("option",{value:"legacy",children:"Legacy"}),(0,m.jsx)("option",{value:"segwit",children:"SegWit"})]})]}),R&&(0,m.jsx)("div",{style:{color:"#F59E0B",fontSize:"0.875rem",marginBottom:"0.5rem"},children:"\ud83d\udd04 Validating wallet address..."}),(null===C||void 0===C?void 0:C.valid)&&(0,m.jsxs)("div",{style:{color:"#22C55E",fontSize:"0.875rem",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["\u2713 Valid ",D," ",C.address_type||"Legacy"," address"]}),C&&!C.valid&&(0,m.jsx)("div",{style:{color:"#EF4444",fontSize:"0.875rem",marginBottom:"0.5rem"},children:"\u274c Invalid wallet address format"}),(0,m.jsxs)("div",{style:{color:"#888",fontSize:"0.75rem",lineHeight:"1.5"},children:["\ud83d\udca1 Enter the wallet address where you want to receive your ",D,". Double-check for accuracy."]})]}),(0,m.jsx)("button",{onClick:async()=>{if((()=>{const e=parseFloat(h);return!e||e<=0?(d.oR.error("Please enter a valid amount"),!1):e<f.min_purchase?(d.oR.error("Minimum order is ".concat(f.min_purchase," ").concat(f.crypto_currency)),!1):!(e>f.max_purchase)||(d.oR.error("Maximum order is ".concat(f.max_purchase," ").concat(f.crypto_currency)),!1)})()){try{await(async()=>{if(F.trim()){E(!0);try{const e=await l.A.post("".concat(p,"/api/wallet/validate"),null,{params:{address:F,cryptocurrency:f.crypto_currency,network:z||null}});e.data.valid&&W(e.data)}catch(e){}finally{E(!1)}}})()}catch(i){}S(!0);try{const r={sell_order_id:f.order_id,buyer_id:w.user_id,crypto_amount:parseFloat(h),payment_method:f.payment_methods[0],buyer_wallet_address:F,buyer_wallet_network:z||null},t=await l.A.post("".concat(p,"/api/p2p/create-trade"),r);if(t.data.success){var e;const r=t.data.trade_id||(null===(e=t.data.trade)||void 0===e?void 0:e.trade_id)||t.data.id;if(!r)return console.error("\u274c No trade_id in response!",t.data),void d.oR.error("Trade created but ID missing");d.oR.success("Trade created! Crypto locked in escrow."),setTimeout(()=>{x("/p2p/trade/".concat(r))},1500)}}catch(o){var r,t;console.error("Error creating trade:",o),d.oR.error((null===(r=o.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.detail)||"Failed to create trade")}finally{S(!1)}}},disabled:j||!h||parseFloat(h)<=0||!F.trim(),style:{width:"100%",minHeight:"60px",background:j||!h||parseFloat(h)<=0||!F.trim()?"rgba(100,100,100,0.5)":"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"16px",fontSize:"1.125rem",fontWeight:"900",color:"#fff",cursor:j||!h||parseFloat(h)<=0||!F.trim()?"not-allowed":"pointer",boxShadow:j||!h||parseFloat(h)<=0||!F.trim()?"none":"0 4px 24px rgba(34, 197, 94, 0.5), 0 0 40px rgba(34, 197, 94, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",opacity:j||!h||parseFloat(h)<=0||!F.trim()?.5:1,transition:"all 0.3s"},onMouseEnter:e=>{!j&&h&&parseFloat(h)>0&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 8px 40px rgba(34, 197, 94, 0.7), 0 0 60px rgba(34, 197, 94, 0.5)")},onMouseLeave:e=>{!j&&h&&parseFloat(h)>0&&(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 24px rgba(34, 197, 94, 0.5), 0 0 40px rgba(34, 197, 94, 0.3)")},children:j?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",borderWidth:"2px"}}),"Processing..."]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(s.eeu,{size:24}),"Confirm & Lock in Escrow"]})})]})})}}}]);
//# sourceMappingURL=3871.d4dd197c.chunk.js.map