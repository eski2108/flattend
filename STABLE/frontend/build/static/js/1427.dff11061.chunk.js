"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1427],{799:(e,t,r)=>{r.d(t,{A:()=>d});var n=r(5043),o=r(221),s=r(9722),a=r(6328),i=r(579);const l="https://controlpanel-4.preview.emergentagent.com";function d(e){let{isOpen:t,onClose:r,onVerify:d,title:c="Verify OTP",description:p="Enter the 6-digit code sent to your email",userId:u,action:g="generic"}=e;const[x,m]=(0,n.useState)(["","","","","",""]),[y,f]=(0,n.useState)(!1),[h,b]=(0,n.useState)(!1),[F,v]=(0,n.useState)(0);(0,n.useEffect)(()=>{if(F>0){const e=setTimeout(()=>v(F-1),1e3);return()=>clearTimeout(e)}},[F]),(0,n.useEffect)(()=>{t&&u&&j()},[t,u]);const j=async()=>{if(u){b(!0);try{const e=await s.A.post("".concat(l,"/api/auth/send-otp"),{user_id:u,action:g});e.data.success?(a.oR.success("OTP sent to your email"),v(60)):a.oR.error(e.data.message||"Failed to send OTP")}catch(r){var e,t;console.error("Error sending OTP:",r),a.oR.error((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to send OTP")}finally{b(!1)}}else a.oR.error("User ID required")},w=()=>{m(["","","","","",""]),v(0),r()};return t?(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,backdropFilter:"blur(8px)"},onClick:w,children:(0,i.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(2, 6, 24, 0.98) 0%, rgba(7, 19, 39, 0.95) 100%)",borderRadius:"24px",padding:"2.5rem",width:"90%",maxWidth:"500px",border:"2px solid rgba(0, 240, 255, 0.4)",boxShadow:"0 0 60px rgba(0, 240, 255, 0.4), 0 20px 80px rgba(0, 0, 0, 0.8)"},onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,i.jsx)(o.eeu,{size:28,color:"#00F0FF",strokeWidth:2.5}),(0,i.jsx)("h2",{style:{color:"#fff",fontSize:"1.75rem",fontWeight:"700",margin:0},children:c})]}),(0,i.jsx)("button",{onClick:w,style:{background:"none",border:"none",color:"#9FA6B2",cursor:"pointer",padding:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.currentTarget.style.color="#fff"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#9FA6B2"},children:(0,i.jsx)(o.$8F,{size:24})})]}),(0,i.jsx)("p",{style:{color:"#8F9BB3",fontSize:"0.9375rem",marginBottom:"2rem",lineHeight:"1.6"},children:p}),(0,i.jsx)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"center",marginBottom:"2rem"},children:x.map((e,t)=>(0,i.jsx)("input",{id:"otp-".concat(t),type:"text",inputMode:"numeric",maxLength:"1",value:e,onChange:e=>((e,t)=>{if(t.length>1&&(t=t.slice(-1)),!/^\d*$/.test(t))return;const r=[...x];if(r[e]=t,m(r),t&&e<5){const t=document.getElementById("otp-".concat(e+1));t&&t.focus()}})(t,e.target.value),onKeyDown:e=>((e,t)=>{if("Backspace"===t.key&&!x[e]&&e>0){const t=document.getElementById("otp-".concat(e-1));t&&t.focus()}})(t,e),style:{width:"3.5rem",height:"4rem",fontSize:"1.75rem",fontWeight:"700",textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.4)",border:"2px solid rgba(0, 240, 255, 0.3)",borderRadius:"14px",color:"#00F0FF",outline:"none",transition:"all 0.3s",fontFamily:"monospace"},onFocus:e=>{e.currentTarget.style.borderColor="#00F0FF",e.currentTarget.style.boxShadow="0 0 20px rgba(0, 240, 255, 0.5)",e.currentTarget.style.transform="scale(1.05)"},onBlur:e=>{e.currentTarget.style.borderColor="rgba(0, 240, 255, 0.3)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.transform="scale(1)"}},t))}),(0,i.jsx)("div",{style:{textAlign:"center",marginBottom:"2rem"},children:F>0?(0,i.jsxs)("p",{style:{color:"#8F9BB3",fontSize:"0.9375rem"},children:["Resend OTP in ",(0,i.jsxs)("span",{style:{color:"#00F0FF",fontWeight:"700"},children:[F,"s"]})]}):(0,i.jsxs)("button",{onClick:j,disabled:h,style:{background:"none",border:"1px solid rgba(0, 240, 255, 0.3)",color:"#00F0FF",fontSize:"0.9375rem",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 auto",padding:"0.75rem 1.5rem",borderRadius:"12px",transition:"all 0.3s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(0, 240, 255, 0.1)",e.currentTarget.style.borderColor="rgba(0, 240, 255, 0.6)",e.currentTarget.style.boxShadow="0 0 20px rgba(0, 240, 255, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.borderColor="rgba(0, 240, 255, 0.3)",e.currentTarget.style.boxShadow="none"},children:[(0,i.jsx)(o.a4n,{size:18,style:{animation:h?"spin 1s linear infinite":"none"}}),h?"Sending...":"Resend OTP"]})}),(0,i.jsx)("button",{onClick:async()=>{const e=x.join("");if(6===e.length){f(!0);try{const r=await s.A.post("".concat(l,"/api/auth/verify-otp"),{user_id:u,otp_code:e,action:g});var t;if(r.data.success)a.oR.success("OTP verified successfully"),d(e),w();else a.oR.error(r.data.message||"Invalid OTP"),m(["","","","","",""]),null===(t=document.getElementById("otp-0"))||void 0===t||t.focus()}catch(i){var r,n,o;console.error("Error verifying OTP:",i),a.oR.error((null===(r=i.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||"Invalid OTP"),m(["","","","","",""]),null===(o=document.getElementById("otp-0"))||void 0===o||o.focus()}finally{f(!1)}}else a.oR.error("Please enter all 6 digits")},disabled:y||6!==x.join("").length,style:{width:"100%",padding:"1.125rem",background:6===x.join("").length?"linear-gradient(135deg, #00F0FF, #0080FF)":"rgba(40, 40, 40, 0.5)",color:"#fff",border:"none",borderRadius:"14px",fontSize:"1.0625rem",fontWeight:"700",cursor:6===x.join("").length?"pointer":"not-allowed",opacity:6===x.join("").length?1:.4,transition:"all 0.3s",boxShadow:6===x.join("").length?"0 0 30px rgba(0, 240, 255, 0.4)":"none",position:"relative",overflow:"hidden"},onMouseEnter:e=>{6===x.join("").length&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 0 40px rgba(0, 240, 255, 0.6)")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=6===x.join("").length?"0 0 30px rgba(0, 240, 255, 0.4)":"none"},children:y?"Verifying...":"Verify OTP"}),(0,i.jsx)("style",{children:"\n          @keyframes spin {\n            from { transform: rotate(0deg); }\n            to { transform: rotate(360deg); }\n          }\n        "})]})}):null}},1427:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var n=r(5043),o=r(8163),s=r(221),a=r(1434),i=r(9722),l=r(6328),d=r(1817),c=r(799),p=r(579);const u="https://controlpanel-4.preview.emergentagent.com";function g(){const{coin:e}=(0,o.g)(),t=(0,o.Zp)(),[r,g]=(0,n.useState)(null),[x,m]=(0,n.useState)((null===e||void 0===e?void 0:e.toUpperCase())||"BTC"),[y,f]=(0,n.useState)(""),[h,b]=(0,n.useState)(""),[F,v]=(0,n.useState)(!1),[j,w]=(0,n.useState)(!1),[S,B]=(0,n.useState)(null),[C,T]=(0,n.useState)(0),[k,A]=(0,n.useState)([]);(0,n.useEffect)(()=>{const e=localStorage.getItem("cryptobank_user");if(!e)return void t("/login");const r=JSON.parse(e);g(r),z(r.user_id)},[t]),(0,n.useEffect)(()=>{e&&m(e.toUpperCase())},[e]);const z=async e=>{try{const t=await i.A.get("".concat(u,"/api/wallets/balances/").concat(e));if(t.data.success){const e=t.data.balances||[];A(e);const r=e.find(e=>e.currency===x);r&&T(r.available_balance)}}catch(t){console.error("Failed to load balances:",t)}};(0,n.useEffect)(()=>{if(k.length>0){const e=k.find(e=>e.currency===x);e&&T(e.available_balance)}},[x,k]);const E=e=>({BTC:"#F7931A",ETH:"#627EEA",USDT:"#26A17B",BNB:"#F3BA2F",SOL:"#9945FF",LTC:"#345D9D",DOGE:"#C3A634"}[e]||"#00F0FF");return(0,p.jsxs)(d.A,{children:[(0,p.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #05060B 0%, #080B14 100%)",padding:"20px"},children:(0,p.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[(0,p.jsxs)("button",{onClick:()=>t("/wallet"),className:"premium-btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",marginBottom:"24px",fontSize:"14px"},children:[(0,p.jsx)(s.NEn,{size:18}),"Back to Wallet"]}),(0,p.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,p.jsxs)("h1",{style:{fontSize:"28px",fontWeight:"700",color:"#FFFFFF",marginBottom:"8px"},children:["Withdraw ",x]}),(0,p.jsxs)("p",{style:{fontSize:"15px",color:"#A3AEC2"},children:["Send ",x," to your external wallet. Withdrawals require OTP verification."]})]}),(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #08192B 0%, #04101F 100%)",border:"2px solid ".concat(E(x),"44"),borderRadius:"22px",padding:"24px",marginBottom:"24px",boxShadow:"0 0 20px ".concat(E(x),"22"),opacity:.94},children:[(0,p.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",background:"rgba(0, 240, 255, 0.05)",borderRadius:"12px",border:"1px solid rgba(0, 240, 255, 0.2)"},children:[(0,p.jsx)("div",{style:{fontSize:"13px",color:"#A3AEC2",marginBottom:"4px"},children:"Available Balance"}),(0,p.jsxs)("div",{style:{fontSize:"24px",fontWeight:"700",color:"#00F0FF"},children:[C.toFixed(8)," ",x]})]}),(0,p.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,p.jsx)("label",{style:{fontSize:"14px",color:"#A3AEC2",marginBottom:"8px",display:"block"},children:"Amount to Withdraw"}),(0,p.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,p.jsx)("input",{type:"number",value:y,onChange:e=>f(e.target.value),placeholder:"0.00000000",className:"premium-input",style:{flex:1}}),(0,p.jsx)("button",{onClick:()=>{f(C.toString())},className:"premium-btn-secondary",style:{padding:"0 20px",fontSize:"14px",fontWeight:"600"},children:"MAX"})]})]}),(0,p.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,p.jsx)("label",{style:{fontSize:"14px",color:"#A3AEC2",marginBottom:"8px",display:"block"},children:"Withdrawal Address"}),(0,p.jsx)("input",{type:"text",value:h,onChange:e=>b(e.target.value),placeholder:"Enter ".concat(x," address"),className:"premium-input"})]}),(0,p.jsxs)("div",{style:{marginBottom:"24px",padding:"12px",background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,p.jsx)("span",{style:{fontSize:"13px",color:"#A3AEC2"},children:"Network Fee"}),(0,p.jsxs)("span",{style:{fontSize:"13px",color:"#FFFFFF"},children:["~0.0001 ",x]})]}),(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,p.jsx)("span",{style:{fontSize:"14px",color:"#FFFFFF",fontWeight:"600"},children:"You will receive"}),(0,p.jsxs)("span",{style:{fontSize:"14px",color:"#00F0FF",fontWeight:"600"},children:[y?(parseFloat(y)-1e-4).toFixed(8):"0.00000000"," ",x]})]})]}),(0,p.jsx)("button",{onClick:()=>{!y||parseFloat(y)<=0?l.oR.error("Please enter a valid amount"):!h||h.trim().length<20?l.oR.error("Please enter a valid withdrawal address"):parseFloat(y)>C?l.oR.error("Insufficient balance"):(B({currency:x,amount:parseFloat(y),address:h.trim()}),w(!0))},disabled:F||!y||!h,className:"premium-btn-primary",style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"600"},children:F?(0,p.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,p.jsx)(a.PSR,{size:18,style:{animation:"spin 1s linear infinite"}}),"Processing..."]}):"Withdraw "+x})]}),(0,p.jsxs)("div",{style:{background:"rgba(255, 191, 0, 0.05)",border:"1px solid rgba(255, 191, 0, 0.3)",borderRadius:"16px",padding:"16px",display:"flex",gap:"12px"},children:[(0,p.jsx)(s.dSe,{size:20,color:"#FBBF24",style:{flexShrink:0,marginTop:"2px"}}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#FBBF24",marginBottom:"4px"},children:"Important"}),(0,p.jsxs)("div",{style:{fontSize:"13px",color:"#FDE68A",lineHeight:"1.5"},children:["Double-check the withdrawal address. Sending ",x," to a wrong address will result in permanent loss. Withdrawals require OTP verification for security."]})]})]})]})}),j&&(0,p.jsx)(c.A,{isOpen:j,onClose:()=>{w(!1),B(null)},onVerify:async e=>{v(!0);try{const n=await i.A.post("".concat(u,"/api/nowpayments/withdraw"),{user_id:r.user_id,currency:S.currency,amount:S.amount,address:S.address,otp_code:e});n.data.success?(l.oR.success("Withdrawal request submitted successfully!"),f(""),b(""),w(!1),B(null),setTimeout(()=>{t("/wallet")},2e3)):l.oR.error(n.data.message||"Withdrawal failed")}catch(s){var n,o;console.error("Withdrawal error:",s),l.oR.error((null===(n=s.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message)||"Failed to process withdrawal")}finally{v(!1)}},action:"withdraw"})]})}}}]);
//# sourceMappingURL=1427.dff11061.chunk.js.map