"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6060],{6060:(e,r,i)=>{i.r(r),i.d(r,{default:()=>x});var t=i(9379),s=i(5043),n=i(8163),o=i(9722),l=i(3768),d=i(1817),a=i(221),c=i(579);const p="https://crypto-alert-hub-2.preview.emergentagent.com";const x=function(){var e,r;const{disputeId:i}=(0,n.g)(),x=(0,n.Zp)(),[g,f]=(0,s.useState)(null),[m,h]=(0,s.useState)(!0),[u,y]=(0,s.useState)(""),[b,v]=(0,s.useState)(!1),[j,S]=(0,s.useState)(window.innerWidth<=768),z=JSON.parse(localStorage.getItem("cryptobank_user")||"{}").user_id;(0,s.useEffect)(()=>{i&&w();const e=()=>S(window.innerWidth<=768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[i]);const w=async()=>{try{h(!0);const e="".concat(p,"/api/p2p/disputes/").concat(i,"?user_id=").concat(z),r=await o.A.get(e);r.data.success?f(r.data.dispute):(console.error("Invalid dispute response:",r.data),l.oR.error("Dispute not found"))}catch(s){var e,r,t;console.error("Error fetching dispute:",s),console.error("Error details:",null===(e=s.response)||void 0===e?void 0:e.data),l.oR.error((null===(r=s.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.detail)||"Failed to load dispute")}finally{h(!1)}},k=async()=>{if(u.trim())try{await o.A.post("".concat(p,"/api/p2p/disputes/").concat(i,"/message"),{user_id:z,message:u.trim()}),y(""),l.oR.success("Message sent"),w()}catch(e){console.error("Error sending message:",e),l.oR.error("Failed to send message")}};if(m)return(0,c.jsx)(d.A,{children:(0,c.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"#888",background:"linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%)",minHeight:"100vh"},children:"Loading dispute..."})});if(!g)return(0,c.jsx)(d.A,{children:(0,c.jsxs)("div",{style:{padding:"2rem",textAlign:"center",background:"linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%)",minHeight:"100vh"},children:[(0,c.jsx)("div",{style:{color:"#888",fontSize:"16px",marginBottom:"1rem"},children:"Dispute not found"}),(0,c.jsx)("button",{onClick:()=>x("/dashboard"),style:{padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #00F0FF, #A855F7)",border:"none",borderRadius:"8px",color:"#000",fontWeight:"700",cursor:"pointer"},children:"Back to Dashboard"})]})});const C={padding:"1.5rem",background:"rgba(15, 23, 42, 0.6)",border:"1px solid rgba(0, 240, 255, 0.2)",borderRadius:"12px"};return(0,c.jsx)(d.A,{children:(0,c.jsx)("div",{style:{background:"linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%)",minHeight:"100vh"},children:(0,c.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1.5rem"},children:[(0,c.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,c.jsx)("h1",{style:{fontSize:"28px",fontWeight:"900",color:"#00F0FF",margin:"0 0 1rem 0"},children:"Dispute Centre"}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[(0,c.jsxs)("span",{style:{color:"#888",fontSize:"14px"},children:["Dispute ID: ",g.dispute_id]}),(0,c.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:"open"===g.status?"rgba(252, 211, 77, 0.15)":"rgba(34, 197, 94, 0.15)",border:"1px solid ".concat("open"===g.status?"rgba(252, 211, 77, 0.4)":"rgba(34, 197, 94, 0.4)"),borderRadius:"6px"},children:["open"===g.status?(0,c.jsx)(a.tr_,{size:16,color:"#FCD34D"}):(0,c.jsx)(a.G3G,{size:16,color:"#22C55E"}),(0,c.jsx)("span",{style:{color:"open"===g.status?"#FCD34D":"#22C55E",fontWeight:"700",fontSize:"12px",textTransform:"uppercase"},children:g.status})]})]})]}),(0,c.jsxs)("div",{style:(0,t.A)((0,t.A)({},C),{},{marginBottom:"1.5rem"}),children:[(0,c.jsx)("h3",{style:{fontSize:"16px",fontWeight:"700",color:"#fff",margin:"0 0 1rem 0"},children:"Timeline"}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,c.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start"},children:[(0,c.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:"rgba(34, 197, 94, 0.15)",border:"2px solid #22C55E",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,c.jsx)(a.G3G,{size:18,color:"#22C55E"})}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"0.25rem"},children:"Order Created"}),(0,c.jsx)("div",{style:{color:"#888",fontSize:"13px"},children:null!==(e=g.trade)&&void 0!==e&&e.created_at?new Date(g.trade.created_at).toLocaleString():"N/A"})]})]}),(null===(r=g.trade)||void 0===r?void 0:r.payment_marked_at)&&(0,c.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start"},children:[(0,c.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:"rgba(34, 197, 94, 0.15)",border:"2px solid #22C55E",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,c.jsx)(a.G3G,{size:18,color:"#22C55E"})}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"0.25rem"},children:"Payment Marked"}),(0,c.jsx)("div",{style:{color:"#888",fontSize:"13px"},children:new Date(g.trade.payment_marked_at).toLocaleString()})]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start"},children:[(0,c.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:"rgba(252, 211, 77, 0.15)",border:"2px solid #FCD34D",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,c.jsx)(a.tr_,{size:18,color:"#FCD34D"})}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"0.25rem"},children:"Dispute Opened"}),(0,c.jsx)("div",{style:{color:"#888",fontSize:"13px",marginBottom:"0.25rem"},children:new Date(g.created_at).toLocaleString()}),g.reason&&(0,c.jsxs)("div",{style:{color:"#666",fontSize:"12px"},children:["Reason: ",g.reason]})]})]}),"resolved"===g.status&&(0,c.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start"},children:[(0,c.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:"rgba(34, 197, 94, 0.15)",border:"2px solid #22C55E",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,c.jsx)(a.G3G,{size:18,color:"#22C55E"})}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"0.25rem"},children:"Admin Decision"}),(0,c.jsx)("div",{style:{color:"#888",fontSize:"13px",marginBottom:"0.25rem"},children:new Date(g.resolved_at).toLocaleString()}),(0,c.jsx)("div",{style:{color:"#22C55E",fontSize:"13px",fontWeight:"600"},children:"release_to_buyer"===g.resolution?"Crypto released to buyer":"Funds returned to seller"})]})]})]})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:j?"1fr":"1fr 1fr",gap:"1.5rem",alignItems:"start"},children:[(0,c.jsxs)("div",{style:(0,t.A)((0,t.A)({},C),{},{display:"flex",flexDirection:"column",height:j?"auto":"500px",overflow:"hidden"}),children:[(0,c.jsxs)("h3",{style:{fontSize:"16px",fontWeight:"700",color:"#fff",margin:"0 0 1rem 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,c.jsx)(a.mNJ,{size:18})," Dispute Chat"]}),(0,c.jsx)("div",{style:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1rem",minHeight:j?"300px":"auto"},children:g.messages&&g.messages.length>0?g.messages.map((e,r)=>{const i=e.user_id===z,t=e.user_id===g.buyer_id;return(0,c.jsxs)("div",{style:{padding:"0.875rem",background:i?"rgba(0, 240, 255, 0.1)":"rgba(168, 85, 247, 0.1)",border:"1px solid ".concat(i?"rgba(0, 240, 255, 0.3)":"rgba(168, 85, 247, 0.3)"),borderRadius:"8px",width:"85%",alignSelf:i?"flex-end":"flex-start",wordWrap:"break-word",boxSizing:"border-box"},children:[(0,c.jsxs)("div",{style:{color:"#888",fontSize:"11px",marginBottom:"0.375rem",fontWeight:"600"},children:[t?"Buyer":"Seller"," \u2022 ",new Date(e.timestamp).toLocaleTimeString()]}),(0,c.jsx)("div",{style:{color:"#fff",fontSize:"13px",lineHeight:"1.5"},children:e.message})]},r)}):(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#666",fontSize:"13px"},children:"No messages yet. Start the conversation."})}),"open"===g.status&&(0,c.jsxs)("div",{style:{display:"flex",gap:"0.75rem",width:"100%",boxSizing:"border-box"},children:[(0,c.jsx)("input",{type:"text",value:u,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&k(),placeholder:"Type your message...",style:{flex:1,padding:"0.875rem",background:"rgba(0, 0, 0, 0.5)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"8px",color:"#fff",fontSize:"14px",boxSizing:"border-box"}}),(0,c.jsxs)("button",{onClick:k,disabled:!u.trim(),style:{padding:"0.875rem 1.25rem",background:u.trim()?"linear-gradient(135deg, #00F0FF, #A855F7)":"rgba(100, 100, 100, 0.3)",border:"none",borderRadius:"8px",color:u.trim()?"#000":"#666",fontWeight:"700",cursor:u.trim()?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"14px",whiteSpace:"nowrap",boxSizing:"border-box"},children:[(0,c.jsx)(a.$_z,{size:16})," Send"]})]})]}),(0,c.jsxs)("div",{style:(0,t.A)((0,t.A)({},C),{},{display:"flex",flexDirection:"column",height:j?"auto":"500px"}),children:[(0,c.jsxs)("h3",{style:{fontSize:"16px",fontWeight:"700",color:"#fff",margin:"0 0 1rem 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,c.jsx)(a.mk,{size:18})," Evidence & Attachments"]}),"open"===g.status&&(0,c.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,c.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.875rem 1.25rem",background:b?"rgba(100, 100, 100, 0.3)":"linear-gradient(135deg, #22C55E, #16A34A)",border:"none",borderRadius:"8px",color:"#fff",fontWeight:"700",cursor:b?"not-allowed":"pointer",opacity:b?.5:1,fontSize:"14px"},children:[(0,c.jsx)(a.xvb,{size:16})," ",b?"Uploading...":"Upload Evidence",(0,c.jsx)("input",{type:"file",accept:"image/*,.pdf",onChange:async e=>{const r=e.target.files[0];if(!r)return;if(["image/png","image/jpeg","image/jpg","application/pdf"].includes(r.type))if(r.size>5242880)l.oR.error("File size must be less than 5MB");else try{v(!0);const e=new FileReader;e.onloadend=async()=>{try{await o.A.post("".concat(p,"/api/p2p/disputes/").concat(i,"/evidence"),{user_id:z,file_name:r.name,file_type:r.type,file_data:e.result,description:"Evidence uploaded by user"}),l.oR.success("Evidence uploaded successfully"),w()}catch(t){console.error("Error uploading evidence:",t),l.oR.error("Failed to upload evidence")}finally{v(!1)}},e.readAsDataURL(r)}catch(t){console.error("Error processing file:",t),l.oR.error("Failed to process file"),v(!1)}else l.oR.error("Only images (PNG, JPG) and PDFs are allowed")},disabled:b,style:{display:"none"}})]}),(0,c.jsx)("div",{style:{color:"#666",fontSize:"11px",marginTop:"0.5rem"},children:"Images (PNG, JPG) and PDF \u2022 Max 5MB"})]}),(0,c.jsx)("div",{style:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:"0.75rem",minHeight:j?"200px":"auto"},children:g.evidence&&g.evidence.length>0?g.evidence.map((e,r)=>{const i=e.file_type.startsWith("image/");return(0,c.jsxs)("div",{style:{padding:"1rem",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"1rem"},children:[(0,c.jsx)("div",{style:{width:"44px",height:"44px",borderRadius:"8px",background:i?"rgba(0, 240, 255, 0.1)":"rgba(239, 68, 68, 0.1)",border:"1px solid ".concat(i?"rgba(0, 240, 255, 0.3)":"rgba(239, 68, 68, 0.3)"),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:i?(0,c.jsx)(ImageIcon,{size:20,color:"#00F0FF"}):(0,c.jsx)(a.mk,{size:20,color:"#EF4444"})}),(0,c.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,c.jsx)("div",{style:{color:"#fff",fontSize:"13px",fontWeight:"600",marginBottom:"0.25rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.file_name}),(0,c.jsxs)("div",{style:{color:"#888",fontSize:"11px"},children:["Uploaded by ",e.user_id===g.buyer_id?"Buyer":"Seller"]}),(0,c.jsx)("div",{style:{color:"#666",fontSize:"11px"},children:new Date(e.uploaded_at).toLocaleString()})]})]},r)}):(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#666",fontSize:"13px"},children:"No evidence uploaded yet"})})]})]})]})})})}}}]);
//# sourceMappingURL=6060.6a95a9ba.chunk.js.map