{"ast":null,"code":"import React,{useState}from'react';import{IoClose,IoWarning,IoAlertCircle}from'react-icons/io5';import axios from'axios';import{toast}from'sonner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API=process.env.REACT_APP_BACKEND_URL;export default function DisputeModal(_ref){let{isOpen,onClose,tradeId,userId,onDisputeCreated}=_ref;const[reason,setReason]=useState('');const[description,setDescription]=useState('');const[loading,setLoading]=useState(false);const reasonOptions=[{value:'payment_not_received',label:'Payment Not Received'},{value:'wrong_amount',label:'Wrong Amount Received'},{value:'crypto_not_released',label:'Crypto Not Released'},{value:'scam_attempt',label:'Suspected Scam'},{value:'other',label:'Other Issue'}];const handleSubmit=async()=>{if(!reason||!description.trim()){toast.error('Please select a reason and provide details');return;}setLoading(true);try{const response=await axios.post(\"\".concat(API,\"/api/p2p/disputes/create\"),{trade_id:tradeId,initiated_by:userId,reason:reason,description:description});if(response.data.success){toast.success('Dispute opened. Admin will review shortly.');onDisputeCreated(response.data.dispute);onClose();}else{toast.error(response.data.message||'Failed to open dispute');}}catch(error){var _error$response,_error$response$data;console.error('Error opening dispute:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Failed to open dispute');}finally{setLoading(false);}};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-900 border-2 border-orange-500 rounded-2xl max-w-lg w-full shadow-2xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-orange-600 to-red-600 p-6 rounded-t-2xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(IoWarning,{className:\"w-8 h-8 text-white\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white\",children:\"Open Dispute\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-white/80 hover:text-white transition-colors\",children:/*#__PURE__*/_jsx(IoClose,{className:\"w-6 h-6\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-orange-500/10 border-l-4 border-orange-500 p-4 m-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsx(IoAlertCircle,{className:\"w-6 h-6 text-orange-400 flex-shrink-0 mt-0.5\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-orange-300 font-semibold mb-1\",children:\"Dispute Fee: \\xA35\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 text-sm\",children:\"Opening a dispute will lock this trade. The losing party will be charged a \\xA35 dispute fee. Please only open disputes for legitimate issues.\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-300 font-semibold mb-2\",children:\"Reason for Dispute *\"}),/*#__PURE__*/_jsxs(\"select\",{value:reason,onChange:e=>setReason(e.target.value),className:\"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a reason...\"}),reasonOptions.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-300 font-semibold mb-2\",children:\"Detailed Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:description,onChange:e=>setDescription(e.target.value),placeholder:\"Provide as much detail as possible about the issue. Include timestamps, transaction IDs, screenshots, etc.\",rows:5,className:\"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none resize-none\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-500 text-sm mt-1\",children:[description.length,\"/500 characters\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg transition-colors font-semibold\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,disabled:loading||!reason||!description.trim(),className:\"flex-1 bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg transition-all font-semibold\",children:loading?'Opening Dispute...':'Open Dispute'})]})]})]})});}","map":{"version":3,"names":["React","useState","IoClose","IoWarning","IoAlertCircle","axios","toast","jsx","_jsx","jsxs","_jsxs","API","process","env","REACT_APP_BACKEND_URL","DisputeModal","_ref","isOpen","onClose","tradeId","userId","onDisputeCreated","reason","setReason","description","setDescription","loading","setLoading","reasonOptions","value","label","handleSubmit","trim","error","response","post","concat","trade_id","initiated_by","data","success","dispute","message","_error$response","_error$response$data","console","detail","className","children","onClick","onChange","e","target","map","opt","placeholder","rows","length","disabled"],"sources":["/app/frontend/src/components/DisputeModal.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { IoClose, IoWarning, IoAlertCircle } from 'react-icons/io5';\nimport axios from 'axios';\nimport { toast } from 'sonner';\n\nconst API = process.env.REACT_APP_BACKEND_URL;\n\nexport default function DisputeModal({ isOpen, onClose, tradeId, userId, onDisputeCreated }) {\n  const [reason, setReason] = useState('');\n  const [description, setDescription] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const reasonOptions = [\n    { value: 'payment_not_received', label: 'Payment Not Received' },\n    { value: 'wrong_amount', label: 'Wrong Amount Received' },\n    { value: 'crypto_not_released', label: 'Crypto Not Released' },\n    { value: 'scam_attempt', label: 'Suspected Scam' },\n    { value: 'other', label: 'Other Issue' }\n  ];\n\n  const handleSubmit = async () => {\n    if (!reason || !description.trim()) {\n      toast.error('Please select a reason and provide details');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const response = await axios.post(`${API}/api/p2p/disputes/create`, {\n        trade_id: tradeId,\n        initiated_by: userId,\n        reason: reason,\n        description: description\n      });\n\n      if (response.data.success) {\n        toast.success('Dispute opened. Admin will review shortly.');\n        onDisputeCreated(response.data.dispute);\n        onClose();\n      } else {\n        toast.error(response.data.message || 'Failed to open dispute');\n      }\n    } catch (error) {\n      console.error('Error opening dispute:', error);\n      toast.error(error.response?.data?.detail || 'Failed to open dispute');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n      <div className=\"bg-slate-900 border-2 border-orange-500 rounded-2xl max-w-lg w-full shadow-2xl\">\n        {/* Header */}\n        <div className=\"bg-gradient-to-r from-orange-600 to-red-600 p-6 rounded-t-2xl\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <IoWarning className=\"w-8 h-8 text-white\" />\n              <h2 className=\"text-2xl font-bold text-white\">Open Dispute</h2>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-white/80 hover:text-white transition-colors\"\n            >\n              <IoClose className=\"w-6 h-6\" />\n            </button>\n          </div>\n        </div>\n\n        {/* Warning */}\n        <div className=\"bg-orange-500/10 border-l-4 border-orange-500 p-4 m-6\">\n          <div className=\"flex items-start gap-3\">\n            <IoAlertCircle className=\"w-6 h-6 text-orange-400 flex-shrink-0 mt-0.5\" />\n            <div>\n              <p className=\"text-orange-300 font-semibold mb-1\">Dispute Fee: £5</p>\n              <p className=\"text-gray-400 text-sm\">\n                Opening a dispute will lock this trade. The losing party will be charged a £5 dispute fee.\n                Please only open disputes for legitimate issues.\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {/* Form */}\n        <div className=\"p-6 space-y-4\">\n          {/* Reason Selection */}\n          <div>\n            <label className=\"block text-gray-300 font-semibold mb-2\">\n              Reason for Dispute *\n            </label>\n            <select\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              className=\"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none\"\n            >\n              <option value=\"\">Select a reason...</option>\n              {reasonOptions.map(opt => (\n                <option key={opt.value} value={opt.value}>{opt.label}</option>\n              ))}\n            </select>\n          </div>\n\n          {/* Description */}\n          <div>\n            <label className=\"block text-gray-300 font-semibold mb-2\">\n              Detailed Description *\n            </label>\n            <textarea\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              placeholder=\"Provide as much detail as possible about the issue. Include timestamps, transaction IDs, screenshots, etc.\"\n              rows={5}\n              className=\"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none resize-none\"\n            />\n            <p className=\"text-gray-500 text-sm mt-1\">\n              {description.length}/500 characters\n            </p>\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex gap-3 pt-4\">\n            <button\n              onClick={onClose}\n              className=\"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg transition-colors font-semibold\"\n            >\n              Cancel\n            </button>\n            <button\n              onClick={handleSubmit}\n              disabled={loading || !reason || !description.trim()}\n              className=\"flex-1 bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg transition-all font-semibold\"\n            >\n              {loading ? 'Opening Dispute...' : 'Open Dispute'}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}