{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate,useParams}from'react-router-dom';import Layout from'@/components/Layout';import{IoCheckmarkCircle,IoClose,IoSend,IoCloudUpload,IoWarning,IoTime,IoShield,IoEyeOff}from'react-icons/io5';import axios from'axios';import{toast}from'sonner';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API=process.env.REACT_APP_BACKEND_URL;export default function P2POrderPage(){const{tradeId}=useParams();const navigate=useNavigate();const[trade,setTrade]=useState(null);const[loading,setLoading]=useState(true);const[currentUser,setCurrentUser]=useState(null);const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[processing,setProcessing]=useState(false);const[countdown,setCountdown]=useState(0);const[paymentProof,setPaymentProof]=useState(null);const[disputeReason,setDisputeReason]=useState('');const[showDisputeModal,setShowDisputeModal]=useState(false);const[showFeedbackModal,setShowFeedbackModal]=useState(false);const[feedbackRating,setFeedbackRating]=useState('positive');const[feedbackComment,setFeedbackComment]=useState('');const[isBlocked,setIsBlocked]=useState(false);const[checkingBlock,setCheckingBlock]=useState(true);// Show feedback modal for completed trades\nuseEffect(()=>{if(trade&&trade.status==='completed'&&!showFeedbackModal){// Check if user already left feedback\nconst checkFeedback=async()=>{try{const response=await axios.get(\"\".concat(API,\"/api/p2p/trade/\").concat(tradeId,\"/feedback-check?user_id=\").concat(currentUser===null||currentUser===void 0?void 0:currentUser.user_id));if(!response.data.feedback_given){setTimeout(()=>setShowFeedbackModal(true),1000);}}catch(error){// If endpoint doesn't exist, show modal anyway\nsetTimeout(()=>setShowFeedbackModal(true),1000);}};if(currentUser)checkFeedback();}},[trade===null||trade===void 0?void 0:trade.status,currentUser]);useEffect(()=>{const userData=localStorage.getItem('cryptobank_user');if(!userData){navigate('/login');return;}const user=JSON.parse(userData);setCurrentUser(user);fetchTrade(user.user_id);// Poll for updates\nconst interval=setInterval(()=>fetchTrade(user.user_id),5000);return()=>clearInterval(interval);},[tradeId,navigate]);// Check block status when trade is loaded\nuseEffect(()=>{if(trade&&currentUser){const counterpartyId=isBuyer?trade.seller_id:trade.buyer_id;checkBlockStatus(counterpartyId);}},[trade,currentUser]);useEffect(()=>{if(trade&&trade.expires_at){const updateCountdown=setInterval(()=>{const now=new Date();const expires=new Date(trade.expires_at);const remaining=Math.floor((expires-now)/1000);if(remaining<=0){setCountdown(0);clearInterval(updateCountdown);}else{setCountdown(remaining);}},1000);return()=>clearInterval(updateCountdown);}},[trade]);const fetchTrade=async userId=>{try{const response=await axios.get(\"\".concat(API,\"/api/p2p/trade/\").concat(tradeId,\"?user_id=\").concat(userId));if(response.data.success){setTrade(response.data.trade);if(response.data.messages){setMessages(response.data.messages);}// Check if this trade involves a blocked user\nif(response.data.blocked){toast.error('This trade involves a blocked user. Redirecting...');setTimeout(()=>navigate('/p2p'),2000);}}}catch(error){var _error$response;console.error('Error fetching trade:',error);if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===403){toast.error('Access denied: User is blocked');navigate('/p2p');}else{toast.error('Failed to load trade details');}}finally{setLoading(false);}};const handleSendMessage=async()=>{if(!newMessage.trim()&&!paymentProof)return;setProcessing(true);try{const formData=new FormData();formData.append('trade_id',tradeId);formData.append('sender_id',currentUser.user_id);formData.append('message',newMessage);if(paymentProof){formData.append('attachment',paymentProof);}const response=await axios.post(\"\".concat(API,\"/api/p2p/trade/message\"),formData,{headers:{'Content-Type':'multipart/form-data'}});if(response.data.success){setNewMessage('');setPaymentProof(null);fetchTrade(currentUser.user_id);}}catch(error){toast.error('Failed to send message');}finally{setProcessing(false);}};const handleMarkAsPaid=async()=>{setProcessing(true);try{const response=await axios.post(\"\".concat(API,\"/api/p2p/trade/mark-paid\"),{trade_id:tradeId,user_id:currentUser.user_id});if(response.data.success){toast.success('âœ… Payment marked! Waiting for seller to release.');fetchTrade(currentUser.user_id);}}catch(error){var _error$response2,_error$response2$data;toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||'Failed to mark as paid');}finally{setProcessing(false);}};const handleReleaseCrypto=async()=>{setProcessing(true);try{const response=await axios.post(\"\".concat(API,\"/api/p2p/trade/release\"),{trade_id:tradeId,user_id:currentUser.user_id});if(response.data.success){toast.success('âœ… Crypto released successfully!');fetchTrade(currentUser.user_id);}}catch(error){var _error$response3,_error$response3$data;toast.error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.detail)||'Failed to release crypto');}finally{setProcessing(false);}};const handleOpenDispute=async()=>{if(!disputeReason.trim()){toast.error('Please provide a reason for dispute');return;}setProcessing(true);try{const response=await axios.post(\"\".concat(API,\"/api/p2p/trade/dispute\"),{trade_id:tradeId,user_id:currentUser.user_id,reason:disputeReason});if(response.data.success){toast.success('Dispute opened. Admin will review.');setShowDisputeModal(false);fetchTrade(currentUser.user_id);}}catch(error){var _error$response4,_error$response4$data;toast.error(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.detail)||'Failed to open dispute');}finally{setProcessing(false);}};const handleCancel=async()=>{if(!window.confirm('Are you sure you want to cancel this order?'))return;setProcessing(true);try{const response=await axios.post(\"\".concat(API,\"/api/p2p/trade/cancel\"),{trade_id:tradeId,user_id:currentUser.user_id});if(response.data.success){toast.success('Order cancelled');fetchTrade(currentUser.user_id);}}catch(error){var _error$response5,_error$response5$data;toast.error(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.detail)||'Failed to cancel');}finally{setProcessing(false);}};const handleSubmitFeedback=async()=>{if(!feedbackComment.trim()&&feedbackRating===''){toast.error('Please provide a rating');return;}setProcessing(true);try{const response=await axios.post(\"\".concat(API,\"/api/p2p/trade/\").concat(tradeId,\"/feedback\"),{from_user_id:currentUser.user_id,rating:feedbackRating,comment:feedbackComment.trim()});if(response.data.success){toast.success('âœ… Feedback submitted!');setShowFeedbackModal(false);setFeedbackRating('positive');setFeedbackComment('');}}catch(error){var _error$response6,_error$response6$data;toast.error(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.detail)||'Failed to submit feedback');}finally{setProcessing(false);}};const checkBlockStatus=async counterpartyId=>{try{const response=await axios.get(\"\".concat(API,\"/api/p2p/blocked/\").concat(currentUser.user_id));if(response.data.success){const blockedList=response.data.blocked_users||[];setIsBlocked(blockedList.includes(counterpartyId));}}catch(error){console.error('Error checking block status:',error);}finally{setCheckingBlock(false);}};const handleBlockToggle=async()=>{const counterpartyId=isBuyer?trade.seller_id:trade.buyer_id;setProcessing(true);try{const endpoint=isBlocked?'/api/p2p/block/remove':'/api/p2p/block/add';const response=await axios.post(\"\".concat(API).concat(endpoint),{user_id:currentUser.user_id,blocked_user_id:counterpartyId});if(response.data.success){setIsBlocked(!isBlocked);toast.success(isBlocked?'âœ… User unblocked - Marketplace will update':'ğŸš« User blocked - Redirecting to marketplace...');// If blocked a favourite, remove from favourites\nif(!isBlocked){try{await axios.post(\"\".concat(API,\"/api/p2p/favourites/remove\"),{user_id:currentUser.user_id,merchant_id:counterpartyId});}catch(e){console.error('Failed to remove from favourites:',e);}}// Redirect to marketplace after blocking so user sees updated list\nsetTimeout(()=>{navigate('/p2p');},1500);}}catch(error){var _error$response7,_error$response7$data;toast.error(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.detail)||'Failed to update block status');}finally{setProcessing(false);}};if(loading){return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(\"div\",{style:{padding:'40px',textAlign:'center',color:'#fff'},children:\"Loading...\"})});}if(!trade){return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(\"div\",{style:{padding:'40px',textAlign:'center',color:'#fff'},children:\"Trade not found\"})});}const isBuyer=(currentUser===null||currentUser===void 0?void 0:currentUser.user_id)===trade.buyer_id;const counterparty=isBuyer?'Seller':'Buyer';return/*#__PURE__*/_jsxs(Layout,{children:[/*#__PURE__*/_jsx(\"div\",{style:{minHeight:'100vh',padding:'40px 20px',background:'linear-gradient(180deg, #05121F 0%, #071E2C 100%)'},children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:'1200px',margin:'0 auto'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #0A1929 0%, #051018 100%)',border:'1px solid rgba(0, 198, 255, 0.2)',borderRadius:'16px',padding:'24px',marginBottom:'24px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{fontSize:'28px',fontWeight:'700',color:'#FFFFFF'},children:[isBuyer?'Buy':'Sell',\" \",trade.crypto_currency]}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'8px 16px',background:trade.status==='completed'?'rgba(34, 197, 94, 0.1)':'rgba(255, 165, 0, 0.1)',border:\"1px solid \".concat(trade.status==='completed'?'rgba(34, 197, 94, 0.3)':'rgba(255, 165, 0, 0.3)'),borderRadius:'8px',color:trade.status==='completed'?'#22C55E':'#FFA500',fontWeight:'600'},children:trade.status==='pending_payment'?'Waiting for Payment':trade.status==='payment_made'?'Payment Made':trade.status==='completed'?'Completed':trade.status==='cancelled'?'Cancelled':trade.status==='disputed'?'Disputed':trade.status})]}),countdown>0&&trade.status==='pending_payment'&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px',padding:'12px',background:'rgba(239, 68, 68, 0.1)',border:'1px solid rgba(239, 68, 68, 0.3)',borderRadius:'8px'},children:[/*#__PURE__*/_jsx(IoTime,{size:20,color:\"#EF4444\"}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#EF4444',fontWeight:'600'},children:[\"Time remaining: \",Math.floor(countdown/60),\":\",(countdown%60).toString().padStart(2,'0')]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 400px',gap:'24px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #0A1929 0%, #051018 100%)',border:'1px solid rgba(0, 198, 255, 0.2)',borderRadius:'16px',padding:'24px',marginBottom:'24px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'20px',fontWeight:'700',color:'#FFFFFF',marginBottom:'16px'},children:\"Order Details\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'#8F9BB3'},children:\"Amount\"}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#FFFFFF',fontWeight:'600'},children:[trade.crypto_amount,\" \",trade.crypto_currency]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'#8F9BB3'},children:\"Price\"}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#FFFFFF',fontWeight:'600'},children:[\"\\xA3\",(trade.fiat_amount/trade.crypto_amount).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'#8F9BB3'},children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#00C6FF',fontWeight:'700',fontSize:'20px'},children:[\"\\xA3\",trade.fiat_amount.toFixed(2)]})]})]})]}),isBuyer&&trade.seller_payment_details&&trade.status==='pending_payment'&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #0A1929 0%, #051018 100%)',border:'1px solid rgba(255, 165, 0, 0.3)',borderRadius:'16px',padding:'24px',marginBottom:'24px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(IoShield,{size:24,color:\"#FFA500\"}),/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'20px',fontWeight:'700',color:'#FFFFFF'},children:\"Payment Instructions\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{background:'rgba(255, 165, 0, 0.05)',padding:'16px',borderRadius:'8px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#8F9BB3',marginBottom:'4px'},children:\"Bank Name\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#FFFFFF',fontWeight:'600'},children:trade.seller_payment_details.bank_name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#8F9BB3',marginBottom:'4px'},children:\"Account Name\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#FFFFFF',fontWeight:'600'},children:trade.seller_payment_details.account_name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#8F9BB3',marginBottom:'4px'},children:\"Account Number\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#FFFFFF',fontWeight:'600'},children:trade.seller_payment_details.account_number})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#8F9BB3',marginBottom:'4px'},children:\"Sort Code\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#FFFFFF',fontWeight:'600'},children:trade.seller_payment_details.sort_code})]}),trade.seller_payment_details.notes&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#8F9BB3',marginBottom:'4px'},children:\"Notes\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#FFA500'},children:trade.seller_payment_details.notes})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',flexWrap:'wrap'},children:[isBuyer&&trade.status==='pending_payment'&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleMarkAsPaid,disabled:processing,style:{flex:1,padding:'16px',background:'linear-gradient(135deg, #22C55E, #16A34A)',border:'none',borderRadius:'12px',color:'#FFFFFF',fontSize:'16px',fontWeight:'700',cursor:processing?'not-allowed':'pointer',boxShadow:'0 0 20px rgba(34, 197, 94, 0.4)'},children:[/*#__PURE__*/_jsx(IoCheckmarkCircle,{size:20,style:{marginRight:'8px',verticalAlign:'middle'}}),\"Mark as Paid\"]}),!isBuyer&&trade.status==='payment_made'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleReleaseCrypto,disabled:processing,style:{flex:1,padding:'16px',background:'linear-gradient(135deg, #22C55E, #16A34A)',border:'none',borderRadius:'12px',color:'#FFFFFF',fontSize:'16px',fontWeight:'700',cursor:processing?'not-allowed':'pointer',boxShadow:'0 0 20px rgba(34, 197, 94, 0.4)'},children:\"Release Crypto\"}),trade.status==='completed'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFeedbackModal(true),style:{flex:1,padding:'16px',background:'linear-gradient(135deg, #FFA500, #FF8C00)',border:'none',borderRadius:'12px',color:'#FFFFFF',fontSize:'16px',fontWeight:'700',cursor:'pointer',boxShadow:'0 0 20px rgba(255, 165, 0, 0.4)'},children:\"\\u2B50 Rate This Trade\"}),trade.status!=='completed'&&trade.status!=='cancelled'&&trade.status!=='disputed'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowDisputeModal(true),disabled:processing,style:{padding:'16px 24px',background:'rgba(239, 68, 68, 0.1)',border:'1px solid rgba(239, 68, 68, 0.3)',borderRadius:'12px',color:'#EF4444',fontSize:'16px',fontWeight:'600',cursor:processing?'not-allowed':'pointer'},children:[/*#__PURE__*/_jsx(IoWarning,{size:20,style:{marginRight:'8px',verticalAlign:'middle'}}),\"Dispute\"]}),isBuyer&&trade.status==='pending_payment'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleCancel,disabled:processing,style:{padding:'16px 24px',background:'rgba(143, 155, 179, 0.1)',border:'1px solid rgba(143, 155, 179, 0.3)',borderRadius:'12px',color:'#8F9BB3',fontSize:'16px',fontWeight:'600',cursor:processing?'not-allowed':'pointer'},children:\"Cancel Order\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #0A1929 0%, #051018 100%)',border:'1px solid rgba(0, 198, 255, 0.2)',borderRadius:'16px',padding:'24px',height:'fit-content'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{fontSize:'20px',fontWeight:'700',color:'#FFFFFF',margin:0},children:[\"Chat with \",counterparty]}),!checkingBlock&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleBlockToggle,disabled:processing,title:isBlocked?'Unblock user':'Block user',style:{padding:'8px 16px',background:isBlocked?'rgba(239, 68, 68, 0.1)':'rgba(143, 155, 179, 0.1)',border:\"1px solid \".concat(isBlocked?'rgba(239, 68, 68, 0.3)':'rgba(143, 155, 179, 0.3)'),borderRadius:'8px',color:isBlocked?'#EF4444':'#8F9BB3',fontSize:'12px',fontWeight:'600',cursor:processing?'not-allowed':'pointer',display:'flex',alignItems:'center',gap:'6px',transition:'all 0.2s'},children:[/*#__PURE__*/_jsx(IoEyeOff,{size:14}),isBlocked?'Unblock':'Block']})]}),/*#__PURE__*/_jsx(\"div\",{style:{height:'400px',overflowY:'auto',marginBottom:'16px',padding:'12px',background:'rgba(0, 0, 0, 0.2)',borderRadius:'8px'},children:messages.length===0?/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',color:'#8F9BB3',padding:'40px'},children:\"No messages yet\"}):messages.map((msg,idx)=>{const isSystem=msg.sender_id==='SYSTEM';const isCurrentUser=msg.sender_id===currentUser.user_id;return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'12px',padding:'12px',background:isSystem?'rgba(255, 165, 0, 0.15)':isCurrentUser?'rgba(0, 198, 255, 0.1)':'rgba(143, 155, 179, 0.1)',border:isSystem?'1px solid rgba(255, 165, 0, 0.3)':'none',borderRadius:'8px',textAlign:isSystem?'center':isCurrentUser?'right':'left'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'11px',color:isSystem?'#FFA500':'#8F9BB3',marginBottom:'4px',fontWeight:isSystem?'700':'600'},children:[isSystem?'ğŸ¤– SYSTEM':isCurrentUser?'You':counterparty,msg.timestamp&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'8px',fontSize:'10px',opacity:0.7},children:new Date(msg.timestamp).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})})]}),/*#__PURE__*/_jsx(\"div\",{style:{color:isSystem?'#FFA500':'#FFFFFF',fontWeight:isSystem?'600':'400'},children:msg.message}),msg.attachment&&/*#__PURE__*/_jsx(\"img\",{src:msg.attachment,alt:\"proof\",style:{maxWidth:'200px',marginTop:'8px',borderRadius:'4px',cursor:'pointer'},onClick:()=>window.open(msg.attachment,'_blank')})]},idx);})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',flexDirection:'column'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:e=>setNewMessage(e.target.value),onKeyPress:e=>e.key==='Enter'&&handleSendMessage(),placeholder:\"Type a message...\",style:{flex:1,padding:'12px',background:'rgba(0, 0, 0, 0.3)',border:'1px solid rgba(0, 198, 255, 0.2)',borderRadius:'8px',color:'#FFFFFF',fontSize:'14px'}}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,disabled:processing||!newMessage.trim()&&!paymentProof,style:{padding:'12px 20px',background:'linear-gradient(135deg, #00C6FF, #0099CC)',border:'none',borderRadius:'8px',color:'#FFFFFF',cursor:processing?'not-allowed':'pointer'},children:/*#__PURE__*/_jsx(IoSend,{size:20})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>setPaymentProof(e.target.files[0]),id:\"proof-upload\",style:{display:'none'}}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"proof-upload\",style:{display:'inline-flex',alignItems:'center',gap:'8px',padding:'8px 16px',background:'rgba(0, 198, 255, 0.1)',border:'1px solid rgba(0, 198, 255, 0.3)',borderRadius:'8px',color:'#00C6FF',fontSize:'14px',cursor:'pointer'},children:[/*#__PURE__*/_jsx(IoCloudUpload,{size:20}),paymentProof?paymentProof.name:'Upload Payment Proof']})]})]})]})]})]})}),showDisputeModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.85)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #0A1929 0%, #051018 100%)',border:'1px solid rgba(239, 68, 68, 0.3)',borderRadius:'16px',padding:'32px',maxWidth:'480px',width:'90%'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'24px',fontWeight:'700',color:'#FFFFFF',marginBottom:'16px'},children:\"Open Dispute\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#8F9BB3',marginBottom:'16px'},children:\"Please explain why you are opening a dispute. Admin will review and resolve.\"}),/*#__PURE__*/_jsx(\"textarea\",{value:disputeReason,onChange:e=>setDisputeReason(e.target.value),placeholder:\"Describe the issue...\",style:{width:'100%',height:'120px',padding:'12px',background:'rgba(0, 0, 0, 0.3)',border:'1px solid rgba(239, 68, 68, 0.3)',borderRadius:'8px',color:'#FFFFFF',fontSize:'14px',marginBottom:'16px',resize:'vertical'}}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowDisputeModal(false),style:{flex:1,padding:'12px',background:'rgba(143, 155, 179, 0.1)',border:'1px solid rgba(143, 155, 179, 0.3)',borderRadius:'8px',color:'#8F9BB3',fontWeight:'600',cursor:'pointer'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleOpenDispute,disabled:processing||!disputeReason.trim(),style:{flex:1,padding:'12px',background:'linear-gradient(135deg, #EF4444, #DC2626)',border:'none',borderRadius:'8px',color:'#FFFFFF',fontWeight:'700',cursor:processing||!disputeReason.trim()?'not-allowed':'pointer'},children:\"Submit Dispute\"})]})]})}),showFeedbackModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.85)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #0A1929 0%, #051018 100%)',border:'1px solid rgba(0, 198, 255, 0.3)',borderRadius:'16px',padding:'32px',maxWidth:'480px',width:'90%'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'24px',fontWeight:'700',color:'#FFFFFF',marginBottom:'16px'},children:\"Rate Your Counterparty\"}),/*#__PURE__*/_jsxs(\"p\",{style:{color:'#8F9BB3',marginBottom:'20px'},children:[\"How was your experience with \",counterparty,\"?\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#8F9BB3',fontSize:'14px',display:'block',marginBottom:'8px'},children:\"Rating *\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',gap:'12px'},children:['positive','neutral','negative'].map(rating=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setFeedbackRating(rating),style:{flex:1,padding:'12px',background:feedbackRating===rating?rating==='positive'?'rgba(34, 197, 94, 0.2)':rating==='neutral'?'rgba(255, 165, 0, 0.2)':'rgba(239, 68, 68, 0.2)':'rgba(143, 155, 179, 0.1)',border:feedbackRating===rating?rating==='positive'?'2px solid #22C55E':rating==='neutral'?'2px solid #FFA500':'2px solid #EF4444':'1px solid rgba(143, 155, 179, 0.3)',borderRadius:'8px',color:feedbackRating===rating?rating==='positive'?'#22C55E':rating==='neutral'?'#FFA500':'#EF4444':'#8F9BB3',fontWeight:feedbackRating===rating?'700':'400',cursor:'pointer',fontSize:'14px'},children:rating==='positive'?'ğŸ‘ Positive':rating==='neutral'?'ğŸ˜ Neutral':'ğŸ‘ Negative'},rating))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#8F9BB3',fontSize:'14px',display:'block',marginBottom:'8px'},children:\"Comment (Optional)\"}),/*#__PURE__*/_jsx(\"textarea\",{value:feedbackComment,onChange:e=>setFeedbackComment(e.target.value),placeholder:\"Share your experience... (max 500 characters)\",maxLength:500,style:{width:'100%',height:'100px',padding:'12px',background:'rgba(0, 0, 0, 0.3)',border:'1px solid rgba(0, 198, 255, 0.3)',borderRadius:'8px',color:'#FFFFFF',fontSize:'14px',resize:'vertical'}}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'right',fontSize:'12px',color:'#8F9BB3',marginTop:'4px'},children:[feedbackComment.length,\"/500\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFeedbackModal(false),style:{flex:1,padding:'12px',background:'rgba(143, 155, 179, 0.1)',border:'1px solid rgba(143, 155, 179, 0.3)',borderRadius:'8px',color:'#8F9BB3',fontWeight:'600',cursor:'pointer'},children:\"Skip\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmitFeedback,disabled:processing,style:{flex:1,padding:'12px',background:'linear-gradient(135deg, #22C55E, #16A34A)',border:'none',borderRadius:'8px',color:'#FFFFFF',fontWeight:'700',cursor:processing?'not-allowed':'pointer',opacity:processing?0.6:1},children:processing?'Submitting...':'Submit Feedback'})]})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useParams","Layout","IoCheckmarkCircle","IoClose","IoSend","IoCloudUpload","IoWarning","IoTime","IoShield","IoEyeOff","axios","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API","process","env","REACT_APP_BACKEND_URL","P2POrderPage","tradeId","navigate","trade","setTrade","loading","setLoading","currentUser","setCurrentUser","messages","setMessages","newMessage","setNewMessage","processing","setProcessing","countdown","setCountdown","paymentProof","setPaymentProof","disputeReason","setDisputeReason","showDisputeModal","setShowDisputeModal","showFeedbackModal","setShowFeedbackModal","feedbackRating","setFeedbackRating","feedbackComment","setFeedbackComment","isBlocked","setIsBlocked","checkingBlock","setCheckingBlock","status","checkFeedback","response","get","concat","user_id","data","feedback_given","setTimeout","error","userData","localStorage","getItem","user","JSON","parse","fetchTrade","interval","setInterval","clearInterval","counterpartyId","isBuyer","seller_id","buyer_id","checkBlockStatus","expires_at","updateCountdown","now","Date","expires","remaining","Math","floor","userId","success","blocked","_error$response","console","handleSendMessage","trim","formData","FormData","append","post","headers","handleMarkAsPaid","trade_id","_error$response2","_error$response2$data","detail","handleReleaseCrypto","_error$response3","_error$response3$data","handleOpenDispute","reason","_error$response4","_error$response4$data","handleCancel","window","confirm","_error$response5","_error$response5$data","handleSubmitFeedback","from_user_id","rating","comment","_error$response6","_error$response6$data","blockedList","blocked_users","includes","handleBlockToggle","endpoint","blocked_user_id","merchant_id","e","_error$response7","_error$response7$data","children","style","padding","textAlign","color","counterparty","minHeight","background","maxWidth","margin","border","borderRadius","marginBottom","display","justifyContent","alignItems","fontSize","fontWeight","crypto_currency","gap","size","toString","padStart","gridTemplateColumns","crypto_amount","fiat_amount","toFixed","seller_payment_details","bank_name","account_name","account_number","sort_code","notes","flexWrap","onClick","disabled","flex","cursor","boxShadow","marginRight","verticalAlign","height","title","transition","overflowY","length","map","msg","idx","isSystem","sender_id","isCurrentUser","timestamp","marginLeft","opacity","toLocaleTimeString","hour","minute","message","attachment","src","alt","marginTop","open","flexDirection","type","value","onChange","target","onKeyPress","key","placeholder","accept","files","id","htmlFor","name","position","top","left","right","bottom","zIndex","width","resize","maxLength"],"sources":["/app/frontend/src/pages/P2POrderPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport Layout from '@/components/Layout';\nimport { IoCheckmarkCircle, IoClose, IoSend, IoCloudUpload, IoWarning, IoTime, IoShield, IoEyeOff } from 'react-icons/io5';\nimport axios from 'axios';\nimport { toast } from 'sonner';\n\nconst API = process.env.REACT_APP_BACKEND_URL;\n\nexport default function P2POrderPage() {\n  const { tradeId } = useParams();\n  const navigate = useNavigate();\n  const [trade, setTrade] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [processing, setProcessing] = useState(false);\n  const [countdown, setCountdown] = useState(0);\n  const [paymentProof, setPaymentProof] = useState(null);\n  const [disputeReason, setDisputeReason] = useState('');\n  const [showDisputeModal, setShowDisputeModal] = useState(false);\n  const [showFeedbackModal, setShowFeedbackModal] = useState(false);\n  const [feedbackRating, setFeedbackRating] = useState('positive');\n  const [feedbackComment, setFeedbackComment] = useState('');\n  const [isBlocked, setIsBlocked] = useState(false);\n  const [checkingBlock, setCheckingBlock] = useState(true);\n\n  // Show feedback modal for completed trades\n  useEffect(() => {\n    if (trade && trade.status === 'completed' && !showFeedbackModal) {\n      // Check if user already left feedback\n      const checkFeedback = async () => {\n        try {\n          const response = await axios.get(`${API}/api/p2p/trade/${tradeId}/feedback-check?user_id=${currentUser?.user_id}`);\n          if (!response.data.feedback_given) {\n            setTimeout(() => setShowFeedbackModal(true), 1000);\n          }\n        } catch (error) {\n          // If endpoint doesn't exist, show modal anyway\n          setTimeout(() => setShowFeedbackModal(true), 1000);\n        }\n      };\n      if (currentUser) checkFeedback();\n    }\n  }, [trade?.status, currentUser]);\n\n  useEffect(() => {\n    const userData = localStorage.getItem('cryptobank_user');\n    if (!userData) {\n      navigate('/login');\n      return;\n    }\n    const user = JSON.parse(userData);\n    setCurrentUser(user);\n    fetchTrade(user.user_id);\n    \n    // Poll for updates\n    const interval = setInterval(() => fetchTrade(user.user_id), 5000);\n    return () => clearInterval(interval);\n  }, [tradeId, navigate]);\n\n  // Check block status when trade is loaded\n  useEffect(() => {\n    if (trade && currentUser) {\n      const counterpartyId = isBuyer ? trade.seller_id : trade.buyer_id;\n      checkBlockStatus(counterpartyId);\n    }\n  }, [trade, currentUser]);\n\n  useEffect(() => {\n    if (trade && trade.expires_at) {\n      const updateCountdown = setInterval(() => {\n        const now = new Date();\n        const expires = new Date(trade.expires_at);\n        const remaining = Math.floor((expires - now) / 1000);\n        if (remaining <= 0) {\n          setCountdown(0);\n          clearInterval(updateCountdown);\n        } else {\n          setCountdown(remaining);\n        }\n      }, 1000);\n      return () => clearInterval(updateCountdown);\n    }\n  }, [trade]);\n\n  const fetchTrade = async (userId) => {\n    try {\n      const response = await axios.get(`${API}/api/p2p/trade/${tradeId}?user_id=${userId}`);\n      if (response.data.success) {\n        setTrade(response.data.trade);\n        if (response.data.messages) {\n          setMessages(response.data.messages);\n        }\n        \n        // Check if this trade involves a blocked user\n        if (response.data.blocked) {\n          toast.error('This trade involves a blocked user. Redirecting...');\n          setTimeout(() => navigate('/p2p'), 2000);\n        }\n      }\n    } catch (error) {\n      console.error('Error fetching trade:', error);\n      if (error.response?.status === 403) {\n        toast.error('Access denied: User is blocked');\n        navigate('/p2p');\n      } else {\n        toast.error('Failed to load trade details');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSendMessage = async () => {\n    if (!newMessage.trim() && !paymentProof) return;\n    \n    setProcessing(true);\n    try {\n      const formData = new FormData();\n      formData.append('trade_id', tradeId);\n      formData.append('sender_id', currentUser.user_id);\n      formData.append('message', newMessage);\n      if (paymentProof) {\n        formData.append('attachment', paymentProof);\n      }\n      \n      const response = await axios.post(`${API}/api/p2p/trade/message`, formData, {\n        headers: { 'Content-Type': 'multipart/form-data' }\n      });\n      \n      if (response.data.success) {\n        setNewMessage('');\n        setPaymentProof(null);\n        fetchTrade(currentUser.user_id);\n      }\n    } catch (error) {\n      toast.error('Failed to send message');\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  const handleMarkAsPaid = async () => {\n    setProcessing(true);\n    try {\n      const response = await axios.post(`${API}/api/p2p/trade/mark-paid`, {\n        trade_id: tradeId,\n        user_id: currentUser.user_id\n      });\n      \n      if (response.data.success) {\n        toast.success('âœ… Payment marked! Waiting for seller to release.');\n        fetchTrade(currentUser.user_id);\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to mark as paid');\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  const handleReleaseCrypto = async () => {\n    setProcessing(true);\n    try {\n      const response = await axios.post(`${API}/api/p2p/trade/release`, {\n        trade_id: tradeId,\n        user_id: currentUser.user_id\n      });\n      \n      if (response.data.success) {\n        toast.success('âœ… Crypto released successfully!');\n        fetchTrade(currentUser.user_id);\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to release crypto');\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  const handleOpenDispute = async () => {\n    if (!disputeReason.trim()) {\n      toast.error('Please provide a reason for dispute');\n      return;\n    }\n    \n    setProcessing(true);\n    try {\n      const response = await axios.post(`${API}/api/p2p/trade/dispute`, {\n        trade_id: tradeId,\n        user_id: currentUser.user_id,\n        reason: disputeReason\n      });\n      \n      if (response.data.success) {\n        toast.success('Dispute opened. Admin will review.');\n        setShowDisputeModal(false);\n        fetchTrade(currentUser.user_id);\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to open dispute');\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  const handleCancel = async () => {\n    if (!window.confirm('Are you sure you want to cancel this order?')) return;\n    \n    setProcessing(true);\n    try {\n      const response = await axios.post(`${API}/api/p2p/trade/cancel`, {\n        trade_id: tradeId,\n        user_id: currentUser.user_id\n      });\n      \n      if (response.data.success) {\n        toast.success('Order cancelled');\n        fetchTrade(currentUser.user_id);\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to cancel');\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  const handleSubmitFeedback = async () => {\n    if (!feedbackComment.trim() && feedbackRating === '') {\n      toast.error('Please provide a rating');\n      return;\n    }\n    \n    setProcessing(true);\n    try {\n      const response = await axios.post(`${API}/api/p2p/trade/${tradeId}/feedback`, {\n        from_user_id: currentUser.user_id,\n        rating: feedbackRating,\n        comment: feedbackComment.trim()\n      });\n      \n      if (response.data.success) {\n        toast.success('âœ… Feedback submitted!');\n        setShowFeedbackModal(false);\n        setFeedbackRating('positive');\n        setFeedbackComment('');\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to submit feedback');\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  const checkBlockStatus = async (counterpartyId) => {\n    try {\n      const response = await axios.get(`${API}/api/p2p/blocked/${currentUser.user_id}`);\n      if (response.data.success) {\n        const blockedList = response.data.blocked_users || [];\n        setIsBlocked(blockedList.includes(counterpartyId));\n      }\n    } catch (error) {\n      console.error('Error checking block status:', error);\n    } finally {\n      setCheckingBlock(false);\n    }\n  };\n\n  const handleBlockToggle = async () => {\n    const counterpartyId = isBuyer ? trade.seller_id : trade.buyer_id;\n    setProcessing(true);\n    \n    try {\n      const endpoint = isBlocked ? '/api/p2p/block/remove' : '/api/p2p/block/add';\n      const response = await axios.post(`${API}${endpoint}`, {\n        user_id: currentUser.user_id,\n        blocked_user_id: counterpartyId\n      });\n      \n      if (response.data.success) {\n        setIsBlocked(!isBlocked);\n        toast.success(isBlocked ? 'âœ… User unblocked - Marketplace will update' : 'ğŸš« User blocked - Redirecting to marketplace...');\n        \n        // If blocked a favourite, remove from favourites\n        if (!isBlocked) {\n          try {\n            await axios.post(`${API}/api/p2p/favourites/remove`, {\n              user_id: currentUser.user_id,\n              merchant_id: counterpartyId\n            });\n          } catch (e) {\n            console.error('Failed to remove from favourites:', e);\n          }\n        }\n        \n        // Redirect to marketplace after blocking so user sees updated list\n        setTimeout(() => {\n          navigate('/p2p');\n        }, 1500);\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to update block status');\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <Layout>\n        <div style={{ padding: '40px', textAlign: 'center', color: '#fff' }}>Loading...</div>\n      </Layout>\n    );\n  }\n\n  if (!trade) {\n    return (\n      <Layout>\n        <div style={{ padding: '40px', textAlign: 'center', color: '#fff' }}>Trade not found</div>\n      </Layout>\n    );\n  }\n\n  const isBuyer = currentUser?.user_id === trade.buyer_id;\n  const counterparty = isBuyer ? 'Seller' : 'Buyer';\n\n  return (\n    <Layout>\n      <div style={{ minHeight: '100vh', padding: '40px 20px', background: 'linear-gradient(180deg, #05121F 0%, #071E2C 100%)' }}>\n        <div style={{ maxWidth: '1200px', margin: '0 auto' }}>\n          \n          {/* Header */}\n          <div style={{\n            background: 'linear-gradient(135deg, #0A1929 0%, #051018 100%)',\n            border: '1px solid rgba(0, 198, 255, 0.2)',\n            borderRadius: '16px',\n            padding: '24px',\n            marginBottom: '24px'\n          }}>\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>\n              <h1 style={{ fontSize: '28px', fontWeight: '700', color: '#FFFFFF' }}>\n                {isBuyer ? 'Buy' : 'Sell'} {trade.crypto_currency}\n              </h1>\n              <div style={{\n                padding: '8px 16px',\n                background: trade.status === 'completed' ? 'rgba(34, 197, 94, 0.1)' : 'rgba(255, 165, 0, 0.1)',\n                border: `1px solid ${trade.status === 'completed' ? 'rgba(34, 197, 94, 0.3)' : 'rgba(255, 165, 0, 0.3)'}`,\n                borderRadius: '8px',\n                color: trade.status === 'completed' ? '#22C55E' : '#FFA500',\n                fontWeight: '600'\n              }}>\n                {trade.status === 'pending_payment' ? 'Waiting for Payment' :\n                 trade.status === 'payment_made' ? 'Payment Made' :\n                 trade.status === 'completed' ? 'Completed' :\n                 trade.status === 'cancelled' ? 'Cancelled' :\n                 trade.status === 'disputed' ? 'Disputed' : trade.status}\n              </div>\n            </div>\n            \n            {countdown > 0 && trade.status === 'pending_payment' && (\n              <div style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px',\n                padding: '12px',\n                background: 'rgba(239, 68, 68, 0.1)',\n                border: '1px solid rgba(239, 68, 68, 0.3)',\n                borderRadius: '8px'\n              }}>\n                <IoTime size={20} color=\"#EF4444\" />\n                <span style={{ color: '#EF4444', fontWeight: '600' }}>\n                  Time remaining: {Math.floor(countdown / 60)}:{(countdown % 60).toString().padStart(2, '0')}\n                </span>\n              </div>\n            )}\n          </div>\n\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 400px', gap: '24px' }}>\n            \n            {/* Left Column */}\n            <div>\n              {/* Order Details */}\n              <div style={{\n                background: 'linear-gradient(135deg, #0A1929 0%, #051018 100%)',\n                border: '1px solid rgba(0, 198, 255, 0.2)',\n                borderRadius: '16px',\n                padding: '24px',\n                marginBottom: '24px'\n              }}>\n                <h3 style={{ fontSize: '20px', fontWeight: '700', color: '#FFFFFF', marginBottom: '16px' }}>Order Details</h3>\n                <div style={{ display: 'grid', gap: '12px' }}>\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <span style={{ color: '#8F9BB3' }}>Amount</span>\n                    <span style={{ color: '#FFFFFF', fontWeight: '600' }}>{trade.crypto_amount} {trade.crypto_currency}</span>\n                  </div>\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <span style={{ color: '#8F9BB3' }}>Price</span>\n                    <span style={{ color: '#FFFFFF', fontWeight: '600' }}>Â£{(trade.fiat_amount / trade.crypto_amount).toFixed(2)}</span>\n                  </div>\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <span style={{ color: '#8F9BB3' }}>Total</span>\n                    <span style={{ color: '#00C6FF', fontWeight: '700', fontSize: '20px' }}>Â£{trade.fiat_amount.toFixed(2)}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Payment Instructions - Only for Buyer */}\n              {isBuyer && trade.seller_payment_details && trade.status === 'pending_payment' && (\n                <div style={{\n                  background: 'linear-gradient(135deg, #0A1929 0%, #051018 100%)',\n                  border: '1px solid rgba(255, 165, 0, 0.3)',\n                  borderRadius: '16px',\n                  padding: '24px',\n                  marginBottom: '24px'\n                }}>\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '16px' }}>\n                    <IoShield size={24} color=\"#FFA500\" />\n                    <h3 style={{ fontSize: '20px', fontWeight: '700', color: '#FFFFFF' }}>Payment Instructions</h3>\n                  </div>\n                  <div style={{ background: 'rgba(255, 165, 0, 0.05)', padding: '16px', borderRadius: '8px' }}>\n                    <div style={{ display: 'grid', gap: '12px' }}>\n                      <div>\n                        <div style={{ fontSize: '12px', color: '#8F9BB3', marginBottom: '4px' }}>Bank Name</div>\n                        <div style={{ color: '#FFFFFF', fontWeight: '600' }}>{trade.seller_payment_details.bank_name}</div>\n                      </div>\n                      <div>\n                        <div style={{ fontSize: '12px', color: '#8F9BB3', marginBottom: '4px' }}>Account Name</div>\n                        <div style={{ color: '#FFFFFF', fontWeight: '600' }}>{trade.seller_payment_details.account_name}</div>\n                      </div>\n                      <div>\n                        <div style={{ fontSize: '12px', color: '#8F9BB3', marginBottom: '4px' }}>Account Number</div>\n                        <div style={{ color: '#FFFFFF', fontWeight: '600' }}>{trade.seller_payment_details.account_number}</div>\n                      </div>\n                      <div>\n                        <div style={{ fontSize: '12px', color: '#8F9BB3', marginBottom: '4px' }}>Sort Code</div>\n                        <div style={{ color: '#FFFFFF', fontWeight: '600' }}>{trade.seller_payment_details.sort_code}</div>\n                      </div>\n                      {trade.seller_payment_details.notes && (\n                        <div>\n                          <div style={{ fontSize: '12px', color: '#8F9BB3', marginBottom: '4px' }}>Notes</div>\n                          <div style={{ color: '#FFA500' }}>{trade.seller_payment_details.notes}</div>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Action Buttons */}\n              <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>\n                {isBuyer && trade.status === 'pending_payment' && (\n                  <button\n                    onClick={handleMarkAsPaid}\n                    disabled={processing}\n                    style={{\n                      flex: 1,\n                      padding: '16px',\n                      background: 'linear-gradient(135deg, #22C55E, #16A34A)',\n                      border: 'none',\n                      borderRadius: '12px',\n                      color: '#FFFFFF',\n                      fontSize: '16px',\n                      fontWeight: '700',\n                      cursor: processing ? 'not-allowed' : 'pointer',\n                      boxShadow: '0 0 20px rgba(34, 197, 94, 0.4)'\n                    }}\n                  >\n                    <IoCheckmarkCircle size={20} style={{ marginRight: '8px', verticalAlign: 'middle' }} />\n                    Mark as Paid\n                  </button>\n                )}\n\n                {!isBuyer && trade.status === 'payment_made' && (\n                  <button\n                    onClick={handleReleaseCrypto}\n                    disabled={processing}\n                    style={{\n                      flex: 1,\n                      padding: '16px',\n                      background: 'linear-gradient(135deg, #22C55E, #16A34A)',\n                      border: 'none',\n                      borderRadius: '12px',\n                      color: '#FFFFFF',\n                      fontSize: '16px',\n                      fontWeight: '700',\n                      cursor: processing ? 'not-allowed' : 'pointer',\n                      boxShadow: '0 0 20px rgba(34, 197, 94, 0.4)'\n                    }}\n                  >\n                    Release Crypto\n                  </button>\n                )}\n\n                {trade.status === 'completed' && (\n                  <button\n                    onClick={() => setShowFeedbackModal(true)}\n                    style={{\n                      flex: 1,\n                      padding: '16px',\n                      background: 'linear-gradient(135deg, #FFA500, #FF8C00)',\n                      border: 'none',\n                      borderRadius: '12px',\n                      color: '#FFFFFF',\n                      fontSize: '16px',\n                      fontWeight: '700',\n                      cursor: 'pointer',\n                      boxShadow: '0 0 20px rgba(255, 165, 0, 0.4)'\n                    }}\n                  >\n                    â­ Rate This Trade\n                  </button>\n                )}\n\n                {trade.status !== 'completed' && trade.status !== 'cancelled' && trade.status !== 'disputed' && (\n                  <>\n                    <button\n                      onClick={() => setShowDisputeModal(true)}\n                      disabled={processing}\n                      style={{\n                        padding: '16px 24px',\n                        background: 'rgba(239, 68, 68, 0.1)',\n                        border: '1px solid rgba(239, 68, 68, 0.3)',\n                        borderRadius: '12px',\n                        color: '#EF4444',\n                        fontSize: '16px',\n                        fontWeight: '600',\n                        cursor: processing ? 'not-allowed' : 'pointer'\n                      }}\n                    >\n                      <IoWarning size={20} style={{ marginRight: '8px', verticalAlign: 'middle' }} />\n                      Dispute\n                    </button>\n\n                    {isBuyer && trade.status === 'pending_payment' && (\n                      <button\n                        onClick={handleCancel}\n                        disabled={processing}\n                        style={{\n                          padding: '16px 24px',\n                          background: 'rgba(143, 155, 179, 0.1)',\n                          border: '1px solid rgba(143, 155, 179, 0.3)',\n                          borderRadius: '12px',\n                          color: '#8F9BB3',\n                          fontSize: '16px',\n                          fontWeight: '600',\n                          cursor: processing ? 'not-allowed' : 'pointer'\n                        }}\n                      >\n                        Cancel Order\n                      </button>\n                    )}\n                  </>\n                )}\n              </div>\n            </div>\n\n            {/* Right Column - Chat */}\n            <div style={{\n              background: 'linear-gradient(135deg, #0A1929 0%, #051018 100%)',\n              border: '1px solid rgba(0, 198, 255, 0.2)',\n              borderRadius: '16px',\n              padding: '24px',\n              height: 'fit-content'\n            }}>\n              {/* Chat Header with Block Button */}\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>\n                <h3 style={{ fontSize: '20px', fontWeight: '700', color: '#FFFFFF', margin: 0 }}>Chat with {counterparty}</h3>\n                {!checkingBlock && (\n                  <button\n                    onClick={handleBlockToggle}\n                    disabled={processing}\n                    title={isBlocked ? 'Unblock user' : 'Block user'}\n                    style={{\n                      padding: '8px 16px',\n                      background: isBlocked ? 'rgba(239, 68, 68, 0.1)' : 'rgba(143, 155, 179, 0.1)',\n                      border: `1px solid ${isBlocked ? 'rgba(239, 68, 68, 0.3)' : 'rgba(143, 155, 179, 0.3)'}`,\n                      borderRadius: '8px',\n                      color: isBlocked ? '#EF4444' : '#8F9BB3',\n                      fontSize: '12px',\n                      fontWeight: '600',\n                      cursor: processing ? 'not-allowed' : 'pointer',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '6px',\n                      transition: 'all 0.2s'\n                    }}\n                  >\n                    <IoEyeOff size={14} />\n                    {isBlocked ? 'Unblock' : 'Block'}\n                  </button>\n                )}\n              </div>\n              \n              <div style={{\n                height: '400px',\n                overflowY: 'auto',\n                marginBottom: '16px',\n                padding: '12px',\n                background: 'rgba(0, 0, 0, 0.2)',\n                borderRadius: '8px'\n              }}>\n                {messages.length === 0 ? (\n                  <div style={{ textAlign: 'center', color: '#8F9BB3', padding: '40px' }}>No messages yet</div>\n                ) : (\n                  messages.map((msg, idx) => {\n                    const isSystem = msg.sender_id === 'SYSTEM';\n                    const isCurrentUser = msg.sender_id === currentUser.user_id;\n                    \n                    return (\n                      <div key={idx} style={{\n                        marginBottom: '12px',\n                        padding: '12px',\n                        background: isSystem \n                          ? 'rgba(255, 165, 0, 0.15)'\n                          : isCurrentUser \n                            ? 'rgba(0, 198, 255, 0.1)' \n                            : 'rgba(143, 155, 179, 0.1)',\n                        border: isSystem ? '1px solid rgba(255, 165, 0, 0.3)' : 'none',\n                        borderRadius: '8px',\n                        textAlign: isSystem ? 'center' : isCurrentUser ? 'right' : 'left'\n                      }}>\n                        <div style={{ \n                          fontSize: '11px', \n                          color: isSystem ? '#FFA500' : '#8F9BB3', \n                          marginBottom: '4px',\n                          fontWeight: isSystem ? '700' : '600'\n                        }}>\n                          {isSystem ? 'ğŸ¤– SYSTEM' : isCurrentUser ? 'You' : counterparty}\n                          {msg.timestamp && (\n                            <span style={{ marginLeft: '8px', fontSize: '10px', opacity: 0.7 }}>\n                              {new Date(msg.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                            </span>\n                          )}\n                        </div>\n                        <div style={{ \n                          color: isSystem ? '#FFA500' : '#FFFFFF',\n                          fontWeight: isSystem ? '600' : '400'\n                        }}>\n                          {msg.message}\n                        </div>\n                        {msg.attachment && (\n                          <img \n                            src={msg.attachment} \n                            alt=\"proof\" \n                            style={{ \n                              maxWidth: '200px', \n                              marginTop: '8px', \n                              borderRadius: '4px',\n                              cursor: 'pointer'\n                            }}\n                            onClick={() => window.open(msg.attachment, '_blank')}\n                          />\n                        )}\n                      </div>\n                    );\n                  })\n                )}\n              </div>\n\n              <div style={{ display: 'flex', gap: '8px', flexDirection: 'column' }}>\n                <div style={{ display: 'flex', gap: '8px' }}>\n                  <input\n                    type=\"text\"\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\n                    placeholder=\"Type a message...\"\n                    style={{\n                      flex: 1,\n                      padding: '12px',\n                      background: 'rgba(0, 0, 0, 0.3)',\n                      border: '1px solid rgba(0, 198, 255, 0.2)',\n                      borderRadius: '8px',\n                      color: '#FFFFFF',\n                      fontSize: '14px'\n                    }}\n                  />\n                  <button\n                    onClick={handleSendMessage}\n                    disabled={processing || (!newMessage.trim() && !paymentProof)}\n                    style={{\n                      padding: '12px 20px',\n                      background: 'linear-gradient(135deg, #00C6FF, #0099CC)',\n                      border: 'none',\n                      borderRadius: '8px',\n                      color: '#FFFFFF',\n                      cursor: processing ? 'not-allowed' : 'pointer'\n                    }}\n                  >\n                    <IoSend size={20} />\n                  </button>\n                </div>\n                \n                <div>\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={(e) => setPaymentProof(e.target.files[0])}\n                    id=\"proof-upload\"\n                    style={{ display: 'none' }}\n                  />\n                  <label\n                    htmlFor=\"proof-upload\"\n                    style={{\n                      display: 'inline-flex',\n                      alignItems: 'center',\n                      gap: '8px',\n                      padding: '8px 16px',\n                      background: 'rgba(0, 198, 255, 0.1)',\n                      border: '1px solid rgba(0, 198, 255, 0.3)',\n                      borderRadius: '8px',\n                      color: '#00C6FF',\n                      fontSize: '14px',\n                      cursor: 'pointer'\n                    }}\n                  >\n                    <IoCloudUpload size={20} />\n                    {paymentProof ? paymentProof.name : 'Upload Payment Proof'}\n                  </label>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Dispute Modal */}\n      {showDisputeModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(0, 0, 0, 0.85)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 9999\n        }}>\n          <div style={{\n            background: 'linear-gradient(135deg, #0A1929 0%, #051018 100%)',\n            border: '1px solid rgba(239, 68, 68, 0.3)',\n            borderRadius: '16px',\n            padding: '32px',\n            maxWidth: '480px',\n            width: '90%'\n          }}>\n            <h3 style={{ fontSize: '24px', fontWeight: '700', color: '#FFFFFF', marginBottom: '16px' }}>Open Dispute</h3>\n            <p style={{ color: '#8F9BB3', marginBottom: '16px' }}>Please explain why you are opening a dispute. Admin will review and resolve.</p>\n            <textarea\n              value={disputeReason}\n              onChange={(e) => setDisputeReason(e.target.value)}\n              placeholder=\"Describe the issue...\"\n              style={{\n                width: '100%',\n                height: '120px',\n                padding: '12px',\n                background: 'rgba(0, 0, 0, 0.3)',\n                border: '1px solid rgba(239, 68, 68, 0.3)',\n                borderRadius: '8px',\n                color: '#FFFFFF',\n                fontSize: '14px',\n                marginBottom: '16px',\n                resize: 'vertical'\n              }}\n            />\n            <div style={{ display: 'flex', gap: '12px' }}>\n              <button\n                onClick={() => setShowDisputeModal(false)}\n                style={{\n                  flex: 1,\n                  padding: '12px',\n                  background: 'rgba(143, 155, 179, 0.1)',\n                  border: '1px solid rgba(143, 155, 179, 0.3)',\n                  borderRadius: '8px',\n                  color: '#8F9BB3',\n                  fontWeight: '600',\n                  cursor: 'pointer'\n                }}\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleOpenDispute}\n                disabled={processing || !disputeReason.trim()}\n                style={{\n                  flex: 1,\n                  padding: '12px',\n                  background: 'linear-gradient(135deg, #EF4444, #DC2626)',\n                  border: 'none',\n                  borderRadius: '8px',\n                  color: '#FFFFFF',\n                  fontWeight: '700',\n                  cursor: processing || !disputeReason.trim() ? 'not-allowed' : 'pointer'\n                }}\n              >\n                Submit Dispute\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Feedback Modal */}\n      {showFeedbackModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(0, 0, 0, 0.85)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 9999\n        }}>\n          <div style={{\n            background: 'linear-gradient(135deg, #0A1929 0%, #051018 100%)',\n            border: '1px solid rgba(0, 198, 255, 0.3)',\n            borderRadius: '16px',\n            padding: '32px',\n            maxWidth: '480px',\n            width: '90%'\n          }}>\n            <h3 style={{ fontSize: '24px', fontWeight: '700', color: '#FFFFFF', marginBottom: '16px' }}>\n              Rate Your Counterparty\n            </h3>\n            <p style={{ color: '#8F9BB3', marginBottom: '20px' }}>\n              How was your experience with {counterparty}?\n            </p>\n            \n            {/* Rating Selection */}\n            <div style={{ marginBottom: '20px' }}>\n              <label style={{ color: '#8F9BB3', fontSize: '14px', display: 'block', marginBottom: '8px' }}>\n                Rating *\n              </label>\n              <div style={{ display: 'flex', gap: '12px' }}>\n                {['positive', 'neutral', 'negative'].map((rating) => (\n                  <button\n                    key={rating}\n                    onClick={() => setFeedbackRating(rating)}\n                    style={{\n                      flex: 1,\n                      padding: '12px',\n                      background: feedbackRating === rating \n                        ? rating === 'positive' ? 'rgba(34, 197, 94, 0.2)' \n                        : rating === 'neutral' ? 'rgba(255, 165, 0, 0.2)'\n                        : 'rgba(239, 68, 68, 0.2)'\n                        : 'rgba(143, 155, 179, 0.1)',\n                      border: feedbackRating === rating \n                        ? rating === 'positive' ? '2px solid #22C55E' \n                        : rating === 'neutral' ? '2px solid #FFA500'\n                        : '2px solid #EF4444'\n                        : '1px solid rgba(143, 155, 179, 0.3)',\n                      borderRadius: '8px',\n                      color: feedbackRating === rating \n                        ? rating === 'positive' ? '#22C55E' \n                        : rating === 'neutral' ? '#FFA500'\n                        : '#EF4444'\n                        : '#8F9BB3',\n                      fontWeight: feedbackRating === rating ? '700' : '400',\n                      cursor: 'pointer',\n                      fontSize: '14px'\n                    }}\n                  >\n                    {rating === 'positive' ? 'ğŸ‘ Positive' : rating === 'neutral' ? 'ğŸ˜ Neutral' : 'ğŸ‘ Negative'}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Comment */}\n            <div style={{ marginBottom: '20px' }}>\n              <label style={{ color: '#8F9BB3', fontSize: '14px', display: 'block', marginBottom: '8px' }}>\n                Comment (Optional)\n              </label>\n              <textarea\n                value={feedbackComment}\n                onChange={(e) => setFeedbackComment(e.target.value)}\n                placeholder=\"Share your experience... (max 500 characters)\"\n                maxLength={500}\n                style={{\n                  width: '100%',\n                  height: '100px',\n                  padding: '12px',\n                  background: 'rgba(0, 0, 0, 0.3)',\n                  border: '1px solid rgba(0, 198, 255, 0.3)',\n                  borderRadius: '8px',\n                  color: '#FFFFFF',\n                  fontSize: '14px',\n                  resize: 'vertical'\n                }}\n              />\n              <div style={{ textAlign: 'right', fontSize: '12px', color: '#8F9BB3', marginTop: '4px' }}>\n                {feedbackComment.length}/500\n              </div>\n            </div>\n\n            {/* Buttons */}\n            <div style={{ display: 'flex', gap: '12px' }}>\n              <button\n                onClick={() => setShowFeedbackModal(false)}\n                style={{\n                  flex: 1,\n                  padding: '12px',\n                  background: 'rgba(143, 155, 179, 0.1)',\n                  border: '1px solid rgba(143, 155, 179, 0.3)',\n                  borderRadius: '8px',\n                  color: '#8F9BB3',\n                  fontWeight: '600',\n                  cursor: 'pointer'\n                }}\n              >\n                Skip\n              </button>\n              <button\n                onClick={handleSubmitFeedback}\n                disabled={processing}\n                style={{\n                  flex: 1,\n                  padding: '12px',\n                  background: 'linear-gradient(135deg, #22C55E, #16A34A)',\n                  border: 'none',\n                  borderRadius: '8px',\n                  color: '#FFFFFF',\n                  fontWeight: '700',\n                  cursor: processing ? 'not-allowed' : 'pointer',\n                  opacity: processing ? 0.6 : 1\n                }}\n              >\n                {processing ? 'Submitting...' : 'Submit Feedback'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </Layout>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}